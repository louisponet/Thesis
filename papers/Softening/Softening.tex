\chapter{Mechanical softening in Ferroelectric domain walls}


\section{Introduction}
So far, the focus of this work was largely on the behavior of, and interaction between various orders in uniform domains.
A thorough understanding of these physics is of fundamental importance, since it provides the building blocks for more complex scenarios.
Reality, however, presents to us almost exclusively this greater complexity.
The reason is that while going through a phase transition with an associated spontaneous symmetry breaking, different parts of the material which are separated in space will separately choose one of the degenerate states with different values of the order parameters.
One could argue that second order phase transitions can theoretically happen coherently throughout the entire system, were it not for two main issues.
The first is a general one, it requires the assumption that the crystals are completely uniform and without defects, and that the temperature variation happens at an infinitely slow rate.
Secondly, in the specific case of ferroelectrics\footnote{Similar magnetic depolarizing fields show up for Ferromagnets, which is one of the limiting factors for the data density in magnetic storage.}, the creation of regions with spontaneous ferroelectric polarization leads to an electric depolarizing field at their surface.
Neighboring domains will therefore preferably be formed having opposing polarizations to compensate this field.
These are separated by domain walls (DWs) in which the order parameter interpolates between the two values of the neighboring domains.
It may be the case that multiple order parameters vary accross a DW, due to their coupling to the primary one (the one that causes the phase transition). 
In ferroelectrics, the DW interpolates the polarization and, depending on the domains, the elastic strain tensor.
DWs in ferroelectrics are usually indentified by the angle by which the polarization vector changes accross it.
For example, a 180$^\circ$ degree DW (the focus of the chapter) separates domains with completely anti-parallel polarization vectors.
The strain tensor that is coupled to the square of the polarization, as will discussed later, therefore does not change accross this DW.
Other types of DW like e.g. 90$^\circ$ DWs will instead separate domains with different strain textures, which are referred to as twin-domains, and the DWs as twin-domain walls \cite{Cao1991,Marton2010}.
In many ferroelectrics multiple orientations of the polarization are degenerate, leading to all kinds of domain walls \cite{Hu1998,Marton2010}.

The inherent difference between DWs and the domains has led to a great deal of research interest, both from the fundamental and technological point of view.
Their thickness and interfacial energy play an important role in the kinetics and fatigue mechanisms associated with switching in ferroelectric materials. 

The physics that govern the region of the DW is usually richer than that of the domains, since the system is locally forced to not be the energetic minimum.
This is often associated with a local inversion of the curvature of the energy potential, leading to a potential softening of the order parameters \cite{Scott2012}.
DWs are a lower dimensional object embedded in a three dimentional medium, which can have a myriad of interesting consequences which can potentially be exploited technologically \cite{Salje2016}.
One example is in ferroelectric information storage devices, where the small size is beneficial for information density, and ease of manipulation of their position allows for a great degree of flexibility.
This low energy penalty associated with shifting the DW will come back as one of the main contributors to the effect discussed in the chapter.
The materials that are commonly used technologically are those that can harbor charged conducting DWs, separating the manifestly nonconductive domains.
These can be created or destroyed at will by applying electric fields, increasing or decreasing the conductivity of the device.
This conductivity can in turn be probed, effectively reading back the ``data'' that was previously written \lp{citation}.

While this kind of technological promise has driven much of the research of DWs towards their electronic properties, the coupling between electric polarization and internal strain puts the spotlight on their mechanical characteristics.
This field is much less developed and has many unanswered questions.
It has been shown that ferroelectric-ferroelastic (ferroelastic walls separate domains with differing strain textures) DWs can be moved by applying stress \cite{Schneider2001}.
This is not surprising since the different strain textures couple differently to the mechanical perturbation, causing a force imbalance and associated movement of the separating DW.
More interesting, perhaps, is the fact that the polarization itself can also be influenced by purely mechanical means, for example by the flexoelectric effect, with energy density:
\begin{equation}
	f_{fl} = \frac{1}{2}f_{jklm}(\varepsilon_{jk}\partial_mP_l-P_l\partial_m\varepsilon_{jk}),
\end{equation}
where repeated indices are summed over, $\varepsilon$ denotes the strain and $P$ the ferroelectric polarization.
An applied strain gradient will then appear as an internal electric field $E_{j} = \frac{1}{2}f_{jklm}\partial_k\varepsilon_{lm}$, coupling to the dipoles that constitute $P_l$.
While this effect is generally small (i.e. the elements of the flexoelectric tensor $f_{jklm}$ are small), it scales inversely with the size of the sample, meaning that it becomes increasingly more important at the nanoscale of current state of the art electronic devices.
Thus, using a tip to apply a strain gradient to the surface of a ferroelectric material allows one to mechanically write domain patterns and DWs at will \cite{Lu2012}.

These developments have slowly increased the research into the mechanical properties of these materials in recent years.
Here we focus on the mechanical properties of purely ferroelectric 180$^\circ$ DWs.
As it turns out, these walls appear mechanically softer than the domains they separate.
A similar softening has been previously observed and studied for ferroelastic DWs \cite{Lee2003,Scott2012}, but purely ferroelectric DWs have largely flown under the radar of mechanical studies.
One reason is that the size of ferroelectric domain walls is on the order of a couple of unit cells, and was thus perceived too small to be detected with mechanical means, seen as tip contact areas are generally at least 100 unit cells.
As it turns out, however, there is a strain texture associated with these DWs, which extends much further than the region in which the primary order parameter changes.
This can qualitatively be understood by considering the electrostriction energy density
\begin{equation}
f_{q}=-\frac{1}{2}\varepsilon_{jk}q_{jklm}P_{l}P_{m},\label{eq:qpp},
\end{equation}
which causes domains to be stretched along the direction of $P$.
No such stress exists inside the wall itself, since $P=0$, leading to an indentation with an associated long range strain texture, because sharp changes in the strain are very unfavorable from an elastic point of view.
This structural texture associated with the DW can be picked up mechanically by the applied tips and ultimately allows one to make the observations that are the subject of this Chapter.

\section{Experimental}
Before going into the theoretical details that describe the physics of this problem, we describe the experiments performed by the group of Prof. Catalan that were the impetus of this research.
In order to determine the generality of the softening of ferroelectric DWs, three single crystal samples were characterized mechanically: LiNbO$_3$, BaTiO$_3$ and PbTiO$_3$ \cite{Stefani2020}. Since all show the same behavior, we focus on the specific case of BaTiO$_3$, showcased in Fig.~\ref{fig:BTO_experiment}.

To determine the domain structure of the sample, piezoresponce force microscopy (PFM)\cite{Harnagea2001} was used, the results of which are displayed in Fig.~\ref{fig:BTO_experiment}(a,c).
Multiple types of domains can be identified inside the sample.
In the region shown in panels (a,b), domains with out-of plane ($c$-direction) polarization separated by mostly straight 180$^\circ$ DWs are found.
Panels (c-f) demonstrate a more complex region where bubble domains with out-of-plane ferroelectric polarization appear as well as domains with in-plane polarization along the $a$-direction.
The 90$^\circ$ boundary between the region with out-of-plane polarization and in-plane polarization is an example of a so-called $a$-$c$ twin wall, separating domains with different polarization as well as strain texture.

\begin{figure}
	\IncludeGraphics{experimental}
	\caption{\label{fig:BTO_experiment} {\bf Experimental Measurements} Two regions of the BTO sample are imaged. Panels (a,b) show a region with mostly straight DWs, panels (c-f) show a more complex region with bubble domains, and a twin-wall separating the left region with out-of-plane polarization from the diagonal region with in-plane polarization (along the $a$-direction). Panels (a,c) show the PFM phase, panel (d) the out-of-plane PFM amplitude, and (f) shows a schematic representation the polarization reconstructed from these measurements. Panels (b,e) show the CRFM measurements, demonstrating softer DW regions (brown) and stiffer domains (purple). Image taken from Ref.~\cite{Stefani2020}.}
\end{figure}

In order to probe the spatial variation of the stiffness of the sample, measurements based on contact resonance frequency microscopy (CRFM) were performed.
This technique is based on scanning probe microscopy where an atomic force microscopy tip on a cantilever is brought into contact with the surface of the sample.
The maximal mechanical load was 20 micro Newtons, and the surface contact of the tip is estimated to be 7 nm.
The combined system of the cantilever and the sample then acts as a series of springs, whose resonance frequence can be measured as a probe of the local stiffness under the tip~\cite{Rabe2000}.
Through Hooke's law it is known that the resonance frequency of a linear spring is given by $\omega = \sqrt{\frac{k}{m}}$, thus when the sample has a higher stiffness $k$, it leads to a higher resonance frequency measured by the tip.
Using this method, the only limit on spatial resolution is the scanning speed, or the duration of the experiment.
The result is shown in Fig.~\ref{fig:BTO_experiment}(b,e).
A clear contrast can be observed between soft areas (brown) close to the wall and harder areas (purple) inside the domains, with an apparent reduction of the stiffness by $\approx 19\%$ at the walls.


Already from these measurements it is clear that the origin of the softening must be found in the strain texture of the wall, rather than the polarization itself.
This is because the polarization reversal occurs fully within a couple of nm, whereas the width of the soft region around the wall is $\sim$ 70 nm.
We can moreover see that, comparing panels (b) and (e) in Fig.~\ref{fig:BTO_experiment}, the soft region is significantly wider for the bubble domains as compared with those of the straight walls.
Since strain textures associated with the round DWs are significantly larger than those of straight DWs, with the strain decaying only by a power-law in the round walls, rather than exponentially away from a straight wall \cite{Landau1960}.
This provides another argument for the strain playing a key role.

By comparing the results of multiple measurements, it was checked that the measurements did not change the domain distribution, excluding the possibility of mechanically induced ferroelectric switching.
This could happen through the flexoelectric coupling between the tip induced strain gradient and the polarization, and has been proposed as a mechanism for voltage-free mechanical reading and writing of polarization~\cite{Cordero-Edwards2017,Cordero-Edwards2019,Abdollahi2015}.
Moreover, the tip is conductive and always in contact with the surface, ensuring charge neutrality, thus also excluding any electrical excitation.

This concludes the overview of the experimental measurements performed by C. Stefani et al. in Ref.~\cite{Stefani2020} that lie at the base of this Chapter.

\section{Barium Titanate}
Before turning to the theory and simulations that we used in order to investigate the experimental observations, we start with a short summary of the most important proberties of BTO.
As mentioned previously, BTO is not special from the point of view of the DW softening, and all 180$^\circ$ ferroelectric DWs should demonstrate the same behavior.

BaTiO$_3$ is chosen since it is a well studied classic example of an ABO$_3$ perovskite.
It has a ferroelectric polarization $P \approx 30 \times 10^5 \mu $C/m$^2$ at room temperature \cite{Mason1948, VonHippel1950, Ghosez1994}.
Due to its excellent dielectric, piezoelectric and photorefractive properties, it can be found in many devices like capacitors \cite{American1963}, electromechanical transducers \cite{Schofield1957} and nonlinear optics \cite{Ramakanth2015}.

Starting from the cubic paraelectric $Pm3m$ phase at high temperature, it undergoes phase transitions at 393\,K, 273\,K and 183\,K to the ferroelectric tetragonal $P4mm$ (shown in Fig.~\ref{fig:BTO_crystal}), orthorhombic $Amm2$ and rhombohedral $R3m$ phases, respectively \cite{Mason1948, VonHippel1950, Marton2010}.
The microscopic origin of the ferroelectricity in BTO has previously been studied with variational DFT calculations \cite{Ghosez1995}, uncovering the intricate role that hybridization between Ti and O orbitals plays in the effect.
This leads to the Born effective charges of the Ti and O ions to be quite different from what would be expected from a purely ionic picture.
The Born effective charge tensor $Z^*_{\kappa, \gamma\alpha}$ is defined in terms of the change in polarization in direction $\gamma$ that occurs due to a periodic displacement $\delta$ of atom $\kappa$ in the direction $\alpha$:
\begin{equation}
Z^*_{\kappa, \gamma\alpha} = Z_{\kappa} \delta_{\gamma\alpha} + \Delta Z_{\kappa, \gamma\alpha}.
\end{equation}
There are thus two contributions: $Z_{\kappa}$ is the ionic charge of the atom, and $\Delta Z_{\kappa, \gamma\alpha}$ is the electronic screening that results from the displacement.
$Z_{\kappa}$ should then be +2 for Ba, +4 for Ti and -2 for O, if the electron charge is taken to be -1.
From the DFT calculations it was found that the electronic contribution due to screening effects is quite significant, especially for Ti ($Z^* = 7.29$) and O ($Z^*_{||} = -5.75$), for a displacement along the Ti--O bond.
These large electronic contributions stem from the varying degree of hybridization between O $2p$ and Ti $3d$ orbitals as the atoms are displaced.
For further details, see Ref.~\cite{Ghosez1995}.

All experiments were performed at room temperature, so we focus on the tetragonal phase as displayed in Fig.~\ref{fig:BTO_crystal}.
\begin{figure}[h]
	\IncludeGraphics{BTO_crystal.png}
	\caption{\label{fig:BTO_crystal} Crystal structure of BaTiO$_3$, with central Ti atom, O octahedron and surround Ba ions. The arrows denote the ionic shifts that lead to the ferroelectricity.}
\end{figure}

\section{Theory}
Three possible mechanisms to explain the softening of ferroelectric domain walls were put forward by Tsuji et al. \cite{Tsuji2005}: the existence of defects (oxygen vacancies) which can accumulate inside DWs, a reduced depolarization energy due to piezoelectricity, and the existence of domain-wall localized phonon modes (e.g. sliding and breathing). We will discuss each of these contributions, with a detailed investigation into the last one.

A thorough theoretical investigation on the behavior of defects in BTO DWs was done by Xiao et al. in Ref.~\cite{Xiao2005}.
It was shown there that a large accumulation of defects was found to exist at 90$^\circ$ DWs, but that no such accumulation is present in 180$^\circ$ domain walls.
Analyzing more carefully the experimental measurements in Fig.~\ref{fig:BTO_experiment}, we can indeed confirm this absence of defects in the 180$^\circ$ DWs.
The nature of defects is such that the extent to which they are present depends on the quality of the sample and can vary from region to region.
This means that if they were of importance for the softening of 180$^\circ$ DWs, the resonance frequency, and by proxy the effective stiffness, should vary from wall to wall in Fig.~\ref{fig:BTO_experiment}(b,e).
However, no such variations are found.
Furthermore, the supposed mechanism for softening due to defects is a weakening of the interatomic bonds caused by the defects.
This should be fairly isotropic, or at least orthotropic, in the tetragonal phase since in BTO it is fairly close to the parent cubic structure.
The softening effect should thus not depend on the orientation of the polarization.
Focusing on Fig.~\ref{fig:BTO_experiment}(c-f), we have access to a region of the sample where both in-plane and out-of-plane polarization cases are present.
This region is small enough such that variations of the quality of the sample and density of defects can be assumed to be small.
We can see that the softening is present for the 180$^\circ$ DWs that separate domains with out-of plane polarization like in the bubbles domains on the top-left part of panel (e).
When the walls spill over into the $a$-domain with in-plane polarization on the bottom right half of (e), the contrast between wall and domain disappears.
We can thus exclude defects as a contributing factor to the DW softening.

The contribution from the reduction in depolarization energy at the DW, however, can not be neglected \cite{Tsuji2005,Stefani2020}.
When the tip is applied to the sample, it causes a non-uniform pressure field at the surface.
Such a pressure field applied to a piezoelectric material (all ferroelectrics are piezoelectric) will lead to a change in the polarization.
Since the field and resulting variation to the polarization is not homogeneous, bound charges will be created, i.e. $\bm{\nabla} \cdot \bm{P} \neq 0$.
These bound charges create a depolarizing field that interacts with the rest of the sample, meaning that a higher depolarizing field leads to a higher increase in energy due to the tip, and thus a higher effective stiffness.
Two different contributions to this mechanism can be identified, resulting from the shear and longitudinal parts of the piezoelectric tensor, shown in Fig.~\ref{fig:BTO_depolarizing}(a,b) respectively.

\begin{figure}[h]
	\IncludeGraphics{depolarizing.png}
	\caption{\label{fig:BTO_depolarizing}{\bf Piezoelectric effect} A pictorial representation of the contribution of the shear (a) and longitudinal (b) piezoelectric effect. The arrows denote the direction of the polarization, with the wall located on the boundary between the purple and yellow shaded regions. The tip is represented by the grey bell-shapes, with the resulting change in bound charge and depolarizing field indicated in blue and red. All changes to the polarization due to the applied tip are exaggerated for clarity. Figure taken from Ref.~\cite{Stefani2020}}
\end{figure}

The shear piezoelectric contribution leads to the appearance of a small in-plane component to the polarization.
At the wall, these have the same sign, leading to a head to tail configuration of the polarization, and a relatively small depolarizing field.
Inside the domain, however, they have opposite sign which leads to a tail-tail or head-head configuration with a large contribution to the depolarizing field.
Similarly, the bound charges that appear due to the longitudinal piezoelectricity have the same sign when the tip is applied inside the domains, and opposite sign when it is applied at the wall (see panel (b) of Fig.~\ref{fig:BTO_depolarizing}).
This again leads to an increased contribution to the depolarizing field inside the domains, as compared to the wall, leading again to a higher effective stiffness.

Simulations, similar to those that will be discussed later, were performed for a 2D geometry, confirming this mechanism (see Ref.~\cite{Stefani2020} for further details).
It was found that that the shear piezoelectricity (Fig.~\ref{fig:BTO_depolarizing}(a)), leading to the in-plane contribution to the polarization, resulted in the largest contribution.
The combined total of the shear and longitudinal effects leads to the wall appearing 5\%-10\% softer than the domains.
It should be mentioned, however, that this effect is caused by the profile of the polarization.
As discussed before, the lengthscale at which the polarization reverses is a couple of nm.
This means that the piezoelectric contribution only occurs in this narrow region, whereas the experimental observations point to a much wider soft region (around 70 nm).
All clues therefore point to the strain texture as the main actor in the softening effect.

We now turn to a more in-depth investigation of this strain texture associated with the DW, and how it influences the stiffness locally.
The crux is that due to the fundamentally different structure of the DW, additional soft phonon modes appear which are not present in the domain \cite{Chen2020}.
The two most obvious ones are the sliding and breathing modes, which can be excited by the applied tip, ultimately making the wall appear softer in doing so.

Before giving a detailed description of these modes, we turn to the theory that we will use throughout the remainder of the chapter. 
A continuum Ginzburg-Landau-Devonshire (GLD) model \cite{Zhirnov1959,L.N.Bulaevskii1963,Marton2010} was chosen due to the mesoscopic lengthscales that are involved.
One could argue that this simplification is detrimental to the description of the very sharp domain walls, sporting a width on the order of a couple of unit cells (5-20 \AA) \cite{Zhirnov1959}.
Especially to describe the movement of the DW, which will be shown to be one of the major contributors to the softening, it is necessary to take into account the Peierls-Nabarro barriers that exist due to the lattice structure.
Naively, it seems that only atomistic first-principles calculations manage to reproduce these accurately \cite{Meyer2002}, since in a perfect continuum picture no such barriers exist.
However, as we will touch on in further detail when the simulation technique is discussed, a numerical analogue to these inter-cell barriers appears due to the discretization of the sample geometry \cite{Marton2018}.  
A fully microscopic ab-initio description using e.g. DFT is unfeasible from the computational point of view, requiring a dynamic calculation with on the order of 10s of thousands of atoms.
This is because, while the DW itself is very sharp (a couple of unit cells), the associated strain texture is much wider.
Indeed, looking at the experimental measurements in Fig.~\ref{fig:BTO_experiment}(b), the region where the softening is observed is around 70 nm wide.

We therefore turn our attention to the GLD model, for which the energy density can be written down in terms of the primary order parameter for the ferroelectric polarization $P$, and associated strain $\varepsilon$ as:
\begin{eqnarray}\label{eq:BTO_energy}
&&f = f_{L}+f_{G}+f_{c}+f_{q}+f_{fl},\\
&&f_{L} = \alpha_{ij}(T)P_iP_l + \alpha_{ijkl}(T)P_{i}P_{j}P_{k}P_{l} + \alpha_{ijklmn} P_i P_j P_k P_l P_m P_n,\\
&&f_{G} = \frac{1}{2}G_{ijkl}\partial_i P_j\partial_k P_l,\\
&&f_{c} = \frac{1}{2}C_{ijkl}\varepsilon_{ij}\varepsilon_{kl},\\
&&f_{q}= - q_{ijkl}\varepsilon_{ij}P_{k}P_{l},\label{eq:qpp}\\
&&f_{fl}=\frac{1}{2}f_{ijkl}(\varepsilon_{ij}\partial_k P_l - P_i\partial_j\varepsilon_{kl}),
\end{eqnarray}
where $\partial_i$ signify spatial derivatives, and the indices enumerate ${x,y,z}$ with an implied summation over the repeated ones.
The first term is the Landau free energy which describes the phase transition and subsequent formation of the uniform ferroelectic polarization.
Both the second and fourth order coefficients $\alpha_{ij}$ and $\alpha_{ijkl}$ are temperature dependent, and switch sign at the phase transition temperature.
This means that a sixth order term with $\alpha_{ijklmn}$ has to be included in order to bound $P$ below the transition temperature.
The second term $f_G$ denotes the Ginzburg contribution to the energy, penalizing the spatial variation of $P$.  
This term influences the width of DWs, where a larger $G$ leads to wider walls and vice versa.
The elastic energy density is described by $f_c$ with stiffness tensor $C_{ijkl}$, which has the form of the standard Hooke's law.
$f_q$ signifies the electrostriction, which is the main term that couples the polarization to the strain, and causes the domains to be stretched along the direction of the polarization.
It is the combination of this term with the elastic one, that ultimately leads to the strain texture associated with the wall.
Lastly, to be complete, we can include the flexoelectric contribution $f_{fl}$, coupling gradients of strain to $P$ and vice versa.
In the results here reported, we chose to neglect it since we found from our simulations that it only leads to very small effects which do not influence the behavior we seek to explain.
The coefficients for the model for BaTiO$_3$ are given in Tab.~\ref{tab:BTO_param}.
Due to the parent cubic symmetry, only a limited set of these is unique, for example $C_{1111} = C_{2222} = C_{3333}$, and $C_{1212} = C_{2121} = C_{2323} = C_{3232} = C_{1313} = C_{3131}$, and similar for G, q, and f. 

\begin{table}
\begin{tabular}{|c|c|c|c|c|c|}
	\hline
	 $\alpha$ & & $G$ & & $q$ &\\
	 \hline
	 $\alpha_1$ & $3.34\cdot 10^5 (T - 381)$  & $G_{11}$ & $51 \cdot 10^{-11}$ & $q_{11}$ & $14.2 \cdot 10^{9}$ \\
	 $\alpha_{11}$ & $4.68 \cdot 10^6 (T-393) - 2.02 \cdot 10^8$ & $G_{12}$ & $-2 \cdot 10^{-11}$ & $q_{12}$ & $-0.74 \cdot 10^{9}$ \\
	 $\alpha_{12}$ & $3.23 \cdot 10^8$ & $G_{44}$ & $2 \cdot 10^{-11}$  & $q_{44}$ & $1.57 \cdot 10^{9}$ \\
	 \cline{3-6}
	 & & $C$ & & $f$ &\\
	 \cline{3-6}
	 $\alpha_{111}$ & $-5.52 \cdot 10^7 (T - 393) + 2.76 \cdot 10^6 $ & $C_{11}$ & $27.5 \cdot 10^{10}$ & $f_{11}$ & $0.85$ \\
	 $\alpha_{112}$ &  $4.47 \cdot 10^9 $ & $C_{12}$ & $17.9 \cdot 10^{10}$ & $f_{12}$ & $-0.5$  \\
	 $\alpha_{123}$ & $4.91 \cdot 10^9$ &$C_{44}$ & $5.43 \cdot 10^{10}$ & $f_{44}$ & $ 0.072$ \\
	 \hline
\end{tabular}
\caption{{\bf Ginzburg-Landau-Devonshire model parameters} The parameters are reported in Voigt notation, e.g. $C_{11} = C_{1111}$, $C_{12} = C_{1122}$ and $C_{44}= C_{1212}$.  SI units are used, and T = 300 K in the simulations.\label{tab:BTO_param}}
\end{table}

To find the static equilibrium state in the most general sense, the integrated free energy $F[P] = \int d^3x f(P(x))$ needs to be minimized, for which the variational method can be used.
This leads to the well known Euler-Lagrange equations \cite{Cao1991, Marton2010}:
\begin{align}
	\label{eq:BTO_euler}
	\frac{\partial}{\partial x_j}\left( \frac{\partial f}{\partial \partial_j P_i}\right) - \frac{\partial f}{\partial P_i} &= 0, \\
	\frac{\partial}{\partial x_j}\frac{\partial f}{\partial \varepsilon_{ij}} = 0.
\end{align}

In the homogeneous case of a single domain with $P_z$ (which we write $P$ in the following) and $\varepsilon_{zz}$ (written as $\varepsilon$) and no external forces, Eq.~\ref{eq:BTO_euler} is reduced to  
\begin{align}
	\frac{\partial f}{\partial \varepsilon} &= 0 \Leftrightarrow \varepsilon = \frac{q_{11}P^2}{C_{11}}\label{eq:BTO_e0},\\
	\frac{\partial f}{\partial P^2} &= 0 = \alpha_1 + (2 \alpha_{11} - \frac{q_{11}^2}{C_{11}})P^2 + 3\alpha_{111}P^4 \\
	& \Leftrightarrow \\
	P^2 &= \frac{-(2\alpha_{11} - \frac{q_{11}^2}{C_{11}}) + \sqrt{(2\alpha_{11}-\frac{q_{11}^2}{C_{11}})^2 - 12 \alpha_{111} \alpha_1}}{6\alpha_{111}}.
\end{align}
If the parameters of Tab.~\ref{tab:BTO_param} are filled in, we find $P = \pm 0.311$ C/m$^2$ and $\varepsilon = 5 \cdot 10^{-3}$.
The value for the polarization is higher than the one found when electrostriction is not included ($P = 0.265$ C/m$^2$ \cite{Marton2010}), because the system can lower its energy through $-q_{11}P_z^2\varepsilon_{zz}$ by increasing $P_z$ and having tensile strain $\varepsilon_{zz} > 0$.
Similarly, when all terms are included in the full numerical simulation, we find for the domains that $P_z$ is higher still, with values of $\pm 0.363$ C/m$^2$ and $1.4 \cdot 10^{-2}$ for the polarization and strain, respectively.

The effective stiffness $\tilde{C}_{ijkl}$ can be found in general by taking the double derivative of the free energy with respect to $\varepsilon$:
\begin{equation}
	\tilde{C}_{ijkl} = \frac{\partial^2 f}{\partial \varepsilon_{ij} \partial \varepsilon_{kl}},
\end{equation}
or, making the same assumptions as above (only $P_z$ and $\varepsilon_{zz}$), we arrive at an effective stiffness of
\begin{equation}
	\tilde{C} = C - \frac{q_{11}^2}{2\left(\alpha_{11}^2 - 3 \alpha_{111}\left(\alpha_1  - \frac{q^2 P^2}{C_{11}}\right)\right)}\label{eq:BTO_domainC}.
\end{equation}
By again filling in all parameters for the homogeneous case, we find $\tilde{C}_d = 0.778 \,C$ in the domain.
At the wall $P$ is zero, so that if the energy penalty for shear strain is not included, $\varepsilon_{zz} = 0.0$, which would lead to an effective stiffness of $\tilde{C}_w = 0.642 \, C = 0.82\, \tilde{C}_d$, according to Eq.~\ref{eq:BTO_domainC}.
While this looks like a triumph for the theory (since the experimental measurements found a $19\%$ softer wall), in reality the shear elastic constants $C_{44}$ and compatibility relations will lead to a nonzero strain $\varepsilon_{zz}$ at the wall.
From our simulations we find $\varepsilon_{zz}$ on the surface, at the wall, to be around $40\%$ of the value in the domain, leading to $\tilde{C}_w = 0.79 \, C = 1.01 \tilde{C}_d$.
The strain texture is shown in Fig.~\ref{fig:BTO_wall}(b).
Simulations with a very narrow tip confirm this result, which can thus not explain the experimentally observed softening.
We thus have to find a different source for the observed DW softening.

\begin{figure}[h]
	\IncludeGraphics{domainwall.png}
	\caption{\label{fig:BTO_wall} {\bf Domain Wall profile} The surface of the 180$^\circ$ DW is shown, with the coloring denoting the polarization (a) and $\varepsilon_{zz}$ (b). The deformation caused by the strain is used to warp the geometry with.}
\end{figure}
As alluded to before, we look to the DW localized phonon modes for inspiration.
More specifically, two modes will interact with a finite-width tip: the breathing mode and sliding mode.
Both appear as a result of the above described diminished strain at the wall, resuling in a dip at the surface of the material, as shown in Fig.~\ref{fig:BTO_wall}.
The breathing mode is associated with a change of the width of this dip.
When a tip that has a wider radius than the dip is pressed into the material, it will apply a force on either side of the wall, increasing its width.
This leads to an energy gain through the Ginzburg term $(\bm{\nabla}\bm{P})^2$.
When the tip is pressed at the domain, however, the polarization decreases locally which instead leads to an increase of this part of the energy.
The difference between these two situations leads to the first contribution to a softer DW compared with the domains.
For the breathing mode to be excited by the tip, both sides need to be in contact with it, making it hard to believe that the effect can extend up to 30 nm away from the wall, since we know the approximate contact area of the tip is only 7 nm. 

This brings us, finally, to the real focus of our simulations: the DW sliding mode.
As its name suggests, this mode manifests itself in the rigid motion of the DW along its perpendicular direction.
No energy penalties in terms of the GLD model of Eq.~\ref{eq:BTO_energy} are incurred by this motion, and is therefore completely free in the perfect continuum case.
When the tip is then applied in an area where the strain texture associated with the wall is present, the wall will try to move towards the tip in order to gain elastic energy through the displacement.
Since there is already a dip present at the wall, even before the tip is applied, this shift of the wall leads to a relatively big displacement underneath the tip, making the material appear soft.
One can say, equivalently, that the presence and excitation of the soft sliding mode leads to a lower energy penalty from applying the tip.
In the domain this sliding mode is not present, and thus a higher energy penalty and stiffness is observed.

While in the ideal continuum case, the sliding mode is completely free, in reality this is not the case.
As mentioned before, in a real material there are the Peierls-Nabarro barriers between the unit-cells, possible pinning defects, and electrostatic effects that will increase the energy of the sliding mode.
It is thus extremely hard to make an analytical description of the behavior.
We can still make statements about two extreme situations: if the force of the tip is large enough, the wall will fully slide towards it, maximizing the elastic gain, if the force is very small, the wall remains inside the original Peierls-Nabarro potential, but deviates from the equilibrium position.
% \lp{The situation that happens in the real material is more like a mix between the two, the top part of the wall bends almost completely towards teh tip, but it's not moved as a whole because the bottom/bending electrostatics pins it. Can we say that these things are causing the potential for the entire wall to behave like the one we describe below?}

A simple free energy expansion can be made for the latter situation, with the wall position $x_{DW}$ (originally zero) pinned by a parabolic potential, and perturbed by a tip applying a force $F_z$ at $x_{tip}$,
\begin{equation}
	E = E_0 - F_z u_z (x_{tip} - x_{DW}) + \frac{m\omega^2 x_{DW}^2}{2}.
\end{equation}
We expand this equation under the assumption of a small $x_{DW}$, i.e. that the wall doesn't move far from the $x_{DW}=0$ equilibrium case.
Minimizing the energy under this assumption, we obtain $x_{DW} = -F u'(x_{tip})/m \omega^2$, with a compliance correction $\Delta c = u'(x_{tip})^2/(m\omega^2)^2$.
Thus, we can conclude that the effect is greatest when tip is applied where $u'(x_{tip})$ is large, i.e. within the strain variation caused by the above discussed electrostrictive coupling.
This part of the effect is pictorially represented in panel (b) of Fig.~\ref{fig:BTO_theory}.


In reality, depending on the size of the tip, where it is applied, and the size of the force, a combination of the two above mentioned extremes will occur.
From the experimental observations, we posit that the applied force is large enough such that when the center of the tip is close enough to the wall, the upper part of will bend completely to it.
In doing so, the dip at the surface of the wall moves underneath the tip maximizing the elastic energy gain.
As discussed before, this leads to a large apparent softening and is most likely to be what happens within the 70 nm region around DWs.
Since it is clear from the repeated experimental measurements that the walls do not move permanently, we claim that the lower portion of the wall remains at the center of its original Peierls-Nabarro potential.
This is probably due to a degree of pinning by defects, or the substrate.

Due to the complexity of the model, and the interaction of the strain with the tip, we forfeit the search for an analytical description and instead proceed with numerical simulations to verify the above statements.

\section{Methods}
To solve the model, we have to compute and minimize the free energy density in Eq.~\ref{eq:BTO_energy}, which is written in terms of the values and gradients of two order parameters $P$ and $u$.
In the coninuum formulation, these are defined for each point in space and are thus sometimes referred to as fields, leading to another name that is commonly found in the literature to refer to these types of models: phase field models.
Our task is to minimize the total free energy, which can be calculated by integrating Eq.~\ref{eq:BTO_energy} over the geometry volume.
The values of the $P$ and $u$ fields that minimize this total free energy will then be the equilibrium configuration of the system.

The integration in the continuum formulation can be written as $F[P,u]=\int_V d\bm{r} f(\bm{P}(\bm{r}),\bm{u}(\bm{r}))$.
We perform this integration numerically, due to the complexity of Eq.~\ref{eq:BTO_energy} and the non homogeneous situation that occurs when a tip is applied.
The Finite Elements method (FEM) provides a framework to do exactly that.
It's ability to handle complex geometries and large lengthscales makes it one of the most used methods to numerically solve mathematical and physical models.
In light of trying to be self-contained, we will give a short introduction to the topic based on Ref.~\cite{Biner}.

A fundamental building block of this method is the isoparametric representation.
In this representation, the geometry is divided into a set of elements that obey certain connectivity requirements, the main one being that each node must be connected to the same number of neighbor nodes.
An often used element for 2D are triangles as shown in Fig.~\ref{fig:BTO_fem}(a).
We will use this case as an example out of simplicity.
A global-to-local coordinate transformation is then performed by using shape functions that define the morphology of the element.
With the global coordinates of the nodes of the elements, any coordinate inside the element can be written as
\begin{align}
x(\zeta, \eta) &= \sum_i^n N_i(\zeta, \eta) x_i\\
y(\zeta, \eta) &= \sum_i^n N_i(\zeta, \eta) y_i,
\end{align}
and functions $f$ are interpolated as:
\begin{equation}
	f(\zeta, \eta) = \sum_i^n N_i(\zeta, \eta) f_i.
\end{equation}
In these equations, $i$ iterates through the $n$ nodes of the element, and $\zeta$ and $\eta$ are the axes of the local coordinate system.
It is clear that each node has a separate shape function.
They have to be chosen in such a way that they follow certain conditions:
\begin{itemize}
	\item Interpolation condition: $N_i$ is 1 at node $i$ and zero at the other nodes.
	\item Local support condition: $N_i$ vanishes at each edge that does not contain $i$.
	\item Interelement compatibility condition: Satisfies continuity between neighboring elements that include node $i$.
	\item Completeness condition: Any field that is a linear polynomial in $x$ and $y$ is represented exactly.
\end{itemize}

Since we need the derivatives of the $P$ and $u$ fields in order to calculate the free energy density, we perform the chain rule and find for any function $f$
\begin{align}
	\label{eq:BTO_derivatives}
	\frac{\partial f}{\partial \zeta} &= \sum_i^n \frac{\partial N_i}{\partial \zeta} \cdot f_i \\
	\frac{\partial f}{\partial \eta}  &= \sum_i^n \frac{\partial N_i}{\partial \eta} \cdot f_i.
\end{align}
In the numerical implementation, these derivatives are found for each element by first computing the Jacobian with partial derivatives of the global coordinates $x$ and $y$ w.r.t the local ones $\zeta$ and $\eta$ and then performing an inversion.
This requires calculating the determinant of the Jacobian, which can also be used to calculate the area or volume of the element.

Using these definitions, one can select certain points, the so-called quadrature points, inside each element at which the function values for the $P$ and $u$ fields are interpolated from their values at the nodes.
Filling them into the free energy density Eq.~\ref{eq:BTO_energy} leads to an approximation of the contribution of the volume inside each element to the total free energy.
The total free energy is then calculated as the sum over all these contributions. 
The nodal values of the fields are therefore the degrees of freedom of our model. 
A big bonus of the isoparametric representation, applied in this way, is that gradients of the fields can be evaluated purely locally, inside each element, through the use of the interpolation method and field values at the nodal points (see Eq.~\ref{eq:BTO_derivatives}).
It also allows for a great flexibility through the density of the chosen grid, the morphology of the elements, and the order of interpolating functions used.

\begin{figure}
	\begin{subfigure}{0.49\textwidth}
		\IncludeGraphics{fem_grid.png}
		\caption{2D grid with triangular elements, \cite{Biner}}
	\end{subfigure}
	\begin{subfigure}{0.49\textwidth}
		\IncludeGraphics{fem_element.png}
		\caption{Triangular element, \lp{wikipedia}}
	\end{subfigure}
	\begin{subfigure}{0.49\textwidth}
		\IncludeGraphics{fem_cubegrid.png}
		\caption{Geometry used in simulations}
	\end{subfigure}
	\begin{subfigure}{0.49\textwidth}
		\IncludeGraphics{fem_tetrahedron.png}
		\caption{Zoom on one element}
	\end{subfigure}
	\caption{\label{fig:BTO_fem} Example of the morfology of a 2D finite element grid.}
\end{figure}

In our case, we use a rectangular geometry uniformly spanned by tetrahedron elements, as shown in Fig.~\ref{fig:BTO_fem}(c,d).
The uniform mesh is largely motivated by implementation complexity, since we use a mostly in-house developed code based on the FEM building blocks supplied by the \href{https://github.com/KristofferC/JuAFEM.jl}{JuAFEM.jl} package.
Another reason for the uniform grid, is that this mimics numerically the Peierls-Nabarro barriers that are created by the lattice.
As will be discussed further below, these pin the wall to a certain degree and should be taken into account for the simulation to be realistic.

The last building block for the simulation is a way to optimize the fields in order to reach the equilibrium condition at minimum energy, both with and without applied tip.
To achieve this we use the Conjugate Gradient method \cite{Hestenes1952,Hager2005} as implemented in the package \href{https://github.com/JuliaNLSolvers/Optim.jl}{Optim.jl}.
It's an iterative scheme that uses the gradient and previous step to decide on the next step direction. 
This requires us to determine the partial derivatives of the total energy in terms of all the degrees of freedom, i.e. the value of each component of $P$ and $u$ at the node points of the mesh.
We chose to use a forward automatic differentiation scheme as implemented in \href{www.juliadiff.org/ForwardDiff.jl/latest/}{ForwardDiff.jl}, again for its remarkable simplicity and speed (as an idea, on a 24 core E5-2680 v3 server, the $\approx$ 3.5 million partial derivatives are computed in around 2 seconds).

Using the parameters from previous ab-initio results \cite{Marton2010} and reported in Tab.~\ref{tab:BTO_param}, we first optimized the equilibrium situation for both a uniform domain and a single domain wall, the result of which is shown in Fig.~\ref{fig:BTO_wall}.
A gaussian force field, $\frac{a}{\sigma \sqrt{2\pi}}e^{-\frac{(x-x_0)^2}{2\sigma^2}}$ with $\sigma = 1 \cdot 10^{-9}$ representing the diameter of the contact area and $a = 1 \cdot 10^{-18} \frac{eV}{nm^3}$, was then applied at various positions $x_0$ throughout both geometries.
The uniform domain simulation is used as a measure of the finite-size effects that are inherently present in our simulations due to the long rangedness of strain and non-infinite geometry since we use open boundary conditions.

This causes the indentation at the center of the geometry for a single domain to be less than the one when the tip is applied off-center, due to less material being present to support the force.
The effect this has on the simulations is shown in Fig.~\ref{fig:BTO_domain_strain}.
Since this is unphysical, we compensate for this by adding the differences to the results in the geometry with a wall present.

\begin{figure}
	\IncludeGraphics{xsize_domain_strain.png}
	\caption{\label{fig:fig:BTO_domain_strain}{\bf Finite size effects in domain.} a) Maximum indent by the applied tip, the smaller $L_x$ results in a larger difference of the indentation at the edge of the  geometry versus in the center. Since this simulation is for a domain the tip should result in an identical indentiation no matter where it is applied. It is also clear that when the geometry is smaller, the central indentation is also larger due to less total material supporting the tip. b) Visual demonstration of the asymmetric deformation and $\varepsilon_{zz}$ that results from the open boundary conditions and a tip applied at the edge of the geometry.}
\end{figure}

To conclude this section, we would like to comment on the Peierls-Nabarro barriers \cite{Peierls1940,Nabarro1947}, since they are of great influence on the movement of the DW.
In essence, it is a result from the non-homogeneity of the crystalline lattice on the unit-cell lengthscale.
That causes the DW to have a preferred center inside one of the unit-cells, usually either on the edge or in the middle.
A thorough study from first-principles was performed by Meyer et al. \cite{Meyer2002}, where it was correctly stated that only by using this degree of granularity leads to accurate results.
The purely continuum GLD model, however, does not account for this contribution.
As mentioned before, the DW sliding is therefore completely free, which is at odds with the real behavior.
We are thus faced with the commonly reappearing issue of having to simulate physics that occur at different lengthscales.
In this case, however, we are to some extent saved by a spurious numerical effect that mimics the naturally occuring Peierls-Nabarro barrier.
This was investigated by Marton in Ref.~\cite{Marton2018} for the case of BTO.
It boils down to the fact that through the approximated interpolation of the fields, it is numerically favorable to situate the center of the wall at a node, rather than inside an element.
In this way the simulation avoids sampling the paraelectric state, which is at the top of the double-well potential that results from the Landau part $f_l$ of the energy in Eq.~\ref{eq:BTO_energy}, and causes the non-zero $P$ in the domains.
When the wall is forced to move accross the grid due to the applied tip, it is forced to overcome this high-energy configuration in order to jump between equilibrium positions.
This in turn causes the numerical Peierls-Nabarro barrier.

\section{Results}
Since we implemented our own version of the finite element method, we perform some consistency checks with previous calculations.

The DW energy we obtain is 15.2 mJ/m$^2$, very close to the value of 16 mJ/m$^2$ found from a first-principles calculation in Ref.~\cite{Padilla1996}.
We furthermore verified that it is not influenced by the size of the numerical geometry, or the density of the mesh, indicating that the numerics of our method do not influence energetics of the static wall.
To confirm the existence and behavior of the numerical Peierls-Nabarro barrier, we performed simulations where first the wall was optimized, and then rigidly shifted inside the grid.
The results are shown in Fig.~\ref{fig:BTO_peierls_nabarro}.
\begin{figure}[h!]
	\IncludeGraphics{peierls_nabarro.png}
	\caption{\label{fig:BTO_peierls_nabarro}{\bf Numerical Peierls-Nabarro barriers.} a) The evolution of the barrier when the wall is shifted with $\delta_w$ away from the original position at 0. The periodicity of the lattice is mimicked by the barriers, where the distance between maxima is given by the elementsize. It is also clear that large element sizes lead to larger barriers. b) The evolution of the barrier height with elementsize.}
\end{figure}
For all elementsizes, the barriers are very close to the harmonic shape of the real Peierls-Nabarro barriers. The larger the elementsize, the larger the energy and periodicity of the barriers.
In the following we chose the elementsize to be 0.3 nm, offering a good balance between amount of pinning and computational cost. 
A demonstration of the breathing mode is shown in Fig.~\ref{fig:BTO_breathing}, where the absolute value for the polarization is shown under the application of a tip with varying force.
We can see that the wall indeed widens slightly when higher forces are applied. It is a small effect, however, and we found that the force applied by the tip to cause significant widening is much larger than the experimental one.

We now turn to the domain wall sliding.
For this, we applied the tip force field at various distances away from the wall.
The softening is estimated as the ratio of the surface deformation between the domain and the wall.
Two sets of simulations were performed, one for which the bottom of the wall was kept fixed, to mimick the bending behavior, and one where we let the wall as a whole slide freely.
The results of the former are shown in Fig.~\ref{fig:BTO_bending_sim}.
\begin{figure}[h!]
	\IncludeGraphics{2D_bending}
	\caption{\label{fig:BTO_bending_sim}{\bf Bending Wall} Simulations where the bottom of the wall is kept fixed to the equilibrium without a tip. In each panel, the coloring indicates the position where the tip is aplied to the sample. a) Surface profile of the wall. b) Polarization distribution at the surface. c) Deformation of the surface after applying the tip. d) Maximum absolute value of the deformation in (c). e) Relative stiffness depending on where the tip is applied.}
\end{figure}
As seen in Fig.~\ref{fig:BTO_bending_sim}(e) and Fig.~\ref{fig:BTO_sliding_sim}(e), and predicted by the above statements, the wall is softest not in the center, but rather at the point where $u'$ or $\varepsilon_{xz}$ is highest.
This leads to the highest force applied to the wall that either makes it bend or slide.
Comparing the two simulation protocols, we can also see that when the wall is allowed to slide, the region where softening takes place is much wider, and the extent of the softening is higher.
The real situation is a combination of these two. Due to the relatively small $z$ dimension that we used for our simulations (20 nm), as compared with the sample in the experiment (0.3 cm), bending the wall is a lot more difficult in our simulations.
The wall therefore probably appears as rigidly sliding towards the tip inside the 70 nm in-plane region around the wall, for a depth up to 20 nm.
However, due to the bending that happens for larger lengthscales along the $z$-direction, the wall moves back towards the equilibrium position when the tip moves too far away from it.

We claim that this behavior is the main source of the observed softening.


\begin{figure}
	\IncludeGraphics{breathing.png}
	\caption{{\bf Breathing mode.} \label{fig:BTO_breathing}}
\end{figure}
\begin{figure}
	\IncludeGraphics{theory}
	\caption{\label{fig:BTO_theory}}
\end{figure}

\section{Conclusions}


\printbibliography
