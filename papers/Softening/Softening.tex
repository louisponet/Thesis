\chapter{Mechanical softening in Ferroelectric domain walls}


\section{Introduction}
So far, the focus of this work was largely on the behavior of, and interaction between various orders in uniform domains.
A thorough understanding of these physics is of fundamental importance, since it provides the building blocks for more complex scenarios.
Reality, however, presents to us almost exclusively these more complex scenarios.
The reason for this is that while going through a phase transition with an associated spontaneous symmetry breaking, different parts of the material which are separated in space will separately (and usually randomly) choose one of the degenerate states with different values of the order parameters.
One could argue that second order phase transitions could happen coherently throughout the entire system, but this assumes that the crystals are completely uniform and without defects, and that the temperature variation happens at an infinitely slow rate.
\lp{there is also the issue of dipolar fields, should I mention that?}
In reality these assumptions are almost always invalid, inevitably leading to domains separated by domain walls (DWs) in which one or more order parameters interpolate between the values in the neighboring domains.
The fundamental difference between DWs and the domains themselves has led to a great amount of research interest, both from the fundamental and technological point of view.
The physics that govern the region of the DW is usually richer than that of the domains, since the domains force that region to not be at a local energetic minimum.
This is often associated with a local inversion of the curvature of the energy potential, leading to a potential softening of the order parameters locally.
DWs are also a manifestly two dimensional region embedded in a three dimentional medium, which can have a myriad of interesting consequences.
An obvious example where DWs are exploited technologically is in ferroelectric information storage devices.
Here the their small size, which is beneficial from the density point of view, and the fact that their location can be easily controlled by applied electric fields, is utilized.
Certain materials can harbor charged conducting DWs, separating the manifestly nonconductive domains.
By applying electric fields it has been shown that these can be created and destroyed at will, increasing or decreasing the conductivity of the device.
This conductivity can in turn be probed, effectively reading back what ``data'' was written previously\lp{citation}.

While this kind of technological promise has driven much of the research of DWs towards their electronic properties, the coupling between electric polarization and internal strain puts the spotlight on their mechanical properties.
This field is much less developed and has many unanswered questions. \lp{mention piezoelectrics?}
It has been shown that ferroelectric-ferroelastic (ferroelastic walls separate domains with differing strain textures) DWs can be moved by applying stress \cite{Schneider2001}. This is not surprising since the different strain textures couple differently to the mechanical perturbation, causing an imbalance and associated movement of the separating DW.
More interesting is the fact that the polarization itself can also be influenced by purely mechanical means, for example by the flexoelectric effect, with energy density:
\begin{equation}
f_{fl} = \frac{1}{2}f_{jklm}(\varepsilon_{jk}\partial_mP_l-P_l\partial_m\varepsilon_{jk}),
\end{equation}
where repeated indices are summed over, $\varepsilon$ denotes the strain and $P$ the ferroelectric polarization. An applied strain gradient will as an internal electric field, thus coupling to the dipoles that constitute $P$, ultimately leading to the above expression.
While this effect is generally small (i.e. the elements of the flexoelectric tensor $f_{jklm}$ are small), it scales inversely with the size of the sample, meaning that it becomes increasingly important at the nanoscale of current state of the art electronic devices.
Thus, using a tip to apply a strain gradient to the surface of a ferroelectric material allows one to mechanically write domain patterns and DWs at will \cite{Lu2012}.

These developments have increased the research into the mechanical properties of these materials in recent years. Here we focus on the mechanical properties of purely ferroelectric, 180$^\circ$, DWs.
As it turns out, these walls appear mechanically softer than the domains they separate.
A similar softening has been previously observed and studied for ferroelastic DWs \cite{Lee2003}, but purely electric DWs have largely flown under the radar of mechanical studies.
One reason is that the size of ferroelectric domain walls is on the order of a couple of unit cells, and was thus perceived too small to be detected with mechanical means, seen as tip contact areas are generally at least 100 unit cells.
As it turns out, however, there is a strain texture associated with these DWs, which extends much further than the region in which the primary order parameter changes.
This can qualitatively be understood by considering the electrostriction energy density
\begin{equation}
f_{q}=-\frac{1}{2}\varepsilon_{jk}q_{jklm}P_{l}P_{m},\label{eq:qpp},
\end{equation}
which causes domains to be stretched along the direction of $P$.
No such stress exists inside the wall itself, since $P=0$, leading to an indentation with an associated long range strain texture.
The extent of strain textures tends to generally be a lot larger because sharp changes in the strain are very unfavorable from an elastic point of view.
This mechanical texture associated with the DW can be picked up mechanically by the applied tips and allows to make the observations that are the subject of this Chapter.

\section{Experimental}
Before going into the theoretical details that describe the physics of this problem, we describe the experiments performed by the group of Prof. Catalan that were the impetus of this research.
In order to determine the generality of the softening of ferroelectric DWs, three single crystal systems were investigated experimentally: LiNbO$_3$, BaTiO$_3$ and PbTiO$_3$.
All measurements are based on Contact Resonance Frequency Microscopy, a scanning probe microscopy technique that uses the resonance frequence of an atomic force microscopy tip in contact with the sample to measure its local stiffness~\cite{Rabe2000}.
A higher sample stiffness leads to a higher frequency, sothat a mapping of the surface stiffness can be made where the main limit on resolution is time.
The results are shown in Fig.~\ref{fig:BTO_experiment}, where the main focus are the right panels, displaying a clear contrast between soft areas close to the wall and harder areas inside the domains.
\begin{figure}
	\IncludeGraphics{experiment.jpg}
	\caption{\label{fig:BTO_experiment} {\bf Ferroelectric polarization and stiffness} (a-b) Periodically poled LiNbO$_3$ single crystal, (c-d) BaTiO$_3$ spontaneously polarized and (e-f) PbTiO$_3$ thin film. The contrast in figures (a,c,d) demonstrate the two opposite out-of-plane orientations of the ferroelectric polarization, and the differing stiffness in (b,d,f). The main focus are the DWs which appear most dark and are thus markedly softer than the domains.}
\end{figure}
One observation that points to the strain texture of the walls as the main actor is the relatively large width of the soft areas around the domain walls.
It is also important to realize that the tip is in contact with the surface at all times during the experiment, ensuring neutrality and thus excluding electrical excitation.
Another feature of the measurements, most clearly present in Fig.~\ref{fig:BTO_experiment}(f) is the diffence in constrast between the up and down domains. This can be attributed to the flexoelectric coupling between the tip induced strain gradient and the polarization. Even though the applied forces were too small to reorient the polarization, the asymmetry in mechanical response can still be observed, and has been proposed as a mechanism for voltage-free mechanical reading of polarization~\cite{Cordero-Edwards2017,Cordero-Edwards2019,Abdollahi2015}.
A similar explanation can not be used for the DWs, though, since they are markedly softer than either domain, resulting in a reduction of the Young's modulus of $\approx 19\%$.

\lp{should I go more into detail of the models used by the experimentalists for the Young's modulus calculation?}

\section{Theory}
Since the mechanical DW softening seems a general property of 180$^\circ$ ferroelectric DWs, we focus on BaTiO$_3$ (BTO) in the following.
Due to the relatively large size of the strain texture associated with domain walls, and the tip that is pressed into the material, we adopt the continuum Ginzburg-Landau-Devonshire model as described in \cite{Marton2010}.  
The free energy density written in terms of primary order parameter $P$ and associated strain $\varepsilon$ can be written as:
\begin{eqnarray}\label{eq:BTO_energy}
&&f = f_{L}+f_{G}+f_{c}+f_{q}+f_{fl},\\
&&f_{L} = \alpha_{ij}P_iP_l + \frac{\alpha_{ijkl}}{2}P_{i}P_{j}P_{k}P_{l} + \frac{\alpha_{ijklmn}}{3} P_i P_j P_k P_l P_m P_n,\\
&&f_{G} = \frac{1}{2}G_{ijkl}\partial_i P_j\partial_k P_l,\\
&&f_{c} = \frac{1}{2}C_{ijkl}\varepsilon_{ij}\varepsilon_{kl},\\
&&f_{q}= - q_{ijkl}\varepsilon_{ij}P_{k}P_{l},\label{eq:qpp}\\
&&f_{fl}=\frac{1}{2}f_{ijkl}(\varepsilon_{ij}\partial_k P_l - P_i\partial_j\varepsilon_{kl}),
\end{eqnarray}
where the indices run through ${x,y,z}$, and a summation is performed over the repeated ones.
The first term is the Landau free energy for a uniform ferroelectic polarization, where terms up to sixth order have to included to bound $P$, since in BTO both $\alpha_{ij}$ and $\alpha_{ijkl}$ are negative below the transition temperature.
The second term denotes the Ginzburg part, i.e. the energy penalty for spatial variations of the polarization.
This term influences the width of DWs, where a larger $G$ leads to smaller walls and vice versa.
The elastic energy density is described by $f_c$ with stiffness tensor $C_{ijkl}$, which has the form of the standard Hooke's law.
$f_q$ signifies the electrostrictio, the main term coupling the polarization to the strain, and causes the domains to be stretched along the direction of the polarization \lp{add some panels like in the discussion of the powerpoint}.
Lastly, to be complete, we include the flexoelectric contribution, $f_{fl}$, since it leads to small but possibly important effects\lp{rather vague}.

To find the static equilibrium conditions in the most general sense, the integrated free energy $F[P] = \int d^3x f(P(x))$ needs to be minimized using the variational methdod, which leads to the well known Euler-Lagrange equations \cite{Cao1991, Marton2010}:
\begin{align}
	\label{eq:BTO_euler}
	\frac{\partial}{\partial x_j}\left( \frac{\partial f}{\partial \partial_j P_i}\right) - \frac{\partial f}{\partial P_i} &= 0, \\
	\frac{\partial}{\partial x_j}\frac{\partial f}{\partial \varepsilon_{ij}} = 0.
\end{align}
In the homogeneous case of a single domain with $P_z$ (which we write $P$ in the following) and no external forces, it is easier to work in terms of $P^2$ and $\varepsilon_{zz}$ (which we write as $\varepsilon$), reducing Eq.~\ref{eq:BTO_euler} to  
\begin{align}
	\frac{\partial f}{\partial \varepsilon} &= 0 \Leftrightarrow \varepsilon = \frac{qP^2}{C}\label{eq:BTO_e0},\\
	\frac{\partial f}{\partial P^2} &= 0 = \left(\alpha - \frac{q^2}{C}\right) + \beta P^2 + \gamma P^4,
\end{align}
where the parameters are those with all $z$ indices, and the solution for $\varepsilon$ was filled into the second equation. This can in turn be solved to find
\begin{equation}
	P_0^2 = \frac{-\beta + \sqrt{\beta^2 - 4\gamma (\alpha - q^2/C)}}{2\gamma}
\end{equation}

The effective stiffness $\tilde{C}_{ijkl}$ can be found by taking the double derivative of the free energy with respect to $\varepsilon$:
\begin{equation}
	\tilde{C}_{ijkl} = \frac{\partial^2 f}{\partial \varepsilon_{ij} \partial \varepsilon_{kl}},
\end{equation}
or, making the same homogeneous assumptions as above, we arrive at a single domain stiffness of

\begin{equation}
	\tilde{C} = C - \frac{2q^2\left(\beta^2-4\alpha\gamma + 3 \varepsilon \gamma q\right)}{\left(\beta^2 - 4 \alpha \gamma + 4 \varepsilon \gamma q\right)^{3/2}}\label{eq:BTO_domainC}.
\end{equation}
Having nonzero $P$ leads to a nonzero $\varepsilon$ as shown by the relation Eq.~\ref{eq:BTO_e0}, and leads to a softening compared to if $P=0$, since the second term of Eq.~\ref{eq:BTO_domainC} is always positive.
This is contradictory with the observations by the experiments, so a different explanation has to be sought.

% As can be seen from the experimental figures, the signature of the domain wall is much wider than the area in which $P$ interpolates between the two values of neighboring domains.
% Coupled with the observation that due to the lower values of $P$ inside the wall, there will be less tensile strain generated by $f_q$, leading to an indentation at the domain wall, with a strain texture extending much further than the wall itself (see the blue line in Fig.~\ref{fig:BTO_rigid_wall}).
% When the tip pushes on this strain texture on either side of the wall, the indentation naturally shifts a little towards the tip without causing extra elastic energy penalties.
% In this rigid wall approximation, the center of the wall is pinned to its equilibrium position due to the Peierls-Nabarro barrier, which can be written as a simple parabolic potential for the wall center coordinate $x$ $\frac{m \omega^2x^2}{2}$.
% \begin{figure}
% 	\label{fig:BTO_rigid_wall}
% 	\IncludeGraphics{rigid_shift.jpg}
% \end{figure}

% This so-called domain wall bending mode leads to an observed softening around the wall, which can be found by expanding the free energy in the sliding of the wall $x_{sl}$:
% \begin{equation}
% 	f = - F u(x-x_{sl}) + \frac{m\omega^2 x^2_{sl}}{2}
% \end{equation}
The first possible source for the mechanical softening originates from the electrostriction term, and the strain texture it results in.
As mentioned before, electrostriction stretches the domains in the direction of the polarization, i.e. $\varepsilon_{zz} \neq 0$ in the domains.
In the domain wall, however, $P_z^2$ is diminished and even zero at the center, causing $\varepsilon_{zz}$ to be dimished, but never reduced to zero due to compatibility relations and the elastic coupling to neighboring unit cells.
Nonetheless, this results in an indentation that forms at the location of the domain wall, as shown pictorially in Fig.~\ref{fig:BTO_theory}(b), and more realistically in (c-d).
As it turns out, the strain texture of this indentation stretches out relatively far \lp{actual derivation and formula for this?} from the domain wall.
This long-rangedness of strain is a general fenomenon, and depends on the morfology of the strain defect \lp{more indepth on this?}. When the tip is then applied in an area where this strain texture is present, the wall will try to bend rigidly (i.e. the strain texture shifts but doesn't change shape) towards the tip in order to gain on the displacement.
This leads to a relatively big displacement when the tip is applied, making the material appear soft.

Even though the interaction between the pinning potential, Peierls-Nabarro barriers, and electrostatics, with the force applied by the tip is hard to analytically describe, we can make statements about two extremes of the behavior: i) If the force of the tip is large enough, the wall slide towards it, maximizing the possible energy gain from the interaction with the tip.
ii) A bending of the wall, where it remains inside the original Peierls-Nabarro potential, but deviates from  the equilibrium position.
\lp{The situation that happens in the real material is more like a mix between the two, the top part of the wall bends almost completely towards teh tip, but it's not moved as a whole because the bottom/bending electrostatics pins it. Can we say that these things are causing the potential for the entire wall to behave like the one we describe below?}

The first case can be ignored because this would mean that in the experiments, the wall would be dragged along the tip since the tip moves at a relatively slow rate, which would lose any contrast between wall and domain during the full measurement.
We therefore try to formulate a simple free energy expansion for the second situation, where we assume that the wall at $x_{DW}$ is pinned by a parabolic potential, and perturbed by a tip applying a force $F_z$ at $x_{tip}$,
\begin{equation}
	E = E_0 - F_z u_z (x_{tip} - x_{DW}) + \frac{m\omega^2 x_{DW}^2}{2}.
\end{equation}
We can expand this equation under the assumption of a small $x_{DW}$, i.e. that the wall doesn't move far from the $x_{DW}=0$ equilibrium situation. Together with minimizing the energy we obtain $x_{DW} = -F u'(x_{tip})/m \omega^2$, with a compliance correction $\Delta c = u'(x_{tip})^2/(m\omega^2)^2$. Thus, we can conclude that to maximize the softening, the tip should be applied where $u'(x_{tip})$ is large, i.e. within the strain variation caused by the above discussed electrostrictive coupling. This part of the effect is pictorially depicted in panel (b) of Fig.~\ref{fig:BTO_theory}.

\begin{figure}
	\IncludeGraphics{theory}
	\caption{\label{fig:BTO_theory}}
\end{figure}

In reality, depending on where the tip is pressed, a combination of the two above mentioned extremes will happen.
When the center of the tip is close enough to the wall, the upper part of it will completely bend to shift the indentation underneath the tip.
The lower portion of the wall will remain at the center of its original Peierls Nabarro potential, since it experiences less effect of the tip.
It is therefore impossible to solve analytically the realistic situation, and we proceed with simulations to make semi-quantitative statements on the behavior.

\section{Methods}
The Finite Elements method (FEM) provides a natural framework to solve continuum problems, sometimes also referred to as phase-field problems, that involve gradients such as strain (gradient of the displacement $u$) and the gradient of polarization \cite{Biner}.

Similar to the well-known finite-difference methods, FEM is a local method, dividing the problem into separate domains (the elements) for which the contribution to the total energy can be calculated locally.
A fundamental building block of this method is the isoparametric representation.
In this representation, the geometry is divided into a set of elements that obey certain connectivity requirements, e.g. in Fig.~\ref{fig:BTO_fem}(a) a 2D geometry is divided into triangular elements.
The values of the the displacement field $\mathbf{u}(\mathbf{x})$ and ferroelectric polarization $\mathbf{P}(\mathbf{x})$ are defined on the nodal points that link the different elements shown by the black dots of Fig.~\ref{fig:BTO_fem}(b).    
\begin{figure}
	\begin{subfigure}{0.49\textwidth}
		\IncludeGraphics{fem_grid.png}
		\caption{2D grid with triangular elements, \cite{Biner}}
	\end{subfigure}
	\begin{subfigure}{0.49\textwidth}
		\IncludeGraphics{fem_element.png}
		\caption{Triangular element, \lp{wikipedia}}
	\end{subfigure}
	\begin{subfigure}{0.49\textwidth}
		\IncludeGraphics{fem_cubegrid.png}
		\caption{Geometry used in simulations}
	\end{subfigure}
	\begin{subfigure}{0.49\textwidth}
		\IncludeGraphics{fem_tetrahedron.png}
		\caption{Zoom on one element}
	\end{subfigure}
	\caption{\label{fig:BTO_fem} Example of the morfology of a 2D finite element grid.}
\end{figure}
Inside each element a local coordinate system with axes $\eta$ and $\zeta$ can then be defined as shown by the red arrows in Fig.~\ref{fig:BTO_fem}(b).
Together with the shape functions that are defined on each local element \lp{Should I give some more info on what they are}, this allows for the values of the fields to be interpolated at all points inside the elements from their values at the nodes.
Since the element represents a given volume of the total geometry, the contribution of each element to the total integral can thus be evaluated.
A big bonus of this framework is that gradients of the fields can be evaluated purely locally, inside each element, through the use of this interpolation method.
It also allows for a great flexibility through the density of the chosen grid and the order of interpolating functions used, although we do not exploit these.

In our case, we use a rectangular geometry uniformly spanned by tetrahedron elements, as shown in Fig.~\ref{fig:BTO_fem}(c-d).
The uniform mesh is largely motivated by implementation complexity, since we use a mostly in-house developed code based on the FEM building blocks supplied by the \href{https://github.com/KristofferC/JuAFEM.jl}{JuAFEM.jl} package.
It is obvious that the computational cost could be lowered by using a finer meshing close to the domain wall, where the fields vary the most, and a more course one in the domains.
One has to, however, consider that when the tip is applied a finer mesh is also required around it, leading to different meshes for different locations of applied tip, greatly increasing the post-processing complexity.

The last bulding block for the simulation is a way to optimize the fields in order to reach the equilibrium condition, both with and without applied tip.
To do this we use a Conjugate Gradient method to minimize the total energy in terms of all the degrees of freedom (DOFs), i.e. the values of the fields at each of the nodes on the mesh.
This requires us to define the partial derivatives of the total energy in terms of all the DOFs, for which we use a forward automatic differentiation scheme as implemented in \href{www.juliadiff.org/ForwardDiff.jl/latest/}{ForwardDiff.jl}, again for its remarkable simplicity and speed (as an idea, on a 24 core E5-2680 v3 server, the $\approx$ 3.5 million partial derivatives are computed in around 2.1 seconds).

Using the parameters from previous ab-initio results \cite{Marton2010}, we first optimized the equilibrium situation for both a uniform domain and a single domain wall.
A bell shaped force field, modeled by function $a e^{-x^2/d^2}$ with $d \approx 20$nm representing the diameter of the contact area and $a = 10^{-7} J/m^3$, was then applied at various positions throughout both geometries.
The uniform domain simulation is used as a measure of the finite-size effects that are inherently present in our simulations due to the long rangedness of strain and non-infinite geometry.
This causes the indentation at the center of the geometry for a single domain to be less than the one when the tip is applied off-center.
Since this is unphysical, we compensate for this by adding the differences to the results in the geometry with a wall present \lp{better explanation?}.

\section{Results}

We chose to use open boundary conditions\lp{maybe try with periodic too}.

When using finite element methods, it's important to verify to what extent the results are influenced by finite size effects and other numerical considerations.
Since the effect we are investigating depends crucially on the movement and position of the domain wall, the issue of the numerical Peierls-Nabarro barrier \cite{Marton2018} is quite important since the degree of pinning that the wall experiences depends on the elementsize.
We found that when the elementsize is 0.5 nm, the wall is too strongly pinned and never moves towards the tip, even if it's applied very close to it.
Using elements of 0.3 nm alleviates this issue and leads to a more realistic behavior.


Furthermore, due to the computational cost, it is desirable to use as small geometries as possible.

In order to get an idea of how robust this behavior is w.r.t. the numerical parameters we show the relative 

Multiple geometries and element sizes were tested in order to verify that the results were not too much influenced by these numerical parameters which. 
The softening is estimated as the ratio of the surface deformation between the domain and the wall.

As seen in Fig.~\ref{fig:BTO_theory}(a), and predicted by the above statements, the wall is softest not in the center, but rather at the point where $u'$ or $\varepsilon_{xz}$ is highest.

\printbibliography
