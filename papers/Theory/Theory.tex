\chapter{Theory}

\section{Density Functional Theory \label{sec:DFT}}
Many of the physics in condensed matter originates from the behavior of electrons inside materials, i.e. the electronic structure.
If we are after a quantitative description, two general ways of proceeding are possible. 
\\\\
The first is to formulate an analytical model whose parameters are subsequently fitted to experimental observations. 
In this case, the Tight-Binding method is a prime example that is often used in condensed matter for its flexibility and simplicity.

The starting point of any Tight-Binding model is the set of orbitals that are used as the basis.
In electronic problems, one often uses the valence orbitals of the constituent ions \cite{Bloch1929,Slater1954}.
The Hamiltonian can then be constructed as a set of hopping parameters between these orbitals, where the symmetries of the problem are used to limit the set of independent parameters.
These hopping parameters are termed this way because in a second quantization formulation they denote the energetics of the process of annihilating an electron on the first orbital and creating it on the second.
This ``hops'' the electron between the two.
The limited set of model parameters can then be fitted to experimental measurements such as angle resolved photoemission spectroscopy~\cite{Damascelli2004}.
\\\\
The topic of this section, however, is the second way of calculating the electronic structure, i.e. from first principles, using only the ions and crystalline structure as the input. 
While historically there have multiple methods of achieving this (e.g. Hartree-Fock), we here focus specifically on the density-functional-theory (DFT) method.
Ever since its theoretical inception in the sixties in the seminal works of P. Hohenberg, W. Kohn and L. J. Sham  \cite{Hohenberg1964,Kohn1965}, and especially after later numerical developments that have turned it into a highly efficient and predictive method \cite{Hamann1979,Louie1982,Vanderbilt1990,Joubert1999,Perdew1985,Perdew1986,Perdew1993}, it has been one of the prime tools in a condensed matter theorist's toolbox.

We will not delve into the fine details in light of conciseness, resorting instead to a very high-level overview following the excellent introduction by R. Martin in Ref.~\cite{Martin2004}.
On a rudimentary level, DFT is built on top of three main theoretical pillars.
\\\\
The first pillar is the observation that any property of a system of interacting particles can be written as a functional of the ground-state density $n_0(\bm{r})$.
This means that DFT is, in principle, an exact theory of many-body systems.
Writing the Hamiltonian as
\begin{equation}
	\hat{\mathcal{H}} = -\frac{\hbar}{2m_e} \sum_i \nabla_i^2 + \sum_i V_{\rm ext}(\bm{r}_i) + \frac{1}{2}\sum_{i\neq j} \frac{e^2}{|\bm{r}_i - \bm{r}_j|},
\end{equation}
where the indices $i,j$ iterate over the electrons\footnote{The ionic terms are easily included and are not the core difficulty and thus omitted here.}, the statement is that $V_{\rm ext}$ is uniquely defined by $n_0(\bm{r})$, and vice versa.
Thus, as soon as the ground-state density is found, the exact Hamiltonian of the system is known.
This in turn, theoretically speaking, allows one to find all other eigenstates of the system, fully characterizing the system.

The second pillar is formed by the ability to define a universal functional for the total energy of the system $E[n]$ in terms of the density $n(\bm{r})$, which is valid for any external potential $V_{\rm ext}$.
The density that globally minimizes this functional is then equal to the ground-state density $n_0(\bm{r})$.
\\\\
In order to turn these foundational first two pillars into a practically usable framework, one has to address the question of the form of the energy functional $E[n]$, leading us straight to the third pillar: the Kohn-Sham Ansatz \cite{Kohn1965}.
In essence, this ansatz makes the assumption that the original many-body problem can be replaced by an auxiliary independent-particle problem, both having exactly the same ground-state density $n_0(\bm{r})$.
This means that, theoretically speaking, calculations for the many-body problem can be exactly translated instead into calculations using independent-particle methods.
It is found that a set of independent particle equations can thus be formulated, lumping all the cumbersome many-body exchange and correlation effects together into the so-called ``exchange-correlation'' functional $E_{xc}[n]$.
If the exact form of $E_{xc}[n]$ were known, DFT would lead to the exact solutions of the original many-body problem.
The success of the DFT method from a numerical and quantitative point of view can be wholly attributed to the ability of finding local or semi-local approximations to this functional that manage to reproduce the original many-body problem quite well, using a mean-field description.
\\\\
Bringing everything together, we can write down the total energy functional of the auxiliary independent-particle system as:
\begin{equation}
	\label{eq:Theory_kohnsham}
	E_{KS} = T_s[n] + \int d\bm{r} V_{\rm ext}(\bm{r}) n(\bm{r}) + E_{\rm Hartree}[n] + E_{II} + E_{xc}[n],
\end{equation}
where $T_s$ denotes the independent-particle kinetic energy, $V_{\rm ext}$ the external potential due to the nuclei and any other external fields, $E_{II}$ the Coulomb interactions between the nuclei, and $E_{\rm Hartree}[n]$ the classical Coulomb contributions:
\begin{equation}
	E_{\rm Hartree} = \frac{1}{2}\int d\bm{r}d\bm{r}' \frac{n(\bm{r})n(\bm{r}')}{|\bm{r} - \bm{r}'|}.
\end{equation}
These formulae are at the core of the method, i.e. by minimizing the total energy in Eq.~\eqref{eq:Theory_kohnsham}, we can obtain the ground-state density which fully describes the system.
To do this, most practical implementations use a self-consistent algorithm which iteratively constructs the energy contributions from the previous trial density $n_i$, diagonalizes the resulting Hamiltonian, and uses the eigenstate with the lowest energy to construct a new trial density $n_o$, after which the algorithm is repeated until $n_o$ is sufficiently close to $n_i$. Equivalently, this means that $E[n_i] \approx E[n_o]$ through the Hohenberg-Kohn theorems, i.e. self-consistency between the density and resulting $V_{\rm ext}$ is reached.
It can be shown that this process leads to, at least, a local minimum of the Kohn-Sham functional~\eqref{eq:Theory_kohnsham}.
The question of how to reach the global minimum of any function, let alone any functional, is from an entirely different caliber that we wish to avoid in this Thesis.
In the vast majority of practical cases no matter what starting density is used, the final self-consistent density will be that of the ground-state. Indeed, many practical codes initialize the density as completely random. 
\\\\
There are many ways to numerically implement DFT, with the basis set used to construct the Hamiltonian being the main differentiating factor.
Since we are interested in extended systems such as crystals, a plane-wave basis set comes very natural.
We know that the eigenstates for the periodic potentials found in crystalline systems are Bloch Functions \cite{Ashcroft}:
\begin{equation}
	\Ket{\psi^{\bm{k}}_n} = \eikr{r} \Ket{u^{\bm{k}_n}},
\end{equation}
where $\eikr{r}$ denotes the envelope function, and $\Ket{u^{\bm{k}}_n}$ the cell-periodic part (see left hand side of Fig.~\ref{fig:Theory_blochvswan}(a)), and $n$ the band index.
Using a plane-wave basis $\Ket{\phi^{\bm G}}$ such that $\Sandwich{\bm{r}}{\phi^{\bm G}} = e^{i\bm G \cdot \bm r}$, we can write the Bloch Functions as:
\begin{equation}
	\label{eq:Theory_bloch_plane}
\Ket{\psi_n^{\bm{k}}} = \eikr{r} \sum_{\bm G} c_n^{\bm G} \Ket{\phi^{\bm G}}.
\end{equation}
By using these plane-wave basis functions, the energy contributions in Eq.~\eqref{eq:Theory_kohnsham} can be calculated.
In practice one rather constructs the Hamiltonian of the system, and diagonalizes it in order to find the coefficients $c_n^{\bm G}$ in Eq.~\eqref{eq:Theory_bloch_plane} corresponding to the lowest eigenstates of the system (up to the Fermi level).
A new trial density can then be constructed from these, which is used in the Hamiltonian of the next iteration, and so on until self-consistency is reached.
\\\\
One problem arises when using this plane-wave basis set, namely that close to the ionic cores $\Ket{u_n^{\bm k}}$ varies sharply in space, and plane-waves with high wavevector $\bm G$ are needed to resolve this sharp variation.
This leads to a large basis set, and thus operators (such as the Hamiltonian) with large dimensions, making the calculations extremely expensive.
\\\\
To overcome this issue, another approximation is often used: the so-called Pseudopotentials that replace the exact ionic potentials \cite{Hamann1979,Louie1982,Vanderbilt1990,Joubert1999}.
Pseudopotentials are defined in such a way that the wavefunctions match identically the exact ones (if real ionic potentials would be used) outside a chosen core region, but have less sharp variations inside the core region.
Smoother wavefunctions can be described by plane-waves with lower wavevector, ultimately reducing drastically the size of the basis set used in the DFT calculations.
Using the pseudopotential approximation generally results in good results for most properties that are of interest, since in many cases these properties do not depend on the exact shape of the wavefunctions close to the ionic cores.
\\\\
While DFT offers impressive efficiency and predictive power for many materials, rationalizing the results obtained with it is often less trivial.
This is mainly because of the large basis set that is used in the calculations, and the fact that a description in terms of extended plane-waves is often hard to grasp on an intuitive level.
At the start of this section we commented on the simplicity and flexibility that is offered by the use of Tight-Binding models.
There we saw that the parameters of these models can be fitted from experimental observations, which leads to an empirical method.

However, one may wonder if instead of using angle resolved photoemission experiments as an input for the model, the results of a DFT calculation could be employed.
The DFT calculation would then act as a ``numerical experiment'', and the Tight-Binding model as a way to rationalize the behavior.
The required bridge between the two methods is the topic of the next Section: Wannier Functions and the Wannierization. 

\section{Wannier Functions \label{sec:Wannier}}
% or indirectly to parametrize the magnetic exchanges between localized spins as in Chapter \ref{ch:GdMn2O5}, .
Tight-Binding models have appeared in various forms throughout history, originally proposed by Bloch \cite{Bloch1929}, and sometimes also referred to as the {\it linear combination of atomic orbitals} method \cite{Slater1954}.
This last description hints at how they are constructed.

First, a set of real space orbitals is defined inside the unit cell which is repeated throughout the rest of the system to construct the full basis.
The elements of the Hamiltonian are then calculated from the overlap integrals between these local orbitals:
\begin{equation}
	t^{\bm i \bm j}_{\alpha \beta} = \Bra{\alpha^{\bm i}} \hat{H} \Ket{\beta^{\bm j}} = \int_{V} d\bm r\, \alpha^*(\bm r - \bm R_i) H(\bm r) \beta(\bm r - \bm R_j),
\end{equation}
where $\Ket{\alpha^{\bm i}}$ is the orbital $\alpha$ located on ionic site $i$ with center $\bm R_i$, and $t^{\bm i \bm j}_{\alpha \beta}$ the {\it hopping parameters} between the two orbitals, because they describe the process of annihilating an electron from orbital $\Ket{\beta^{\bm j}}$ and creating it on $\Ket{\alpha^{\bm i}}$.
This Hamiltonian is periodic in the sense that if both $\Ket{\beta^{\bm j}}$ and $\Ket{\alpha^{\bm i}}$ are shifted by the same lattice translation, the hopping parameter will remain unchanged.
Fourier transforming and diagonalizing the Hamiltonian then leads to the Bloch Functions and electronic band structure of the crystal \cite{Ashcroft}.
\\\\
Another way of constructing such a model is by extracting the localized orbitals and hopping parameters from a first-principles based calculation such as DFT. In the Chapter that describes the Rashba spin-splitting in Germanium Telluride ~\ref{ch:Rashba} we opt for this method.
This circumvents the need to perform many experiments in order to investigate the details of the bandstructure, and how certain effects are manifested in different materials. 

The main question to answer then becomes how to define a such a set of localized orbitals starting from the extended BFs written in terms of the plane-wave basis set that is used in DFT.
There are many ways to do this, but the most natural one in this case is by using a set of Wannier functions (WFs) \cite{Wannier1937} as the target localized basis.

We will here give a short recap of the excellent reviews by Marzari et. al. \cite{Marzari2003,Marzari2012}, starting with the most clear case of a single isolated band $n$ with BFs $\BlochKet{n}$ (see red window in Fig.~\ref{fig:Theory_blochvswan}(b)).
The BF can be written in this case as a straightforward discrete Fourier transform of the WF: 
\begin{equation}
	\label{eq:Theory_1bandwan}
	\BlochKet{n} = \eikr{r} \unkKet{n}{k} = \sum_{\bm{R}} \eikr{R} \WanKet{n}{R},
\end{equation}
with $\unkKet{n}{k}$ the periodic part of the BF, $\WanKet{n}{R}$ the localized WF centered in the unit cell defined by lattice vector $\bm{R}$, and $n$ the band index.
The comparison between BFs and WFs is made in Fig.~\ref{fig:Theory_blochvswan}.
\begin{figure}
	\IncludeGraphics{blochvswan.png}
	\caption{\label{fig:Theory_blochvswan} a) A comparison between Bloch functions (left) and Wannier functions (right). The green graph in the left panel denotes the envelope function $\eikr{r}$, whereas the black one denotes the periodic part $\unkKet{n}{k}$. This image was taken from Ref.~\cite{Marzari2012}. b) Bandstructure of semiconductor GeTe, demonstrating three cases for Wannierization: red is a single disconnected band, green shows a disconnected composite manifold of connected bands, blue shows the situation when bands need to be disentangled.}
\end{figure}
When $k=0$ we can see that $\unkKet{n}{k}$ is simply the sum over the WFs centered at different unit cells.
In the case of $k \neq 0$, similar to how the envelope part modulates the periodic part of the BF, the contribution of each WF to the total sum needs to be modulated in a discrete way through $\eikr{R}$.

The inverse Fourier transform over the BF in the first Brillouin Zone (BZ) can then be performed in order to generate the localized WFs,
\begin{equation}
	\label{eq:Theory_wanfourier}
	\WanKet{n}{R} = \frac{V}{(2\pi)^3} \int_{BZ} d \bm{k} \inveikr{R} \BlochKet{n},
\end{equation}
where $V$ denotes the real-space volume of the unit cell.
In these and following equations, the normalization convention is used such that $\int_V d\bm{r}\BraKet{\Blochr{n}} = 1$.
As can be seen from the right panel in Fig.~\ref{fig:Theory_blochvswan}, WFs centered in different unit cells are shifted copies of one another.

One of the most useful properties of the WFs lies in the realization that, through the gauge freedom at each $\bm{k}$ of the BF\footnote{The solution to Schr\"odinger equation does not determine uniquely its phase.}, the shape of the WFs is not unique:
\begin{align}
	\BlochKet{n} &\Rightarrow \tildeBlochKet{n} = e^{i \phi_n^{\bm{k}}} \BlochKet{n},\\
	\WanKet{n}{R} &\Rightarrow \tildeWanKet{n}{R} = \frac{V}{(2\pi)^3} \int_{BZ} d \bm{k} e^{-i (\bm{k} \cdot \bm{R} + \phi_n^{\bm{k}})} \BlochKet{n}.
\end{align}
This means that by varying $\phi_n^{\bm{k}}$ we can adapt the WF basis in order for it to fulfill certain symmetries, or to localize the WFs as much as possible.
\\\\
In most practical problems we are interested in in groups of bands.
The simplest case is when these form a composite manifold that is detached from other bands, such as the green valence bands in Fig.~\ref{fig:Theory_blochvswan}(b).
It is useful to generalize the notion of the single band phase freedom $\phi_n^{\bm k}$ to a many-band gauge transformation:
\begin{equation}
	\label{eq:Theory_Umn}
	\tildeBlochKet{m} = \sum_m U_{nm}^{\bm{k}} \BlochKet{n},
\end{equation}
where $n,m$ enumerate the bands inside the composite manifold and the tilde is used to distinguish between $\tildeBlochKet{m}$ and the original BFs.
We do this because these transformed states are no longer eigenstates of the Hamiltonian if $U_{nm}^{\bm{k}}$ has off-diagonal elements.
Traces performed over such an isolated set of bands are invariant w.r.t. to these gauge transformations, leading to the invariance of observables such as the Hamiltonian which lies at the core of the ability to isolate and focus on this subproblem.
Choosing a decent gauge in this case is a necessity in order to extract well localized WFs.
This is because composite band manifolds will generally harbor crossings and degeneracies where the BFs become non-analytic making $\frac{\partial \unkr{n}{k}}{\partial \bm k}$ not smooth.
When the inverse Fourier transform is then performed on the BFs themselves, this non-smoothness will result in badly localized real-space WFs.
Indeed, only for smoothly varying $\unkr{n}{k}$ will cancellations appear when $\bm{R}$ is large, due to the fast varying exponent $\eikr{R}$ in Eq.~\eqref{eq:Theory_wanfourier}.
It is thus important to choose the $U_{mn}^{\bm k}$ in Eq.~\eqref{eq:Theory_Umn} so that the rotated wavefunctions $\tildeBlochKet{n}$ vary as smoothly as possible, which will ultimately lead to the WFs that are as localized as possible.
\\\\
In order to quantify this localization of the WFs, a spread functional can be written as:
\begin{equation}
	\label{eq:Theory_spread}
	\Omega =\sum_n \WanBra{n}{0}r^2\WanKet{n}{0} - \left|\WanBra{n}{0}\bm{r}\WanKet{n}{0}\right|^2,
\end{equation}
which can be trivially split into a gauge-invariant and gauge-dependent part
\begin{align}
	\Omega &= \Omega_I + \tilde\Omega,  \\
	\Omega_I &= \sum_n \left[\WanBra{n}{0} r^2 \WanKet{n}{0} - \sum_{m,\bm{R}} \left| \WanBra{m}{R} \bm{r} \WanKet{n}{0}\right|^2\right] \label{eq:Theory_omegaI}\\
	\tilde\Omega &= \sum_{n,m} \sum_{\bm{R} \neq n,\bm{0}} \left|\WanBra{m}{R} \bm{r} \WanKet{n}{0}\right|^2.
\end{align}
For a set of isolated bands it thus suffices to minimize the gauge-dependent part in order to find the  unique set of maximally localized Wannier functions (MLFW)\footnote{It can be proved that these WFs will be exponentially localized in the case of normal insulators.} that consitute these bands \cite{Kunes2004, Marzari2012}.

We can then transform the position dependent operators into reciprocal space as \cite{Blount1962}:
\begin{equation}
\WanBra{n}{R}\bm{r}\WanKet{m}{0} = i \frac{V}{(2\pi)^3}\int d\bm{k} \eikr{R}\unkBra{n}{k} \bm{\nabla}_{\bm{k}} \unkKet{m}{k},
\end{equation}
and
\begin{equation}
\WanBra{n}{R}r^2\WanKet{m}{0} = -\frac{V}{(2\pi)^3}\int d\bm{k} \eikr{R}\unkBra{n}{k} \bm{\nabla}_{\bm{k}}^2 \unkKet{m}{k},
\end{equation}
which can be used to write and minimize $\tilde\Omega$ in terms of $\unkKet{n}{k}$ and $U_{nm}^{\bm{k}}$ directly.
The optimal set of $U_{nm}^{\bm{k}}$ can then be used to generate the set of MLFW.
If maximal localization is not the only goal, WFs with other desirable characteristics can be generated by tweaking the $U_{nm}^{\bm{k}}$.
This is often done to ensure that the WFs adhere to the symmetries of atomic orbitals, which can be useful to develop a further intuitive understanding using well-known orbitals.
More details on the different construction methods and can be found in Ref.~\cite{Marzari2012}.
\\\\
Up to now we discussed the case of an isolated set of bands. In some cases such a set does not exist in the energy range of interest, and the bands are connected, or {\it entangled}, with the bands outside this range.
An example of this case is shown by the blue bands in Fig.~\ref{fig:Theory_blochvswan}(b).
If we are seeking $J$ WFs we then need to select $J$ states $\tildeBlochKet{n}$ at each $k$ point from a bigger set $J^{\bm{k}}$:
\begin{equation}
	\tildeBlochKet{n} = \sum_{m=1}^{J^{\bm{k}}}V_{nm}^{\bm{k}} \BlochKet{m}.
\end{equation}
These $\tildeBlochKet{n}$ can then be used in the previously described localization procedure.
The matrices $V_{nm}^{\bm{k}}$ are in general rectangular with dimension $J\times J^{\bm{k}}$.
This leads to a two-step procedure where first a subspace is selected for each $k$ point, followed by the final gauge selection to arrive at the localized basis of WFs:
\begin{equation}
	\label{eq:Theory_fullwan}
	\WanKet{n}{R} = \frac{V}{(2\pi)^3} \int_{BZ} d\bm{k} e^{-i \bm{k} \cdot \bm{R}} \sum_{m=1}^J U^{\bm{k}}_{nm} \sum_{l=1}^{J^{\bm{k}}} V_{ml}^{\bm{k}} \BlochKet{l}.
\end{equation}
There are again many ways to do this subspace selection (or {\it disentanglement}).
The most prevalent two are by projection onto atomic-like orbitals, or by again minimizing the total spread of the WFs.
We utilize the latter in this work.
In this case, the maximal localization aims to find at each $k$ point the $V_{nm}^{\bm{k}}$ that leads to the maximal overlap of the selected subspace with its neighboring $k$ points.
As discussed before, this smoothness in reciprocal space translates into the subspace as a whole being more localized in real space.
Indeed, it can be shown \cite{Marzari2012} that this intrinsic smoothness is exactly what $\Omega_I$ measures in Eq.~\eqref{eq:Theory_omegaI}. 
In many cases, it is desirable to adapt the algorithm so that the BFs of the bands inside a ``frozen'' energy window are exactly interpolated by the resulting WFs and associated Tight-Binding Hamiltonian.
\\\\
These considerations set the theoretical stage for the Wannierization procedure. In the following we give some comments on the numerical aspects of this method.

The continuous integration over the BZ in previous equations is performed on a discrete $k$ grid in numerical calculations.
In order to adhere closely to the continuous case, the discrete Fourier transform pair can be defined as:
\begin{align}
	\tildeBlochKet{n} &= \sum_{\bm{R}} \eikr{R} \WanKet{n}{R},\label{eq:Theory_wantok}\\
	\WanKet{n}{R} &= \frac{1}{N}\sum_{\bm{k}} \inveikr{R} \tildeBlochKet{n},
\end{align}
where $N$ denotes the number of unit cells in the periodic supercell in real space, equal to the number of $k$ points in the discrete mesh over the BZ.
This discretization enforces periodic boundary conditions on the BFs over this supercell, meaning that the WFs in this definition also have this supercell periodicity.
The localization criterion then means that inside the supercell the WFs are localized.
If the mesh spacing tends to zero, the supercell tends to infinity, restoring the earlier definitions using continuous Fourier Transforms, and the original notion of WFs.
\\\\
After finding the $U^{\bm{k}}_{nm}$ and $V^{\bm{k}}_{nm}$ matrices of Eq.~\eqref{eq:Theory_fullwan}, any operator $\hat{f}^{\bm{k}}$ defined in terms of the BFs can be transformed into $\hat{F}^{\bm{R}}$ in the Wannier representation.
It is important to realize that, depending on the coarseness of the $k$ grid used in the first-principles calculation, $\hat{F}^{\bm{R}}$ can only be calculated for limited values of $|\bm{R}|$, spanning the supercell defined by the discretization of the BZ.
Since the WFs are well localized, $\hat{F}^{\bm{R}}$ tends to decay rapidly with $|\bm{R}|$.
The values of $\hat{f}^{\bm{k}}$ can then be interpolated from $\hat{F}^{\bm{R}}$ by performing the inverse procedure.
This allows the efficient calculation of $\hat{f}^{\bm{k}}$ on a finer $k$ mesh than the one used in the DFT calculations, provided that the WFs are well localized inside the supercell.
This efficient interpolation is one of the great advantages of using localized WFs, since the size of the WF basis, and thus dimensions of the matrices, is much lower than the one used in DFT (e.g. many plane waves).

The final process to extract a Tight-Binding Hamiltonian in a WF basis, starting from an ab-initio DFT simulation, can thus be summarized as follows:
\begin{enumerate}
	\item Perform a self-consistent DFT calculation in order to find the ground state density and BFs on a discrete $k$ mesh.
	\item Define the $J$ trial orbitals (e.g. atomic-like) that are most suitable for the bands or problem under investigation. This can be done e.g. by perfoming a density of states calculation, projecting on the atomic orbitals.
	\item Select an inner ``frozen'' window containing the most important bands, and, if entangled, an outer window from which to disentangle a $J$-dimensional subspace for each $k$ point.
	\item Use a projection on the trial orbitals as the initial guess, followed by a minimization of $\Omega_I$ (Eq.~\eqref{eq:Theory_spread}) to find the $V_{ml}^{\bm{k}}$ matrices.
	\item Find the final gauges $U_{nm}^{\bm{k}}$ in order to minimize the spread of each of the $J$ WFs.
\end{enumerate}

The main quantity we will use this interpolation for is the Hamiltonian:
\begin{equation}
	\label{eq:Theory_waninterp}
	\tilde{H}_{nm}^{\bm{k}} = \tildeBlochBra{n} H \tildeBlochKet{m} = \sum_{\bm{R}} \eikr{R} \WanBra{n}{0}H\WanKet{n}{R}.
\end{equation}

This Hamiltonian can then be diagonalized by unitary transformations $W^{\bm{k}}$ in order to recover the interpolated bandstructure of the $J$ bands in the chosen window:
\begin{equation}
H_{nm}^{\bm{k}} = [W^{\bm{k}\dagger} \tilde{H}_{nm}^{\bm{k}} W^{\bm{k}}]_{nm} = \delta_{nm} \varepsilon_{n}^{\bm{k}}.
\end{equation}

This concludes our very condensed introduction and overview of the construction and use Wannier functions as a tool to aid in the theoretical understanding of the behavior of electrons in extended systems.
Further details on the Wannierization process can be found in Ref.~\cite{Marzari2012}, and specific details on the implementation in the Wannier90 package used throughout this work can be found in Ref.~\cite{Mostofi2014AnFunctions}.

\section{Landau Theory}

