\newcommand{\Jpar}{J_{||}}
\newcommand{\Jperp}{J_{\perp}}
\chapter{Magnetoelectric crankshaft: topologically protected switching in multiferroic GdMn$_2$O$_5$ \label{ch:GdMn2O5}}
\section{Introduction}
Efficient control and probing of robust order has historically been one of the main technological drivers for research in condensed matter.
The hallmark example is the impact that the discovery of giant magnetoresistance has had on the efficiency of the readhead in hard disks, by using direct electrical effects rather than a solenoid \cite{Baibich1988,Binasch1989,Tsymbal2001,Nunez2006TheoryMetals,Chappert2007}.
This is achieved by constructing the readhead as a multilayer sandwich composed of a pinned magnet, a non-magnetic metal and a soft magnet.
The latter will align itself to the information storing magnetic domains on the platter of the hard disk.
The resistivity of the stack then depends strongly on the mutual alignment of the pinned and soft magnets, as a result of the giant magnetoresistance.
By applying a constant bias voltage to the readhead, the magnetically stored information can be probed electrically through the measurement of the resulting current.
Underlying this mechanism is the Stoner effect, causing the conducting states around the Fermi level of metallic magnets to have a well-defined spin polarization depending on the internal magnetization.
If current flows through these metallic magnets, the carriers with aligned spins that exit the pinned magnet will be scattered strongly (leading to low conductivity) by the soft magnet if its magnetization is aligned antiparallel, and weakly when the magnetization of both is aligned (high conductivity).
This development led to a significant increase of the efficiency of hard drives.

There remains, however, the issue of writing the information in the first place.
In modern state-of-the art high density storage technologies, this is still done by applying an external magnetic field with an electromagnet to reorient the ferromagnetic domains. One can imagine this to be quite an inefficient process, both from the point of view of granularity (stray fields and non-locality of magnetic fields limit the minimum size of the domains) as from that of energy loss through heat dissipation.
Improving these figures of merit drives much of the current research in the field of spintronics, with promising applications like spin-transfer torque devices \cite{Nunez2006TheorySemiconductors,Nunez2006TheoryMetals,Nunez2011, Kent2015, Jungwirth2016}.
These use an inverse effect to the one described above.
In thase first a current is created with carriers that have a well-defined orientation of the spin by using e.g. a pinned ferromagnet as in the readhead.
Subsequently, this current is forced through (or close to) a magnetic domain by the bias electric field.
If the spin of the carriers and the magnetization of the domain are misaligned, strong scattering occurs which rotates the spin moments of the carriers.
However, this will cause an opposite torque on the magnetization of the domain, due to the conservation of angular momentum. This transfer of torque is where the classification of {\it spin-transfer torque} devices originates from.
If enough spin-polarized current flows through the domain, its magnetization will eventually be reoriented along the spins of the carriers. This method circumvents the need of electromagnets to create a magnetic field by using circular currents, greatly increasing the efficiency and allowing for greater domain density.
\\\\
It is clear that the longevity associated with magnetic order, combined with the ease and efficiency of manipulation through electrical means is highly desirable.
This brings us to the topic of this chapter, namely the magnetoelectric effect in multiferroic insulators.
As the name implies, the magnetoelectric effect allows for the electric control of magnetic order or the magnetic control of ferroelectric polarization~\cite{Spaldin2019,Khomskii2009,Fiebig2005,Fiebig2016,Cheong2007}, the former being the most attractive from a technological point of view.

In practice, however, the effectiveness of this cross-order control is often limited, and multiferroic materials are rare to begin with.
To understand why, we summarize briefly the review by Khomskii in Ref.~\cite{Khomskii2009}.
\\\\
Two main classes of multiferroic materials can be identified: type-I and type-II multiferroics.
In the former, the ferroelectric polarization and magnetic order stem from different origins, and are thus largely decoupled.
The latter, instead, develops ferroelectricity as a result of an inversion symmetry breaking magnetic configuration.
In this case the two orders are coupled strongly, but the size of the ferroelectric polarization is often limited, and generally much lower than for type-I multiferroics.
We use the ABO$_3$ perovskites with a magnetic transition metal B ion as an example, in order to understand why multiferroics are so rare.
\\\\
Magnetic order is almost exclusively caused by partially filled valence shells, in our example these are half-filled $d$ shells.
Ferroelectricity, on the other hand can find its origin in many microscopic effects.
In many of them, the ferroelectricity is caused by an off-center shift of the B ion in the surrounding oxygen octahedron (see Chapter~\ref{ch:Softening} for a detailed discussion on ferroelectricity in BaTiO$_3$).
This is due to the formation of strong covalent bonds between one (or three) oxygens and the B ion, using the latter's empty $d$ states. 
While it is not fully understood why, the presence of any electrons in the $d$ shell of the B ion severly hampers this process which is one of the root causes for the rarity of multiferroicity in these materials, since magnetism requires at least a partial filling of the $d$ shell.
One of the ways both orders can appear simultaneously is due to A ions that have lone pairs (filled outer $s$ shell). One example is in BiFeO$_3$, where the Bi$^{3+}$ ion harbors such a lone pair.
This pair of $s$ electrons is highly polarizable and all align in the ferroelectric phase.
BiFeO$_3$ is thus a clear example of a multiferroic material, however, the two orders have completely different origin and the cross-order coupling is thus extremely low.
The ordering temperatures for the ferroelectric and magnetic order in BiFeO$_3$ are 1100 K and 643 K, respectively, with a polarization $P \sim$ 90$\mu$C/cm$^2$.
For further details on the formation of the ferroelectricity in the other type-I cases, either through charge ordering or tilting of the oxygen octahedra, we refer the reader back to Ref.~\cite{Khomskii2009}.
\\\\
On the phenomenological side, one can write down a Landau free energy for a homogeneous type-I multiferroic by expanding the free energy $F$ in terms of ferroelectric polarization $P$ and magnetization $M$ (both scalars):
\begin{align}
	F(P, H) =& F_0 + \frac{a}{2} (T-T_P) P^2 + \frac{b}{4} P^4 - P E \\
	&+\frac{\alpha}{2} (T-T_M)M^2 + \frac{\beta}{4} M^4 - MH - \frac{g}{2}P^2 M^2.
\end{align}
This is the simplest form of the free energy of a multiferroic in terms of order parameters $P$ and $M$.
All coefficients are taken to be positive, such that below the ferroelectric (ferromagnetic) transition temperature $T_P$ ($T_M$) nonzero $P$ ($M$) develops.
The lowest order symmetry-allowed term that couples $P$ and $M$ is $-gP^2M^2$, obeying both the time reversal and inversion symmetries of the parent structure above the transition temperatures $T_P$ and $T_M$.
Minimizing the energy with respect to both orders for $T<T_M,T_P$ and no applied external fields, leads to
\begin{align}
	P^2 &= - a(T-T_P)/b + gM^2\\
	M^2 &= - \alpha(T-T_M)/\beta + gP^2.
\end{align}
Both order parameters thus depend on the value of the other through the magnetoelectric coupling $g$. This leads to a change in one when an external field is applied to the other.
As mentioned before, however, the different microscopic origins of both orders usually result in a tiny value for $g$.
Indeed, the effective dielectric constant $\varepsilon$ of BiMnO$_3$ only displays a weak anomaly at the ferromagnetic transition temperature, and is only weakly affected by an external magnetic field, leading to a variation of 0.6\% of $\varepsilon$ at a field value of 9\,T.
This means that the electrical behavior of this material is almost impervious to an extern magnetic field, a clear demonstration of the problems with cross-order control in type-I multiferroics.
\\\\
In an effort to improve this sought-after control, we turn to the type-II multiferroics.
As mentioned before, the ferroelectricity in these materials is a result of the inversion breaking magnetic order that sets in below $T_N$.
Due to the shared microscopic origin, the coupling between the magnetic and ferroelectric orders in these materials is generally much higher, leading to an increased magnetoelectric effect~\cite{Oh2014}.
However, one caveat is that in this case the ferroelectricity is much lower, since it improper rather than proper\footnote{The order parameter describing the ferroelectric polarization is a pure slave order parameter, that would not develop on its own in these materials. It is only nonzero because of the appearance of the primary order parameter that describes the magnetic order below $T_N$ (i.e. there is no $T_{FE}$).}.
This leads to a much reduced effectiveness of external electric fields as a method of effective control of the magnetic order.  
\\\\
Here, we specifically focus on GdMn$_2$O$_5$ (see Fig.~\ref{fig:GdMn2O5_unit_cell})~\cite{Khomskii2009}, demonstrating an exceptional tunability of the ferroelectric polarization through an applied magnetic field~\cite{Lee13}.
The orthorhombic $R$Mn$_2$O$_5$ manganites have a very complex crystalline structure (see Fig.~\ref{fig:GdMn2O5_unit_cell}), which leads to a wealth of different phases depending on the temperature, rare-earth ion $R$, external magnetic field and even electric-field poling history~\cite{Zheng2019}.
To keep the discussion tractable and in line with the experiments that were performed by our collaborators, we give a summary of the transitions and phases that are important for this chapter.
\\\\
$R$Mn$_2$O$_5$ have crystallographic group P$bam$ \cite{Alonso97} in the paramagnetic phase at high temperature, which is eventually lowered to P$_ab2_1a$ when the commensurate magnetic order condenses below $T_{N} \approx 33$ K.
This order is characterised by the propagation vector $\bm{k} = (1/2, 0, 0)$, i.e. there is a unit cell doubling along the crystalline $a$-direction.
The magnetic configuration repeats along the crystalline $c$-direction. The magnetic phase transition goes hand in hand with a sharp anomaly in the dielectric constant $\varepsilon_b$, signalling the onset of the improper ferroelectric polarization  along the $b$-direction ($P_b$) \cite{Lee13}.
When the temperature is lowered further, $P_b$ saturates to a maximum value of around 3600 $\mu$C/m$^2$, the largest found for any rare-earth magnanite.
However, it is still tiny compared to proper ferroelectrics like BaTiO$_3$ with $P \approx 3 \times 10^5 \mu $C/m$^2$ at room temperature \cite{Mason1948,VonHippel1950}.
The magnetic unit cell features two non-equivalent antiferromagnetic (AFM) Mn chains, which are formed by pyramidally coordinated Mn$^{3+}$ and octahedrally coordinated Mn$^{4+}$ ions, as indicated by the light blue lines and purple polygons in Fig.~\ref{fig:GdMn2O5_unit_cell}.
The Mn spins inside the chains lie mostly along the fourfold symmetry axis of the Mn$^{3+}$ pyramids, making angles of $\pm 23.4^\circ$ with the $a$-axis.
\\\\
\begin{figure}
	\centering
	\IncludeGraphics{unit_cell.png}
	\caption{\label{fig:GdMn2O5_unit_cell}{\bf Unit cell and magnetic configuration of GdMn$_2$O$_5$.} The spheres signify Mn (purple), Gd (green) and Oxygen (red) ions. a) The magnetic unit cell with the zig-zag chains along the $a$-direction (cyan lines) denoting which Mn ions are linked with strong AFM exchange, leading to the $\bm{L}_1$ and $\bm{L}_2$ N\'eel vectors. The boundary of the structural unit cell is marked by the black. The yellow arrows denote the exchange paths between Gd and neighboring Mn ions in both chains, corresponding to $v_1$ and $v_2$. The two sources of the symmetric Heisenberg exchange striction are shown in (b) and (c). The black arrows signify the zero field orientation of the spins. The yellow arrows denote the expanding bonds due to alignment of spins and AFM exchange, and the blue arrows denote contracting bonds.}
\end{figure}
The improper ferroelectricity is generated through the symmetric Heisenberg exchange striction, and the strong AFM exchanges combined with the geometric frustration of the Mn chains~\cite{Choi2008}.
This frustration appears due to the odd number of AFM bonds in the Mn pentagons that surround each Gd ion, as can be seen in Fig.~\ref{fig:GdMn2O5_unit_cell}(a) and more clearly in panel (c).
Similar to the situation in AFM bonds on a triangular lattice, not all AFM exchanges can be simultaneously satisfied (i.e. by having completely antiparallel spins on each AFM bond).
When the magnetic order sets in, magnetic exchange energy is simultaneously optimized with the elastic energy on each bond.
This results in the contraction of bonds with a mostly antiparallel alignment of spins, and the extension of bonds with more parallel aligned spins.
A detailed demonstration is shown in Fig.~\ref{fig:GdMn2O5_unit_cell}(b-c) by the orange and blue arrows, respectively.
\\\\
The simplest form of this behavior can be understood by considering Heisenberg exchange between two spins $i$, $j$, on a dimer.
The exchange coefficient can be written in terms of the hopping $t_{ij}$ and Coulomb repulsion $U$ as: $J(r_i, r_j)\approx \frac{t_{ij}^2}{U}$.
It depends through $t_{ij}$ only the length of the bond, such that $J(r_i, r_j) = J(r_i - r_j) = J(r)$\footnote{In real materials this process is more complex due to the presence of multiple orbitals, and multiple neighboring ions.}.
The energy $W$ of each bond can then be written, following Ref. \cite{Harris1972}, as:
\begin{equation}
	W_{ij} = J(r)\bm{S}_i \cdot \bm{S}_j + \frac{\kappa \delta r^2}{2r_0},
\end{equation}
with spins $\bm{S}_i$ and $\bm{S}_j$, $\kappa$ the elastic stiffness of the bond, $r_0$ the mean separation between neighboring Mn$^{3+}$ and Mn$^{4+}$ ions in the paramagnetic state, and $\delta r = r - r_0$.
Minimizing the energy of the bond energy through $\frac{\partial W}{\partial r} = 0$ then leads to the change in bondlength $\delta r$ given by 
\begin{equation}
	\delta r = -\frac{\partial J}{\partial r}\frac{r_0}{\kappa}\bm{S}_i \cdot \bm{S}_j,
\end{equation}
when the magnetic order sets in below $T_N$. Thus, AFM bonds ($J > 0$) with antiparallel spins contract ($\delta r < 0$), and bonds with parallel spins extend ($\delta r > 0$).
In the case of $R$Mn$_2$O$_5$, this causes the ocatahedrally coordinated Mn$^{4+}$ ion to shift towards one of the two neighboring Mn$^{3+}$ pyramids in the Mn$^{3+}$ -- Mn$^{4+}$ -- Mn$^{3+}$ sequences, as showcased in Fig.~\ref{fig:GdMn2O5_unit_cell}(b).
As mentioned before, this causes a lowering of the symmetry from P$bam$ to P$_ab2_1a$, and, as the Born effective charge of the Mn$^{3+}$ and Mn$^{4+}$ ions differs, to a nonzero polarization along the $b$-axis~\cite{Khomskii2009}.
It was shown, however, that this ionic displacement is largely compensated when electronic correlation effects are taken into account.
These lead to an additional increase of the electronic charge between the contracting ions, which almost fully cancels this contribution to the polarization.
\\\\
There is a second source of polarization in GdMn$_2$O$_5$, also due to the symmetric Heisenberg exchange striction but this time between the spins of Gd and Mn~\cite{Lee13}.
All the exchanges between Gd and the surrounding Mn ions are again AFM.
A similar train of thought can then be followed as before, causing the bonds with parallel spins to extend and those with antiparallel spins to contract (see Fig.~\ref{fig:GdMn2O5_unit_cell}(c)).
This contribution does not suffer from the same cancellation between ionic displacements and electronic charge, and leads to the majority of the ferroelectric polarization.

Gd$^{3+}$ is special with respect to the other magnetic rare-earth ions in the $R$Mn$_2$O$_5$ family, because it has a very isotropic electronic configuration (4$f^7$), i.e. there is no unquenched orbital angular momentum and associated anisotropic charge distribution (as discussed profusely in the Rashba Chapter~\ref{ch:Rashba}). This means that the large spin (nominally $S=7/2$) can orient itself freely to optimize the magnetic interactions with its neighboring Mn atoms, without incurring any penalties through the atomic SOC combined with nonzero OAM.
This leads to a high magnetic susceptibility and associated magnetoelectric effect, surpassing the other $R$Mn$_2$O$_5$ compounds both in size and tunability of $P_b$, with a measured variation of up to 5000\,$\mu$ C/m$^2$ when a magnetic field is applied~\cite{Lee13}. 
\\\\
Now that the stage is set, we continue with a description of the puzzling experimental observations that motivated the study in this chapter.
Afterwards, we continue with a description in terms of an effective spin Hamiltonian in terms of the Gd spins, and the AFM orderparameters $\bm L$ describing the two Mn chains.
We demonstrate that this description works remarkably well in order to reproduce the overall behavior that is observed in the experiments.
After discussing the complex behavior that arises from the model, we comment on the generality of the observations, followed by a final summary of the effect. 
%Even though the AFM intrachain superexchange interactions dominate over the AFM interchain interactions, there is nonetheless a geometric frustration due to the crystal structure, which can be seen most easily seen from the Mn pentagons surrouding the Gd atoms. This means that all AFM exchanges can not be satisfied at the same time, causing certain Mn bonds between the chains to have energetically unfavorable spin alignment. This leads to the first contribution to the ferroelectric polarization through Heisenberg exchange striction, lengthening bonds that have parallel spins and shortening those that have antiparallel ones.

\section{Experimental results}
\begin{figure}
    \centering
    \IncludeGraphics[width=0.65\textwidth]{fig_exp2.png}
\caption{ \label{fig:GdMn2O5_experiment1} {\bf Experimental measurements of the electric polarization at 2.3 K.} a) Magnetic field applied at -1$^\circ$ which leads to a two-state hysteresis loop. b) Magnetic field applied at -9$^\circ$, where the four-state hysteresis loop appears. c) Field applied at -15$^\circ$, again leading to a two-state hysteresis loop.  
In these plots, we have denoted the four discussed states by the labels 1-4. The arrows and graph color denote the direction of magnetic field-change during the sweep, as indicated by the inset of panel (a).}
\end{figure}
\begin{figure}
    \centering
    \IncludeGraphics{exp_plusvsminus.png}
\caption{ \label{fig:GdMn2O5_experiment2} {\bf Angle and temperature dependence of the four-state switching.} By comparing panels (a) and (b) we can see that the sign of the field angle $\phi_H$ does not matter for the four-state switching. c) Temperature dependence of the switching hysteresis at the magic angle. Above 4 K (upper panel) the more usual two-state hysteresis is observed, whereas below 4 K (lower panel) the four-state behavior starts to arise. The states, colors and arrows are indicated in the same way as in Fig.~\ref{Fig:GdMn2O5_experiment1}.}
\end{figure}


The measurements we present in this section were performed in the group of A. Pimenov, on single crystal GdMn$_2$O$_5$ samples grown by S. Cheong's group.
Magnetic fields were applied to the sample under varying angles $\phi_H$ with respect to the crystalline $a$-axis, and swept up and down while tracking the evolution of $P_b$.
Only positive fields were applied, but as it turns out, the behavior is identical for fields that are offset by 180$^\circ$. 
In previous experimental measurements, the magnetic field was only applied along the crystalline $a$-axis, i.e. $\phi_H = 0$~\cite{Lee13}.
The results for the low temperature measurements are displayed in Fig.~\ref{fig:GdMn2O5_experiment1}.
\\\\
In the following we will refer to three distinct switching regimes: the low angle, ``magic'' angle, and high angle regime.
They correspond to the values of $\phi_H$ shown in panels (a), (b), and (c) respectively.
Before delving into a detailed analysis of the experiments, we would like to point out that the low angle behavior shown in panel (a) does not coincide with the behavior found in previous experiments on the same sample (see Fig.~1 of Ref.~\cite{Lee13}).
There it was found that when the field is applied along the $a$-axis, a two-state switching with a reversal of the polarization is observed, similar to the 1--4 branch in panel (b) of Fig.~\ref{fig:GdMn2O5_experiment1}.
We are not quite sure what leads to this discrepancy between the measurements. It could be related to the poling history of the sample or some domain related behavior.
For now, this discrepancy is not that important, but it is nonetheless at odds with our theoretical findings which demonstrate a behavior similar to the previous measurements in Ref.~\cite{Lee13}. 
\\\\
Turning back to the results shown in Fig.~\ref{fig:GdMn2O5_experiment1}, we see that the switching behavior changes significantly with $\phi_H$.
In the high angle case, displayed in panel (c), we can observe a two state switching behavior, in which $P_b$ does not vary much, but a clear jump appears around a field magnitude of 5 T.
This signals a sudden change in the magnetic configuration of the system, since $P_b$ is a direct result of it.
The most peculiar, and completely novel, behavior can be found around the magic angle $\phi_H \sim 9^\circ$ in panel (b) of Fig.~\ref{fig:GdMn2O5_experiment1}.
During the up-down-up-down field sweeps in this switching regime, we find that four different states are visited sequentially, with four different values for $P_b$.
\\\\
At this stage, we would like to draw the attention of the reader to two facts.

First, compared to the usual magnetoelectric switching with one low-field state and one high-field state, here a single up--down cycle of the field reverses the polarization, and correspondingly leads to a different final state.
In order to return the system to its original configuration another up--down cycle is required.

Second, this four-state loop is fully deterministic, meaning that when multiple such double cycles are applied, the system tracks close to exactly the same $P_b$ loop every time.
\\\\
If we ignore for a brief moment the low-angle behavior displayed in our Fig.~\ref{fig:GdMn2O5_experiment1}(a), and replace it with the earlier observed polarization reversal of Fig.~1 in Ref.~\cite{Lee13}, i.e. following the 1--4 branch in panel (b), we can imagine the four-state switching as an interpolation between the high and low angle switching regimes.
This is a very important observation and will lead to one of the main results of this work: the topological nature of the magnetoelectric switching in this material.
\\\\
Turning now to the measurements displayed in Fig.~\ref{fig:GdMn2O5_experiment2}, we find that the four-state loop does not depend on the sign of $\phi_H$ (compare panels (a,b)).
From the two panels in (c), displaying measurements with $\phi_H$ along the magic angle, but at two different temperatures (15 K and 4 K), we can observe that the four-state hysteresis loop only appear at low temperatures.
For higher temperatures a more usual two-state loop is found, similar to the high angle loop in panel (c) of Fig.~\ref{fig:GdMn2O5_experiment1}.
\\\\
To conclude this section we would like to comment that we focus on the overall switching behavior, i.e. we ignore the many interesting details that can be found by careful study of the $P_b$ graphs.
For example, in Fig.~\ref{fig:experiment1}(b) one can find three distinct steps that appear around 5 T during the 1 $\rightarrow$ 2 and 3 $\rightarrow$4 switching.
These steps are, however, absent at the same field magnitude, when the system is on the 2$\rightarrow$3 and 4$\rightarrow$1 branch.
Their origin might be related to a transition, on an ionic level, to states with higher Gd spin, or it might be related to the spins in the Mn chains rotating individually, rather than in unison as we will assume in our model.
These features could be the subject of further research, here we choose to focus on unravelling the main behavior of the four-state loop flanked in $\phi_H$ parameter-space by two more usual two-state switching loops.
% This novel four-state switching is the focus of this chapter, and is found to originate from a unidirectional rotational motion of the spins, a sort of microscopic magnetic analogue to the crankshaft in a car, converting the linear back--and--forth variation of the magnetic field into spin rotations.

\section{Modeling}
In order to describe the puzzling experimantal observations we construct a semi classical model with eight Gd spins and two AFM order parameters that describe the Mn chains.
The Gd spins are described by unit vectors $\bm{S}_i, i=1..8$, and we denote the two AFM order parameters as $\bm{L}_\alpha, \alpha=1,2$ (also unit vectors). See Fig~\ref{fig:GdMn2O5_unit_cell} for further details.
Furthermore, the electric polarization is represented by the slave order parameter $P_b$.
Using a single $\bm{L}_\alpha$ to describe the orientation of all the Mn ions in a chain assumes that their spins are perfectly AFM ordered, i.e. $\bm{S}_i = L, \bm{S}_{i+1} = - \bm{L}$.
This simplification is justified by the large intrachain AFM exchanges, compared with the relatively small exchanges between the two chains.

A further simplification we adopt here is to confine all spins to the $ab$-plane.
It was shown experimentally that indeed the $c$-direction acts as the magnetic hard-axis, and that the magnetic order is repeated along the crystalline $c$-direction~\cite{Lee13}.
This lowers the dimensionality of the problem from 3D to 2D, with a single angle for every Gd spin and Mn chain as the remaining degrees of freedom, thus greatly simplifying the numerical complexity.
Since all spins and AFM order parameters are taken as unit vectors, their sizes are implicitely included in the model parameters.
\\\\
The first step in order to derive the effective Hamiltonian in terms of the above order parameters is to convert the microscopic interactions of the individual Mn spins into the effective interactions of the $\bm{L}_\alpha$.
More specifically, we include energy contributions due to small spin cantings away from the perfect collinear intrachain spin configuration, as showcased in Fig.~\ref{fig:GdMn2O5_canting}.

\begin{figure*}[h]
    \centering
    \IncludeGraphics[width=\linewidth]{canting}
	\caption{{\bf Energy contributions due to spin canting.} a) The Zeeman contribution due to the weak ferromagnetic moment along the field (H, red arrow), as a result of the spin canting. b) The contribution due to Heisenberg exchange when previously parallel Mn spins are canted towards a more AFM alignment. This is a direct result of the geometric frustration. The collinear configuration is denoted by the black arrows, with the dashed teal arrows showing the orientation due to the slight canting by the angle $\delta \theta$. \label{fig:GdMn2O5_canting}}
\end{figure*}

Starting with the contribution due to the Zeeman energy when a magnetic field is applied, we can write 
\begin{equation}
	E_Z = -g \mu_B \bm{H} \cdot (\pmb{\sigma}_i + \pmb{\sigma}_{i+1})\nonumber,
\end{equation}
where $g \approx 2$, $\mu_B$ denotes the Bohr magneton, and $\sigma_i$ and $\sigma_{i+1}$ two neighboring Mn spins inside a chain. 
Obviously, no energy gain is possible for perfectly antiparallel spins since then $(\pmb{\sigma}_i + \pmb{\sigma}_{i+1})=0$.

However, if both spins cant slightly towards the applied field, a weak ferromagnetic moment is created that will couple to the magnetic field (see Fig.~\ref{fig:GdMn2O5_canting}(a)).
To include this contribution, we perform an expansion in the small canting angle $\delta \theta$ away from the collinear configuration:
\begin{align}
	E &= \Jpar \cos(2\delta \theta) - g \mu_B H \left[\cos(\theta_L - \theta_H + \delta \theta) + \cos(\theta_L + 180^\circ - \theta_H - \delta \theta)\right],\nonumber\\
	&= \Jpar \left( 1+2\delta\theta^2 \right) - 2 g \mu_B H \sin(\theta_L - \theta_H)\delta\theta \label{eq:GdMn2O5_zeeman_exp},
\end{align}
where $\Jpar$ denotes the intrachain magnetic exchange coefficient, and $\theta_L$ ($\theta_H$) the angle between $L$ ($H$) and the $a$-axis.
Minimizing with respect to $\delta \theta$ then leads to
\begin{align}
	\frac{\partial E}{\partial \delta \theta} = 0 &= 4 \Jpar \delta \theta - 2 g \mu_B H \sin(\theta_L - \theta_H) \nonumber\\
	&\Leftrightarrow \nonumber\\
	\delta \theta &= \frac{g\mu_B H \sin(\theta_L - \theta_H)}{2 \Jpar}.\nonumber
\end{align}
Inserting this expression for $\delta \theta$ back into Eq.~\eqref{eq:GdMn2O5_zeeman_exp}, and keeping only the first order terms, we obtain the following expression for the Zeeman contribution through spin canting:
\begin{align}
	E_Z &= -\frac{g^2\mu_B^2 H^2 \sin(\theta_L - \theta_H)^2}{\Jpar} = -\frac{g^2\mu_B^2 H^2 \left(1 - \cos(\theta_L - \theta_H)^2\right)}{\Jpar} \nonumber\\
	&=\frac{g^2\mu_B^2}{\Jpar}\left((\bm{H}\cdot\bm{L})^2 - H^2\right)\nonumber
\end{align}
This energy gain is maximized when $\bm{L}$ is oriented perpendicular to $\bm{H}$ leading to $\bm L \cdot \bm H = 0$, which is exactly what happens in the well-known spin-flop transition.
There, through the application of a strong enough magnetic field along the easy-axis of an AFM system, sudden flip of the spins away from the easy-axis occurs as soon as the gain from the Zeeman energy overcomes the lost easy-axis anisotropy energy. This spin-flopped state, with the AFM order perpendicular to $\bm{H}$, is exactly the one displayed in Fig.~\ref{fig:GdMn2O5_canting}(a).
\\\\
An additional energy contribution is a result of the geometric frustration which forces certain spins in the two chains to be parallel to each other, as shown by the two rightmost arrows in Fig.~\ref{fig:GdMn2O5_canting}(b).
This is very unfavorable for the interchain AFM exchange with coefficient $\Jperp$, again leading to some gained energy if these spins cant slightly towards a more AFM alignment.
\\\\
Adopting a similar strategy as above, this contribution can be derived starting from
\begin{equation}
	E_{ic} = 2 \Jpar \cos(\delta \theta) + \Jperp \left(\cos(\theta_1 + \delta \theta - \theta_2) - \cos(\theta_1 - \theta_2 -\delta \theta)\right),
\end{equation}
where $\theta_1$ ($\theta_2$) signifies the angle w.r.t. the $a$-axis of $\bm{L}_1$ ($\bm{L}_2$).
Expanding again to second order leads to
\begin{equation}
	E_{ic} = 2 \Jpar ( 1+ \delta \theta^2) - 2 \Jperp \sin(\theta_1 - \theta_2)\delta \theta. \label{eq:GdMn2O5_Eic_exp}
\end{equation}
Again minimizing this contribution in terms of $\delta \theta$, we find
\begin{equation}
	\delta \theta = \frac{\Jperp}{2 \Jpar} \sin(\theta_1 - \theta_2).
\end{equation}
Substituting $\delta \theta$ into Eq.~\eqref{eq:GdMn2O5_Eic_exp}, while keeping only terms up to first order in $\frac{\Jperp^2}{\Jpar}$ since it is assumed that $\Jperp << \Jpar$, leads to the final expression for this energy contribution:
\begin{equation}
	E_{ic} = -\frac{\Jperp^2}{\Jpar}\sin(\theta_1 - \theta_2)^2 =  \frac{\Jperp^2}{\Jpar}(\cos(\theta_1 - \theta_2) - 1) = \frac{\Jperp^2}{\Jpar}(\bm{L}_1 \cdot \bm{L}_2)^2 - \frac{\Jperp^2}{\Jpar},
\end{equation}
where the last contribution is a constant, merely causing a shift in the energy, and can thus be omitted in our numerical simulations.
The maximum gain in energy ($\frac{\Jperp^2}{\Jpar}$) is achieved when the chains are oriented perpendicular to each other ($\bm L_1 \cdot \bm L_2 = 0$).
\\\\
These two contributions (Zeeman and Heisenberg exchange) compete with each other, and with the easy-axis anisotropy energy
\begin{equation}
	E_{ea} = -K_L\sum_\alpha(\bm{L}_\alpha\cdot \bm{n}_\alpha)^2,
\end{equation}
where $K_L$ denotes the strength of the easy-axis anisotropy, and $\bm n_\alpha$ denote the orientation of the easy axes:
$\bm{n}_1=\left(\cos(\theta_n), \sin(\theta_n)\right)$ and $\bm{n}_2=\left(\cos(-\theta_n), \sin(-\theta_n)\right)$ with $\theta_n = \rm{23.4}^\circ$.
These are the fourfold axes of the pyramidally coordinated Mn ions, aligned with the long edges of the cyan chains in Fig.~\ref{fig:GdMn2O5_unit_cell}(a).
\\\\
Bringing everything together leads us to the contribution to the effective Hamiltonian that originates from the chains:
\begin{equation}
	H_L = \gamma(\bm{L}_1\cdot \bm{L}_2)^2
    +\sum_{\alpha}\chi((\bm{H}\cdot \bm{L}_\alpha)^2-H^2)
    -K_L\sum_\alpha(\bm{L}_\alpha\cdot \bm{n}_\alpha)^2\label{eq:GdMn2O5_hami_1},
\end{equation}
with $\gamma = \frac{\Jperp^2}{\Jpar}$, and $\chi = \frac{g^2\mu_B^2}{\Jpar}$. 
\\\\
The next step is to find the combination of cross-order coupling terms between $\bm S_i$ and $\bm L_\alpha$ that transform as the unit representation of the symmetry group of the system.
This combination of energy terms will then be invariant under all the symmetry operations of the system as is required.
In order to achieve this, we first list the generators of the paramagnetic parent P$bam$ phase:
\begin{align}
	I &: (x, y, z) \rightarrow (-x, -y, -z)\\
	2_z &: (x, y, z) \rightarrow (-x, -y, z)\\
	2_y &: (x, y, z) \rightarrow (\frac{1}{2} - x, \frac{1}{2} + y, z)
\end{align}
$I$ and $2_z$ are the same symmetry operations in the 2D case we are solving.
Next, a doubling of the unit cell is necessary to fit the overall AFM state, leading to an additional symmetry operation for the translation along the $a$-axis $a: (x, y, z) \rightarrow (x + a, y, z)$ (not taking spins into account), and a halving of the fractional translation $2_y: (x, y, z) \rightarrow (\frac{1}{4} - x, \frac{1}{2}+y, z)$.
In effect, applying these symmetry operations to the degrees of freedom, bearing in mind the spin flip when transforming the chains between the two halves of the magnetic unit cell, leads to the following transformation table:
\begin{table}[h]
\centering
\begin{tabular}{|l|lllllllllll|}
\cline{1-12}
 & $S_1$ & $S_2$ & $S_3$ & $S_4$ & $S_5$ & $S_6$ & $S_7$ & $S_8$ & $L_1$ & $L_2$ & $P_b$ \\ \cline{1-12}
I & $S_8$ & $S_7$ & $S_6$ & $S_5$ & $S_4$ & $S_3$ & $S_2$ & $S_1$ & -$L_1$ & $L_2$ & -$P_b$ \\ \cline{1-12}
$2_y$ & $S_4$ & $S_3$ & $S_2$ & $S_1$ & $S_8$ & $S_7$ & $S_6$ & $S_5$ & $L_1$ & $L_2$ & $P_b$ \\ \cline{1-12}
a & $S_5$ & $S_6$ & $S_7$ & $S_8$ & $S_1$ & $S_2$ & $S_3$ & $S_4$ & -$L_1$ & -$L_2$ & $P_b$ \\ \cline{1-12}
\end{tabular}
\end{table}\\\\
We start with the Heisenberg exchange terms between the Gd spins ($\bm{S}_i$) and the Mn chains ($\bm{L}_1$ and $\bm{L}_2$), with the effective exchange constants $v_1$ and $v_2$.
The former (latter) couples each Gd spin with the chain that harbors the closest (furthest) Mn ion. See the yellow arrows in Fig.~\ref{fig:GdMn2O5_unit_cell}(a) for a schematic depiction of these exchange paths.
Starting from terms with $\bm{S}_1$ and $\bm{S}_2$, and taking the above table of transformations into account, we can identify the following sets of terms:
\begin{align}
	\bm{S}_1\cdot(v_1 \bm{L}_2 + v_2 \bm{L}_1) \xrightarrow{I} \bm{S_8}\cdot(v_1 \bm{L}_2 - v_2 \bm{L}_1) \xrightarrow{a} \bm{S_4} \cdot (- v_1 \bm{L}_2 + v_2 \bm{L}_1) \xrightarrow{I} \bm{S_5} \cdot (-v_1 \bm{L}_2 - v_2 \bm{L}_1), \nonumber\\
	\bm{S}_2\cdot(v_1 \bm{L}_1 + v_2 \bm{L}_2) \xrightarrow{I} \bm{S_7}\cdot(-v_1 \bm{L}_1 + v_2 \bm{L}_2) \xrightarrow{a} \bm{S_3} \cdot (v_1 \bm{L}_1 - v_2 \bm{L}_2) \xrightarrow{I} \bm{S_6} \cdot (-v_1 \bm{L}_1 - v_2 \bm{L}_2).
\end{align}
The combined sum of them transforms according to the identity representation, leading to the following contribution to the total Hamiltonian:
\begin{align}
    H_{LS} =& (\bm{S}_1 - \bm{S}_5) \cdot (v_1 \bm{L}_2 + v_2 \bm{L}_1) + (\bm{S}_2 - \bm{S}_6) \cdot (v_1 \bm{L}_1 + v_2 \bm{L}_2) + \nonumber \\ &(\bm{S}_3 - \bm{S}_7) \cdot (v_1 \bm{L}_1 - v_2 \bm{L}_2) + (\bm{S}_4 - \bm{S}_8) \cdot (-v_1 \bm{L}_2 + v_2 \bm{L}_1).
\end{align}
A similar process can be applied starting from $P_b \, \bm{S_1}\cdot(\beta_2 \bm{L}_1 + \beta_3 \bm{L}_2)$ and $P_b\, \bm{S_2}\cdot(\beta_2 \bm{L}_1 + \beta_3 \bm{L}_2)$, which signify the symmetric Heisenberg exchange striction contribution to the Hamiltonian. This leads to
\begin{align}
	H_{P_b}=&-P_b[E_b + \beta_1 (\bm{L}_1\cdot \bm{L}_2)+
    (\bm{S}_1-\bm{S}_5)(\beta_2 \bm{L}_2 + \beta_3 \bm{L}_1) +
    (\bm{S}_2-\bm{S}_6)(\beta_2 \bm{L}_1 + \beta_3 \bm{L}_2) \nonumber\\ 
    &+(\bm{S}_3-\bm{S}_7)(\beta_2 \bm{L}_2 - \beta_3 \bm{L}_1) +
    (\bm{S}_4-\bm{S}_8)(\beta_2 \bm{L}_1 - \beta_3 \bm{L}_2)],
\end{align}
where the facultative interaction of $P_b$ with an external electric field $E_b$ was also included. 
We can identify three final terms that originate purely from the Gd spins:
\begin{equation}
     H_S=\frac{1}{2}(g \mu_B)^2\sum_{i\neq j}\left(\frac{\bm{S}_i\cdot \bm{S}_j}{r_{ij}^3}-3\frac{(\bm{S}_i\cdot \bm{r}_{ij})(\bm{S}_j\cdot \bm{r}_{ij})}{r_{ij}^5}\right) - \sum_i\left( K_S(\bm{N}_i\cdot \bm{S}_i)^2 + g\mu_\mathrm{B} \bm{H} \cdot \bm{S}_i\right). 
\end{equation}
The first describes the magnetodipolar interaction between Gd spins, which could be relatively large due to the size of the spins and relative proximity to the neighbors.
In the numerical simulations these interactions were restricted to their five nearest neighbors, including periodic images.
Adding further neighbors did not lead to qualitative differences in the results.
The term with $K_S$ denotes the easy-axis anisotropy for the Gd ions, this time with anisotropy axes $\bm{N}_i$ which are unit vectors having alternating angles $\pm 12^\circ$ with respect to the $a$-axis.
$K_S$ is significantly smaller than $K_L$ due to the isotropic environment and valence configuration of the Gd ions.
The final term denotes the Zeeman energy of the Gd ions in the external magnetic field $\bm{H}$.
\\\\
To conclude this section, we gather all the terms in our effective Hamiltonian:
\begin{multline}
    \label{eq:GdMn2O5_model}
    H=\gamma(\bm{L}_1\cdot \bm{L}_2)^2 +\sum_{\alpha}\chi((\bm{H}\cdot \bm{L}_\alpha)^2-H^2)\\
    -K_L\sum_\alpha(\bm{L}_\alpha\cdot \bm{n}_\alpha)^2 -\sum_i\left( K_S(\bm{N}_i\cdot \bm S_i)^2+ g\mu_\mathrm{B} \bm{H} \cdot \bm{S}_i\right) \\
    %\sum_{i,j}J_{ij} \s_i\cdot \s_j 
    + \frac{1}{2}(g \mu_B)^2\sum_{i\neq j}\left(\frac{\bm S_i\cdot \bm S_j}{r_{ij}^3}-3\frac{(\bm S_i\cdot \bm{r}_{ij})(\bm S_j\cdot \bm{r}_{ij})}{r_{ij}^5}\right)
     \\+ \sum_{i,\alpha}V_{i\alpha}\bm{S}_i\cdot \bm{L}_\alpha \\
    -P_b[8 \beta_1 (\bm{L}_1\cdot \bm{L}_2)+(\bm{S}_1-\bm{S}_5)(\beta_2 \bm{L}_2 + \beta_3 \bm{L}_1) \\+ (\bm{S}_2-\bm{S}_6)(\beta_2 \bm{L}_1 + \beta_3 \bm{L}_2)
    + (\bm{S}_3-\bm{S}_7)(\beta_2 \bm{L}_2 - \beta_3 \bm{L}_1) \\
    +(\bm{S}_4-\bm{S}_8)(\beta_2 \bm{L}_1 - \beta_3 \bm{L}_2)]
    + P_b^2/2.
\end{multline}

\section{Methods}
Before continuing with the results and a discussion of the physics, we comment briefly on the numerical side of this Chapter.\\\\
The first question to address is what model parameters to use in conjunction with the Hamiltonian in Eq.~\eqref{eq:GdMn2O5_model}.
This is not particularly straightforward, since our model is phenomenological, and the order parameters and interactions arise from a combination of the microscopic ones.
One could formulate, instead, a model in terms of all the microscopic degrees of freedom, i.e. all the spins of both Gd and Mn ions.
Not only would that lead to a more computationally demanding model, the increased complexity makes developing an intuitive understanding that much harder\footnote{As we will see, even this model leads to very intricate behavior that is hard to disentangle and rationalize fully}.
That means that calculating the coefficients from first-principles calculations is very hard, if not impossible. Even in the case of a fully microscopic spin model, it is not well-known in general how to acquire a correct set of exchange parameters from DFT.
In any case, we chose here to rather make physically inspired initial guesses for the model parameters, after which we further refined these in order to best reproduce the experimental behavior.
\\\\
We know, for example, that the Gd -- Mn magnetic exchange parameter towards the closest chain is larger than towards the other ($v_1>v_2$), and that the order of magnitude for this energy contribution is a couple of meV.
Furthermore, we mentioned a couple of times already that the single-ion anisotropy energy for Gd is expected to be small due to the isotropic envirnment and valence configuration with completely quenched orbital angular momentum.
Instead, the single-ion anisotropy of the Mn ions and, by proxy, the chains is again on the order of a couple of meV.
Lastly, due to the large intrachain $\Jpar$ and small interchain $\Jperp$ magnetic exchanges, we know that $\gamma = \frac{\Jperp^2}{\Jpar}$ and $\chi = \frac{\Jpar}{g^2\mu_B^2}$ are very small.
\\\\
Taking all these considerations into account, we found that the following model parameters reproduce the observations of the experiments well:  
$v_1 = 7.9$~meV, $v_2 = 0.15$~meV, $K_L = 1.1$~meV, $K_S = 0.09$~meV, $\gamma = 0.05$~meV, $\chi=0.01$~meV$^{-1}$.
The parameters for the exchange striction were then chosen to fit the experimental hysteresis loop as well as possible:
${\beta_1 = 0.06\,\mu}$C/cm$^2$, $\beta_2 = 0.06\:\mu$C/cm$^2$, $\beta_3 = 0.04\:\mu$C/cm$^2$.
\\\\
However, these parameters are by no means a requirement for the overarching behavior to exist. As we will show in greater detail in the following section, more specifically in the context of the discussion on the topological nature of the switching, a great deal of freedom exists in choosing these parameters, if the only requirement is to reproduce the three switching regimes.
This lies at the heart of our claim that this effect might exist in other materials, since neither the model nor the parameters depend greatly on the microscopic details of GdMn$_2$O$_5$. 
\\\\
The next question is how to simulate the experimental set-up, which is, in contrast with the question of the model parameters, much easier to answer.
Since the behavior only shows up at temperatures below $\sim$ 4 K, is remarkably deterministic, and through the application of slow varying fields, we simulated the process as a series of simple minimization problems.
This entails taking one of the degenerate starting configurations, increasing the field, minimizing the new situation, applying a further increased field, and so on, thus tracking the local minimum at all steps.
It is quite remarkable that by performing this relatively simple process, purely based on optimizing the energetics, leads to the observed behavior.
This is another indication of the topological nature of the switching behavior.
As we will show more explicitely below, it is sort of an extreme variant of the behavior of Thouless charge pumps, and especially of the recent realization in ultracold gases. \cite{Rice82,Thouless1982,Thouless83,Lohse16,Nakajima16, Atala13}.
It is extreme in the sense that it requires no tunneling whatsoever, which is at the core of the fully deterministic behavior.
\\\\

We now turn to a discussion of the results obtained from the simulations of the effective spin Hamiltonian Eq.~\eqref{eq:GdMn2O5_model}.

\section{Results and discussion}

As mentioned above, the low temperature commensurate state breaks both time reversal symmetry, $T: (\bm{L}_1, \bm{L}_2) \rightarrow (-\bm{L}_1, -\bm{L}_2)$, and inversion symmetry $I:(\bm{L}_1, \bm{L}_2) \rightarrow (-\bm{L}_1, \bm{L}_2)$.
This leads to fourfold degenerate energy surfaces in terms of the angles $\phi_{L_1}$ and $\phi_{L_2}$ as shown for different field strengths at $\phi_{\rm H} = 10^\circ$ in Fig.~\ref{fig:GdMn2O5_heatmap}.
The ground state at zero external field is one of the minima indicated by the white dots in the top left panel, whence one is selected as the starting point of the simulations.
The magnitude of the applied field $|\bm{H}|$ is then gradually increased and decreased while minimizing the energy at each increment in order to track the instantaneous local minimum.
Since the exerimentally observed behavior occurs at such a low temperature, and is fully determistic, this essentially 0\,K simulation should capture the underlying physics.

\begin{figure*}[h]
	\begin{subfigure}{0.24\textwidth}
    \IncludeGraphics{"field_heatmap1"}
	\end{subfigure}
	\begin{subfigure}{0.24\textwidth}
    \IncludeGraphics{"field_heatmap2"}
	\end{subfigure}
	\begin{subfigure}{0.24\textwidth}
    \IncludeGraphics{"field_heatmap3"}
	\end{subfigure}
	\begin{subfigure}{0.24\textwidth}
    \IncludeGraphics{"field_heatmap4"}
	\end{subfigure}\\
	\begin{subfigure}{0.24\textwidth}
    \IncludeGraphics{"field_heatmap5"}
	\end{subfigure}
	\begin{subfigure}{0.24\textwidth}
    \IncludeGraphics{"field_heatmap6"}
	\end{subfigure}
	\begin{subfigure}{0.24\textwidth}
    \IncludeGraphics{"field_heatmap7"}
	\end{subfigure}
	\begin{subfigure}{0.24\textwidth}
    \IncludeGraphics{"field_heatmap8"}
	\end{subfigure}
	\caption{{\bf Energy Surfaces.} The evolution of the energy surface during field sweep at +10$^\circ$ is displayed, with the white dots in the top left panel denoting the four degenerate minima. If the field would be applied along -10$^\circ$, horizontal gutters would form.\label{fig:GdMn2O5_heatmap}}
\end{figure*}


The result of the earlier described simulation procedure, together with these model parameters, is shown in Fig.~\ref{fig:GdMn2O5_theory}, where the lower panels (d-f) show the path that the system tracks through the $\phi_{L_1}$,$\phi_{L_2}$ energy landscape as the field is cycled, at the three values of $\phi_{\rm H}$ of panels (a-c).
The background energy surfaces are chosen to reflect how the barriers at an intermediate field value inside the hysteresis region differ depending on $\phi_{\rm H}$.

Our model thus reproduces the experimentally observed four-state switching around the magic angle, $\phi_{\rm H}^\ast  = 10^\circ$, (Fig.~\ref{fig:GdMn2O5_theory}(b)) and the switching between states 1 and 2 with close values of $P_b$ for $\phi_{\rm H} > \phi_{\rm H}^\ast$  (Fig.~\ref{fig:GdMn2O5_theory}(c)).
For small $\phi_{\rm H}$, as mentioned before, our simulations show the transition between states 1 and 4 accompanied by the polarization reversal (Fig.~\ref{fig:GdMn2O5_theory}(a)), similar to the behavior in Ref.~\cite{Lee13}, instead of the observed $1\leftrightarrow2$ switching of Fig.~\ref{fig:GdMn2O5_experiment}(a). 
This discrepancy may be related to a thermally activated transition between states 1 and 2, which are closer in the order-parameter space than states 1 and 4.
\begin{figure}[b!]
    \IncludeGraphics[width=0.9\linewidth]{Pb_3panels_heatmaps}
    %\includegraphics[width=\linewidth]{fig/L1L2_heatmap.png}
    \caption{\label{fig:GdMn2O5_theory}{\bf Simulation of magnetoelectric behaviour.}
    (a-c) Evolution of electric polarization $P_b$ during the magnetic field sweep cycle for various magnetic field orientations. 
   In each panel, the changes of the curve color indicate the same progression of the sweep cycle as Fig~\ref{fig:GdMn2O5_experiment}. The four-state switching is seen for the field at the magic orientation. 
    The insets indicate the corresponding switching paths and winding numbers.
    (d-f) Trajectories (in green) in the space of the N\'eel vectors orientations, $(\phi_{\rm L_1},\phi_{\rm L_2})$, through the field sweep cycles in different regimes. The color map shows the energy landscape in the vicinity of the switching fields. 
}
\end{figure}

The magic angle region for this set of model parameters is relatively narrow, about 0.5$^\circ$, whereas in the experimental measurements it is found to be 5$^\circ$ wide.
However, by tuning the model parameters both the width and positioning of the ``magic'' angle region can be changed.
This will be discussed in further detail later, but first we turn to the peculiar four-state switching cycle.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% begin copied section
\begin{figure}[h]
	\IncludeGraphics{spin_configs}
	\caption{{\bf Spin configurations for different field angles and values.} The green arrows denote the AFM order parameter orientations during the field sweep (a) where the color gradient (red to blue) in panels (b-f) correspond to the field value of $\bm{H}$ in panel (a). The microscopic spin configuration of panel (c) is detailed in the right panel surrounded by the red square. Spin configurations (1, 2, 3, 4) are labeled as in Fig.~\ref{fig:GdMn2O5_theory}(b). The full rotation is performed by the chain that is most parallel to the direction of the applied field.\label{fig:GdMn2O5_regimes}}  
\end{figure}
\begin{figure}[h!]
    \centering
    \IncludeGraphics{4configs.png}
    \caption{\label{fig:GdMn2O5_spin_configs} The spin configurations corresponding to the four states. Gd ions are displayed in green, Mn in purple. The cyan lines highlight the orientation of the chains. }
    \label{fig:my_label}
\end{figure}

The Mn and Gd spin configurations for the four states are shown in the right panel of Fig.~\ref{fig:GdMn2O5_regimes}, and in greater detail in Fig.~\ref{fig:GdMn2O5_spin_configs}. 
%
In the low-field states 1 and 3, Mn spins align close to the anisotropy axes of the two chains, with the Gd spins (green) aligning generally AFM with the Mn ion (purple) of the chain that they are coupled strongest with ($v_1$ in Fig.~\ref{fig:GdMn2O5_unit_cell}). This causes a roughly left left right right sequence of the Gd spins along the $a$-direction. 
% 
In the high-field states 2 and 4, Mn spins are nearly orthogonal to the magnetic field. The Gd spins in this case are again influenced mostly by the AFM exchange with the nearest Mn ion, but due to the Zeeman interaction with the field they are slightly tilted towards it. 
%
Turning to the energy landscapes in Fig.~\ref{fig:GdMn2O5_theory}(d-f) and Fig.~\ref{fig:GdMn2O5_heatmap}, we can see that in the hysteresis region it consists of two narrow valleys elongated in the $\phi_{\rm L_1}$-direction and separated by the angle $\pi$ in the $\phi_{\rm L_2}$-direction.
These two valleys are time-reversal partners, and the system remains in one of them during the sweeping.
This means that from the total of eight states, four low-field states and four high-field states, only half are accessed.

%
The approximate energy independence on the direction of $\bm{L}_1$ near the switching field is the result of the competition between the Zeeman and anisotropy energies of the Mn spins in chain 1.
There are two sources of this anisotropy energy.
The first is the usual single-ion one $K_L$ for which the magnetic field is tending towards the easy axis, as indicated by the black arrow in Fig.~\ref{fig:GdMn2O5_theory}(h).
Due to the interaction with the Gd spins, and the Gd spins being affected greatly by the magnetic field, one could say that there is a second ``dynamical'' contribution to the anisotropy for the chains, where the easy-axis and size of the coefficient varies.
At the switching point the sum of these contributions and the Zeeman contribution lead to the observed flattening of the energy surface, causing the sudden flip by 90$^\circ$ to align perpendicular to the field.
The evolution of the energy contributions is shown in Fig.~\ref{fig:GdMn2O5_neb}(c).
Combined with the coupling of this soft magnetic mode to the electric polarization, a degree of electric control over the magnetic configuration may be possible~\cite{Oh14}.
%
\begin{figure}[h]
	\begin{subfigure}{\textwidth}
    \IncludeGraphics{energy_contributions_neb}
	\end{subfigure}
    % \IncludeGraphics[width=\linewidth]{}
    %\includegraphics[width=\linewidth]{fig/L1L2_heatmap.png}
    \caption{\label{fig:GdMn2O5_neb}{\bf Energy evolution.}
    a) Evolution of transition barriers between states 1, 2, 3, 4 as the magnetic field at 10$^\circ$ to the $a$-axis is swept through the hysteresis region. The plots are shifted vertically, and magnetodipolar interactions were enhanced by a factor of 5.3 for clarity. This latter increases the width of the hysteresis region. The curve colors encode the corresponding magnetic field strength. The blue circles and arrows show the trajectory of the energy minimum due to field sweeps.
    b) The red square and corresponding schematic on the right shows the asymmetric evolution of the barrier from state 2 to 1, and from 2 to 3 around the critical field $H^\ast$ where the barriers are of equal height.
    c) The different contributions to the total energy. 
    Coordinated changes of the state energies and barrier asymmetry with magnetic field enable the topological behavior.
    }
\end{figure}
A similar flattening of the energy surface occurs in antiferromagnets near the spin-flop transition, where at a critical field applied along the easy-axis the spins flip perpendicular to the field in order to gain Zeeman energy from canting towards it.  
The important difference of the behavior here, compared with a spin-flop, is that the direction with which the spins progress during the up--and--down sweeps is unambiguous, i.e. the spins rotate unidirectionally throughout the cycling.
Where the observation of the ``dynamical'' anisotropy caused by the Gd spins already hints at how this unidirectionality arises.

Comparing the trajectories (white lines in Fig.~\ref{fig:GdMn2O5_theory}(d-f)), describing the field-dependent state of the system, we see that it is confined to the earlier described valleys in all regimes.
%
In the two-state regimes (Fig.~\ref{fig:GdMn2O5_theory}(d,f)), the system remains in the neighbourhood of the starting point, with the trajectory contractible to a single point. 
In the four-state regime in Fig.~\ref{fig:GdMn2O5_theory}(e), however, the system progresses through the entire valley in a unidirectional sense, connecting the top and bottom edges, with $\bm{L}_1$ rotating a full $360^\circ$.
The Gd spins show a similar behavior: the spins of the Gd ions that are coupled to chain 1 stronger than to chain 2 undergo a full-circle rotation, whereas the remaining Gd spins move back and forth together with $\bm{L}_2$.
Thus in the four-state regime, the material acts as a crankshaft transforming the back and forth changes of the external magnetic field (``the piston'') into circular motions of the spins (``driveshaft'').

In this case, the path can not be contracted to a single point which highlights its {\em  topologically distinct} nature as compared with the other two regimes.
Indeed, one can define a winding number of a trajectory in the two-dimensional  $(\phi_{\rm L1},\phi_{\rm L2})$-space with a torus topology: $Q=\frac{1}{2\pi}\int_0^{t_0} dt (L_1^x\partial_t L_1^y - L_1^y \partial_t L_1^x)$, 
where the integral is taken over the time interval, $t_0$, during which the magnetic field is ramped up and down twice and the system returns to its initial state.
In the two-state switching regime, $Q  = 0$, whereas for the four-state switching, $Q = 1$.
This means that as long as the two extremal regimes are present in the material (Fig~\ref{fig:GdMn2O5_theory} (d,f)), there will always exist a boundary region near the magic angle (Fig~\ref{fig:GdMn2O5_theory}(e)), interpolating between the two, and leading to the circular four-state hysteresis.
While the values of the model parameters decide the exact position and width of this topologically nontrivial region, we found that it is present for a surprisingly wide range of parameters, as shown in Fig.~\ref{fig:GdMn2O5_windingvsparam} and will be discussed further down.

To analyze further why the system follows the unidirectional trajectory in Fig~\ref{fig:GdMn2O5_theory}(e) at $\phi_{\rm H}^\ast=10^\circ$, we performed nudged elastic band calculations of the barriers separating the different states, as shown in Fig~\ref{fig:GdMn2O5_neb}(a).
%
The simulation starts in the low-field state 1, which becomes metastable as the magnetic field increases. 
States 1 and 3 (2 and 4), related by spatial inversion that changes sign of $\bm{L}_1$, have equal energies for any applied magnetic field, $E_1 = E_3$ ($E_2 = E_4$).
This is in apparent contradiction with the unidirectional evolution, $1 \rightarrow 2 \rightarrow 3 \rightarrow 4$.
%
The resolution of this paradox lies in the fact that the energy barriers separating state 1 from states 2 and 4 are in general different, since the saddle-point states 12 and 14 (see Fig.~\ref{fig:GdMn2O5_neb}(b)) that determine the height of these barriers are not related by any symmetry transformation.
Moreover, the evolution of these barriers in terms of the applied field is also asymmetric.

The top curve in Fig.~\ref{fig:GdMn2O5_neb}(a) is calculated at the field $H_{1}$, at which state 1 becomes unstable and the barrier along the $1\to 2$ path disappears, while the barrier separating states 1 and 4 is still present. 
%
On the downward field ramp, state 2 becomes unstable at $H = H_2$, when the barrier between states $2$ and $3$ vanishes while states $2$ and $1$ are still separated by a barrier (bottom curve), which leads to the $2\to3$ transition.
%
When the magnetic field is increased and decreased again, the transition sequence $3 \to 4 \to 1$ occurs in precisely the same way: since the barrier states 34 and 12  (14 and 23) are related by inversion transformation,  $E_{34} = E_{12}$ ($E_{41} = E_{23}$). 
%
The only difference is the opposite sign of the electric polarization. 

This evolution of the potential energy surface is equivalent to that of a Thouless charge pump, in particular, the one induced by circular motion in the two-dimensional parameter space of the Rice-Mele model~\cite{Rice82} recently realized in ultracold gases \cite{Lohse16,Nakajima16,Atala13}.

To clarify the origin of the barrier asymmetry, we consider the system in state 2 at field $H^*$, at which the barriers to states 1 and 3 are equal $E_{12} = E_{23}$ (curve labelled with $H^*$ in Fig.~\ref{fig:GdMn2O5_neb}(a)).
For a field $H$ in the vicinity of $H_\ast$, $E_{23}(H) - E_{12}(H) \approx (H - H_\ast)(M_{12} - M_{23})$, where $M_{12}$ and $M_{23}$ are the magnetizations of the corresponding saddle point states at $H = H_\ast$ and $M_{23} > M_{12}$ in our simulations.
% The contributions to the magnetization difference for every spin are shown in Fig.~\ref{fig:energyAndSaddles}(c) of the Methods section~\footnote{the term due to the shift of the saddle point position along the reaction coordinate drops due to Hellmann-Feynman theorem.}.
For $H > H_\ast$, $E_{12}(H) < E_{23}(H)$ and the barrier 12 disappears when the magnetic field increases, resulting in the $1 \to 2$ transition. For $H < H_\ast$, the barrier 23 is lower than 12 and disappears, triggering the $2 \to 3$ transition.

The left panel of Figure~\ref{fig:GdMn2O5_regimes} summarizes all the switching regimes found in GdMn$_2$O$_5$.
%
The switching behaviour for $\phi_{\rm H} < 0$ follows from  $\tilde{2}_x$ crystal symmetry combined with the translation by $a$, $S_a$, under which $(L_1^x,L_1^y) \rightarrow (L_2^x,-L_2^y)$.
In this case, horizontal valleys appear in the potential energy landscape instead of the vertical ones cf.~Fig.~\ref{fig:GdMn2O5_theory}(d-f). Accordingly, $\bm{L}_2$ at the negative magic angle, $\phi_{\rm H} = -10^\circ$,  rotates in the direction opposite to the rotation direction of $\bm{L}_1$ at $\phi_{\rm H} = +10^\circ$. The rotation direction is unchanged under the magnetic field reversal ($\bm{L}_{1,2}$ is invariant under $T$ combined with $S_a$, whereas $\bm{H}$ changes sign), and under the combined reversal of $\bm{L}_{1}$ and $\bm{L}_{2}$.
Hence, no antiferromagnetic domain selection by magnetoelectric cooling is required for the unidirectional circular switching of spins, and only the axis and size of $\bm{H}$ matters, rather than its sign.
This is demonstrated in Fig.~\ref{fig:GdMn2O5_regimes}(a) where a sign change still leads to the observed rotation.
%
At $\phi_{\rm H} = \pm 20^\circ$, both N\'eel vectors toggle between two directions in such a way that the angle between them and, hence, the electric polarization changes very little (Fig.~\ref{fig:GdMn2O5_regimes}(b,f)). 
On the other hand, at $\phi_{\rm H}=0^\circ$, $\bm{L}_1$ and  $\bm{L}_2$ tilt in opposite directions. The resulting large variation of the angle between these two vectors gives rise to the two-state switching with the polarization reversal, as seen in Fig.~\ref{fig:GdMn2O5_regimes}(d). This suggests that small-amplitude relative rotation of $\bm{L}_1$ and $\bm{L}_2$ is an electromagnon mode that could be excited by oscillating $H_a$ or $E_b$. 
%
The full-circle rotation of  $\bm{L}_1$ occurs in the crossover region between the two toggling regimes, as shown in Fig.~\ref{fig:GdMn2O5_spin_configs}(c,e).

Having identified all possible switching regimes and patterns, we turn to the generality of the observations. 
As it turns out, while changing the model parameters, as long as the high and low angle regimes remain, there has to be a region where the four-state regime appears. The size and position of this regime depends on the details of the used parameters, but similar to other topological boundaries (e.g. magnetic domain walls, topologically protected edge states in topological insulators), it can not be destroyed when the neighboring ``domains'' are present.
The influence of varying a single model parameter at a time is demonstrated in Fig.~\ref{fig:GdMn2O5_windingvsparam}, where the blue and red shaded regions correspond to the low and high angle behavior, respectively. Indeed, we see that for many parameters the four-state region exists as the boundary between the two-state ones.
One can also observe that the influence of some parameters is higher than others. For instance, taking $v_1=0.7$ dramatically increases the width of the four-state switching region to the interval of [5.2$^\circ$, 17.6$^\circ$]. However, even at very high values the four-state switching is maintained.
A small variation to $K_L$, the strength of the Mn anisotropy, on the other hand, leads to a big change to the characteristics of the topologically protected region.
This is not surprising, since the behavior of the Mn chains is very similar to that of the usual spin-flop transition, which crucially depends on the easy-axis anisotropy.
\begin{figure}[h!]
	\IncludeGraphics[width=0.90\linewidth]{winding_modelparam.png}
	\caption{\label{fig:GdMn2O5_windingvsparam} {\bf Magic Angle region.} The panels demonstrate the influence of selected model parameters on the magic angle region. In each panel only the parameter labeled on the vertical axis is varied, whereas the others are kept at the values reported in the text of this section, and used for Fig.~\ref{fig:GdMn2O5_theory} of the main text. All parameters are reported in units of meV. The blue regions signify the low angle switching regime, while the red denotes the high angle switching regime. The white boundary region is where the double loop switching regime occurs, characterized by a winding number of 1, and is topologically protected by the neighboring regimes.}
\end{figure}

\section{Simplified Model}
Having modelled the topologically protected switching in  GdMn$_2$O$_5$ with all its complexity, one may wonder what the minimal requirements are to have a similar behavior where the spins rotate 360$^\circ$ while the applied field only oscillates along a single axis.
It is clear from the spin configurations in Fig.~\ref{fig:GdMn2O5_spin_configs} that the chain with Mn moments most parallel to the applied field does the full rotation, while the other chain merely toggles around its starting position. Gd moments mostly follow the behavior of the chain they are most strongly coupled to. This warrants an attempt to explain the observed behavior using only a single Mn chain with Gd spins, coupled to it via $v_1$. 
In the particular case where the magic angle is along $\phi_H = +10^\circ$, we keep $L_1$, $S_2$, $S_3$, $
S_6$ and $S_7$ as the variables in the model. We also neglect the easy axis anisotropy of Gd spins.
This leaves us with the following Hamiltonian, combining two parts, one with the dipolar terms $H_{dip}$ and another with all the other terms $H'$:
\begin{align}
	H &= H' + H_{dip} \\
	H' &= v_1(\bm{S}_2 + \bm{S}_3 - (\bm{S}_6 + \bm{S}_7))\cdot\bm{L}_1 \nonumber\\
	&- g \mu_B (\bm{S}_2 + \bm{S}_3 + \bm{S}_6 + \bm{S}_7) \cdot \bm{H} \nonumber\\
	&+ K_L (\bm{L}_1 \cdot \bm{n})^2 \nonumber\\
	H_{dip} &= \frac{1}{2}(g \mu_B)^2\sum_{i\neq j}\left(\frac{\bm{S}_i\cdot \bm{S}_j}{r_{ij}^
3}-3\frac{(\bm{S}_i\cdot \bm{r}_{ij})(\bm{S}_j\cdot \bm{r}_{ij})}{r_{ij}^5}\right)\nonumber.
\end{align}
Due to the symmetries of this model and the geometry of the material we end up with two copies of one spin in the first half of the magnetic unit cell and one in the second half of the unit cell, with the chain in between (see Fig.~\ref{fig:GdMn2O5_simple_model}).
This necessitates $S_2 = S_3$ and $S_6 = S_7$, and thus allows us to consider one of the two copies. Again, we keep only nearest-neighbor magnetodipolar terms, and arrive to
\begin{align}
	H' &= 2v_1(\bm{S}_3 - \bm{S}_6)\cdot\bm{L}_1 - 2g \mu_B (\bm{S}_3 + \bm{S}_6) 
\cdot \bm{H} \\
	&+ K_L (\bm{L}_1 \cdot \bm{n})^2 \nonumber\\
	H_{dip} &= (g \mu_B)^2\left(\frac{\bm{S}_3\cdot \bm{S}_6}{r_{36}^3}-3\frac{(\bm{S}_3\cdot \bm{r}_{36})(\bm{S}_6\cdot \bm{r}_{36})}{r_{36}^5}\right)\nonumber,
\end{align}
as a minimal model that still demonstrates the crankshaft-like behavior.

\section{Conclusions}
We used a relatively general and simple, quasi-classical spin model in order to describe a never before observed four-state switching loop in GdMn$_2$O$_5$.
The model reproduces the experimental measurements well, and from further analysis it leads to the conclusion that this behavior is topologically protected by the presence of two, more normal, two-state magnetoelectric switching regimes.
While we deviced a set of model parameters to reproduce the behavior in GdMn$_2$O$_5$, it turns out that a wide set of model parameters can generate the same behavior.
Furthermore, due to the topological nature of the effect, we posit that the screening for further materials exhibiting a similar behavior would be relatively simple since only high and low angle regimes need to be identified.
The magic angle boundary region will then necessarily exist at an intermediate angle.

We also found that the novel four-state regime comes together with a unique large-amplitude collective mode -- the full-circle rotation of half the spins.
The robust unidrectional spin rotation originates from the asymmetric evolution of the energy landscape, and corresponds to an incontractible loop in the order parameter space, ultimately leading to the topological nature of the switching in this material.
This is a microscopic analogue to the crankshaft in a car, transforming linear back-and-forth motion of the applied magnetic field (the piston) into circular motion of the spins (crankshaft).
Due to different behavior of the two chains in GdMn$_2$O$_5$, i.e. one doing a full-circle rotation while the other toggles, the double sweep of the magnetic field is accompanied by two reversals of the electric polarization.
%
One could envision a theoretical application of this behavior as an electric counter of magnetic field pulses.
