\newcommand{\Jpar}{J_{||}}
\newcommand{\Jperp}{J_{\perp}}
\chapter{Magnetoelectric crankshaft: topologically protected switching in multiferroic GdMn$_2$O$_5$ \label{ch:GdMn2O5}}
\section{Introduction}
Efficient control and probing of robust order has historically been one of the main technological drivers for research in condensed matter.
The hallmark example is the impact that the discovery of giant magnetoresistance has had on the efficiency of the read head in hard disks, by using direct electrical readout rather than a solenoid \cite{Baibich1988,Binasch1989,Tsymbal2001,Nunez2006TheoryMetals,Chappert2007}.
This is achieved by constructing the read head as a multilayer sandwich composed of a pinned magnet, a non-magnetic metal and a soft magnet.
The latter will align itself to the information storing magnetic domains on the platter of the hard disk.
The resistivity of the stack then depends strongly on the mutual alignment of the pinned and soft magnets, as a result of the giant magnetoresistance.
By applying a constant bias voltage to the read head, the magnetically stored information can then be probed electrically through the measurement of the resulting current.
Underlying this mechanism is the Stoner effect, causing the conducting states around the Fermi level of metallic magnets to have a well-defined spin polarization depending on the internal magnetization.
If current flows through these metallic magnets, the carriers with spins aligned to the pinned magnet will be scattered strongly by the soft magnet if the latter's magnetization is antiparallel to the former, leading to low conductivity.
Conversely, when the magnetizations of the two magnets are aligned, the carriers will scatter weakly, which resuls in a high conductivity.
This development has led to a significant increase of the efficiency of hard drives.

There remains, however, the issue of writing the information in the first place.
In modern state-of-the art high density storage technologies, this is still done by applying an external magnetic field with an electromagnet to reorient the ferromagnetic domains. One can imagine this to be quite an inefficient process, both from the point of view of granularity (stray fields and non-locality of magnetic fields limit the minimum size of the domains), as from that of energy loss through heat dissipation.
Improving these Figures of Merit drives much of the current research in the field of spintronics, with promising applications like spin-transfer torque devices \cite{Nunez2006TheorySemiconductors,Nunez2006TheoryMetals,Nunez2011, Kent2015, Jungwirth2016}.
These use an inverse effect to the one described above.
First a current is created with carriers that have a well-defined orientation of the spin by using e.g. a pinned ferromagnet, as in the read head.
Subsequently, this current is forced through (or close to) a magnetic domain by the bias electric field.
If the spin of the carriers and the magnetization of the domain are misaligned, strong scattering occurs which rotates the spin moments of the carriers.
However, this will cause an opposite torque on the magnetization of the domain, due to the conservation of angular momentum. This transfer of torque is where the classification of {\it spin-transfer torque} devices originates from.
If enough such spin-polarized current flows through the domain, its magnetization will eventually be reoriented along the spins of the incident carriers. This method circumvents the need of electromagnets to create a magnetic field by using circular currents, greatly increasing the efficiency and allowing for greater domain density.
\\\\
It is clear that the longevity associated with magnetic order, combined with the ease and efficiency of manipulation through electrical means is highly desirable.
This brings us to the topic of this Chapter, namely the magnetoelectric effect in multiferroic insulators.
As the name implies, the magnetoelectric effect allows for the electric control of magnetic order or the magnetic control of ferroelectric polarization~\cite{Spaldin2019,Khomskii2009,Fiebig2005,Fiebig2016,Cheong2007}, the former being the most attractive from a technological point of view.
In practice, however, the effectiveness of this cross-order control is often limited, and multiferroic materials are rare to begin with.
The reasons why are summarized briefly below, following the discussion of Khomskii in Ref.~\cite{Khomskii2009}.
\\\\
Two main classes of multiferroic materials can be identified: type-I and type-II multiferroics.
In the former, the ferroelectric polarization and magnetic order stem from different origins, and are thus largely decoupled.
The latter, instead, develops ferroelectricity as a result of an inversion symmetry breaking magnetic configuration.
In this case the two orders are coupled strongly, but the size of the ferroelectric polarization is often limited, and generally much lower than for type-I multiferroics.
\\\\
We use the ABO$_3$ perovskites with a magnetic transition metal B ion as an example in order to understand why multiferroics are so rare.
Magnetic order is almost exclusively caused by partially filled valence shells, partially-filled $d$ shells in this case.
Ferroelectricity, on the other hand can find its origin in various microscopic effects.
In many of them, the ferroelectricity is caused by an off-center shift of the B ion in the surrounding oxygen octahedron (see Chapter~\ref{ch:Softening} for a detailed discussion on ferroelectricity in BaTiO$_3$).
This is due to the formation of strong covalent bonds between one (or three) oxygens and the B ion, using the latter's empty $d$ states. 
While it is not fully understood why, the presence of any electrons in the $d$ shell of the B ion severely hampers this process which is one of the root causes for the rarity of multiferroicity in these materials, since magnetism requires at least some filling.
A more detailed study on the rarity of multiferroics was performed in Ref.~\cite{Hill2000}.

One of the ways both orders can appear simultaneously is with A ions that have lone pairs (filled outer $s$ shell), e.g. BiFeO$_3$, where the Bi$^{3+}$ ion harbors such a lone pair, which is highly polarizable.
When the temperature is lowered, this leads to an instability that favors the alignment of such pairs, causing the polarization in the ferroelectric phase of this material.
The ordering temperatures for the ferroelectric and magnetic order are 1100 K and 643 K, respectively, with a polarization $P \sim$ 90$\mu$C/cm$^2$.
BiFeO$_3$ is thus a clear example of a multiferroic material, however, the two orders have completely different origin and the cross-order coupling is thus extremely low.
Nonetheless, some more recent developments have shown promising ways to overcome the limited magnetoelectric coupling in BiFeO$_3$, allowing for a degree of control over weak ferromagnetic moments by an external electric field \cite{Heron14}. 
For further details on the mechanisms of the ferroelectricity in the other type-I cases, either through charge ordering or tilting of the oxygen octahedra, we refer the reader back to Ref.~\cite{Khomskii2009}.
\\\\
On the phenomenological side, the simplest Landau free energy one can write down for a homogeneous type-I multiferroic, by expanding the free energy $F$ in terms of ferroelectric polarization $P$ and magnetization $M$ (both scalars), is:
\begin{align}
	F(P, H) =& F_0 + \frac{a}{2} (T-T_P) P^2 + \frac{b}{4} P^4 - P E \\
	&+\frac{\alpha}{2} (T-T_M)M^2 + \frac{\beta}{4} M^4 - MH - \frac{g}{2}P^2 M^2,
\end{align}
with $T$ denoting the temperature, $E$ the electric field, and $H$ the magnetic field.
All coefficients are taken to be positive, such that below the ferroelectric (ferromagnetic) transition temperature $T_P$ ($T_M$) nonzero $P$ ($M$) develops.
The lowest order symmetry-allowed term that couples $P$ and $M$ is $-gP^2M^2$, obeying both the time reversal and inversion symmetries of the parent structure above the transition temperatures $T_P$ and $T_M$.
Minimizing the energy with respect to both orders for $T<T_M,T_P$ and no applied external fields, leads to,
\begin{align}
	\frac{\partial F}{\partial P} = 0 \Leftrightarrow P^2 &= - a(T-T_P)/b + gM^2\\
	\frac{\partial F}{\partial M} = 0 \Leftrightarrow M^2 &= - \alpha(T-T_M)/\beta + gP^2.
\end{align}
Both order parameters thus depend on the value of the other through the magnetoelectric coupling $g$. This leads to a change in one when an external field is applied to the other.
As mentioned before, however, the different microscopic origins of both orders usually result in a tiny value of $g$.
Indeed, the effective dielectric constant $\varepsilon$ of BiMnO$_3$ only displays a weak anomaly at the ferromagnetic transition temperature ($T_M$), and is only weakly affected by an external magnetic field, leading to a change of $\varepsilon$ at an external magnetic field of 9\,T of only 0.6\% compared with its value at zero field value.
This means that the electrical behavior of this material is almost impervious to an external magnetic field, a clear demonstration of the problems with cross-order control in type-I multiferroics.
\\\\
In an effort to improve this sought-after control, we turn to the type-II multiferroics.
As mentioned before, the ferroelectricity in these materials is a result of the inversion breaking magnetic order that sets in below $T_N$.
Due to the shared microscopic origin, the coupling between the magnetic and ferroelectric orders in these materials is generally much higher than for type-I multiferroics, leading to an increased magnetoelectric effect~\cite{Oh2014,Radaelli08Y}.
However, one caveat is that in this case the ferroelectric polarization is much lower, since the associated distortions are a result of the force due to the weak magnetoelectric coupling\footnote{The order parameter describing the ferroelectric polarization is a pure slave order parameter, that would not develop on its own in these materials. It is only nonzero because of the appearance of the primary order parameter that describes the magnetic order below $T_N$ (i.e. there is no $T_{P}$).}.
This leads to a much reduced effectiveness of external electric fields as a method of effective control of the magnetic order.  
\\\\
Here, we focus specifically on GdMn$_2$O$_5$ (see Fig.~\ref{fig:GdMn2O5_unit_cell}(a)) that demonstrates an exceptional tunability of the ferroelectric polarization through an applied magnetic field~\cite{Khomskii2009,Lee13}.
The orthorhombic $R$Mn$_2$O$_5$ manganites have a very complex crystalline structure, which leads to a wealth of different phases depending on the temperature, rare-earth ion $R$, external magnetic field and even electric-field poling history~\cite{Chapon04, Chapon06, Blake05, Radaelli09,Radaelli08, Zheng2019}.

In the next Section, we first give a summary of the transitions and phases that are important for this Chapter, followed by a discussion on the experiments that were performed by our collaborators.
Afterwards, we continue with a description of the system in terms of an effective spin Hamiltonian involving the Gd spins, and the AFM order parameters $\bm L$ describing the two Mn chains.
We demonstrate that our model reproduces the overall behavior observed by the experiments remarkably well, and discuss its energetic properties.
After uncovering the source of the peculiar magnetoelectric switching, we shift our focus to the magnetic configuration, and how it changes because of the applied magnetic fields.
Finally, we comment on the topological nature of the switching behavior and the generality of the model, and conclude with an intuitive argument and resulting simplified model in an attempt to further rationalize our observations. 

\section{GdMn$_2$O$_5$}
All $R$Mn$_2$O$_5$ have crystallographic group P$bam$ \cite{Alonso97} in the paramagnetic phase at high temperature, which is eventually lowered to P$_ab2_1a$ when the commensurate magnetic order condenses below $T_{N} \approx 33$ K.
This order is characterized by the propagation vector $\bm{q} = (1/2, 0, 0)$, i.e. there is a unit cell doubling along the crystalline $a$-direction, as shown in Fig.~\ref{fig:GdMn2O5_unit_cell}(a).
The magnetic configuration repeats along the crystalline $c$-direction. The magnetic phase transition goes hand in hand with a sharp anomaly in the dielectric constant $\varepsilon_b$, signaling the onset of the improper ferroelectric polarization  along the $b$-direction ($P_b$) \cite{Vecchini08,Lee13,Vecchini14}.
When the temperature is lowered further, $P_b$ saturates to a maximum value of around 3600 $\mu$C/m$^2$, the largest found for any rare-earth manganite.
However, it is still tiny compared to proper ferroelectrics like BaTiO$_3$ with $P \approx 3 \times 10^5 \mu $C/m$^2$ at room temperature \cite{Mason1948,VonHippel1950}.
The magnetic unit cell is traversed by two antiferromagnetic (AFM) Mn chains, which are formed by pyramidally coordinated Mn$^{3+}$ and octahedrally coordinated Mn$^{4+}$ ions, as indicated by the cyan lines and purple polygons in Fig.~\ref{fig:GdMn2O5_unit_cell}(a).
The Mn spins inside the chains lie mostly along the fourfold symmetry axis of the Mn$^{3+}$ pyramids, making angles of $\pm 23.4^\circ$ with the $a$-axis.
\\\\
\begin{figure}
	% \centering
	\IncludeGraphics[width=0.9\textwidth]{unit_cell.png}
	\caption{\label{fig:GdMn2O5_unit_cell}{\bf Unit cell and magnetic configuration of GdMn$_2$O$_5$.} a) The magnetic unit cell with the zig-zag chains along the $a$-direction (cyan lines) denoting which Mn ions are linked by large AFM exchange, leading to the $\bm{L}_1$ and $\bm{L}_2$ N\'eel vectors used in the theoretical model (see Sec.~\ref{sec:GdMn2O5_Theory}). The boundary of the structural unit cell is marked by the black rectangle. The orange arrows denote the exchange paths between Gd and neighboring Mn ions in both chains, corresponding to $v_1$ and $v_2$ in the model. The two sources of the symmetric Heisenberg exchange striction are shown in (b) and (c). The black arrows indicate the zero field orientation of the spins, and the yellow and blue arrows denote the expanding and contracting bonds, respectively. The resulting polarization $P_b$ is shown by the large yellow arrow  in panel (a).}
\end{figure}
The improper ferroelectricity is generated through the symmetric Heisenberg exchange striction due to the strong AFM exchanges combined with the geometric frustration of the Mn chains~\cite{Choi2008}.
This frustration appears due to the odd number of AFM bonds in the Mn pentagons surrounding each Gd ion, similar to an AFM triangular lattice, which does not allow for all the AFM exchanges to be satisfied simultaneously (i.e. by having completely antiparallel spins on each AFM bond).
Fig.~\ref{fig:GdMn2O5_unit_cell} panel (a) and the more detailed panel (c) demonstrate how this geometric frustration manifests itself in GdMn$_2$O$_5$.
When the magnetic order sets in, magnetic exchange energy is simultaneously optimized with the elastic energy on each bond.
This results in the contraction of bonds with a mostly antiparallel alignment of spins, and the extension of bonds with more parallel spins, indicated by the orange and blue arrows in Fig.~\ref{fig:GdMn2O5_unit_cell}(b,c), respectively.
\\\\
The simplest form of this behavior can be understood by considering Heisenberg exchange between two spins $i$, $j$, on a dimer.
The exchange coefficient can be written in terms of the hopping $t_{ij}$ and Coulomb repulsion $U$ as: $J(r_i, r_j)\approx \frac{t_{ij}^2}{U}$.
It depends through $t_{ij}$ only on the length of the bond, such that $J(r_i, r_j) = J(r_i - r_j) = J(r)$\footnote{In real materials this process is more complex due to the presence of multiple orbitals, and multiple neighboring ions.}.
The energy $W$ for each bond can then be written, following Ref. \cite{Harris1972}, as:
\begin{equation}
	W_{ij} = J(r)\bm{S}_i \cdot \bm{S}_j + \frac{\kappa \delta r^2}{2r_0},
\end{equation}
with spins $\bm{S}_i$ and $\bm{S}_j$, $\kappa$ the elastic stiffness of the bond, $r_0$ the mean separation between neighboring Mn$^{3+}$ and Mn$^{4+}$ ions in the paramagnetic state, and $\delta r = r - r_0$.
Minimizing the energy of the bond through $\frac{\partial W}{\partial r} = 0$ then leads to the change in bond length $\delta r$ given by:
\begin{equation}
	\delta r = -\frac{\partial J}{\partial r}\frac{r_0}{\kappa}\bm{S}_i \cdot \bm{S}_j,
\end{equation}
when the magnetic order sets in below $T_N$. Thus, AFM bonds ($J > 0$) with antiparallel spins contract ($\delta r < 0$), and bonds with parallel spins extend ($\delta r > 0$).
In the case of $R$Mn$_2$O$_5$, this causes the octahedrally coordinated Mn$^{4+}$ ion to shift towards one of the two neighboring Mn$^{3+}$ pyramids in the Mn$^{3+}$ -- Mn$^{4+}$ -- Mn$^{3+}$ sequences, as demonstrated in Fig.~\ref{fig:GdMn2O5_unit_cell}(b).
As mentioned before, this causes a lowering of the symmetry from P$bam$ to P$_ab2_1a$, and, as the Born effective charges of the Mn$^{3+}$ and Mn$^{4+}$ ions differ, to a nonzero polarization along the $b$-axis~\cite{Khomskii2009}.
It was shown, however, that this ionic displacement is largely compensated when electronic correlation effects are taken into account.
These lead to an additional increase of the electronic charge between the ions, which almost fully cancels the positive contribution to the polarization due to the ionic displacement.
\\\\
There is a second source of polarization in GdMn$_2$O$_5$, also due to the symmetric Heisenberg exchange striction, but this time between the spins of Gd and Mn~\cite{Lee13}.
All the exchanges between Gd and the surrounding Mn ions are again AFM.
A similar train of thought can then be followed as before, causing the bonds with parallel spins to extend and those with antiparallel spins to contract (see Fig.~\ref{fig:GdMn2O5_unit_cell}(c)).
This contribution does not suffer from the same cancellation between ionic displacements and electronic charge due to correlation effects, and leads to the majority of the ferroelectric polarization.

Gd$^{3+}$ is special with respect to the other magnetic rare-earth ions in the $R$Mn$_2$O$_5$ family, because it has a very isotropic electronic configuration (4$f^7$), i.e. there is no unquenched orbital angular momentum and associated anisotropic charge distribution (as discussed profusely in the Rashba Chapter~\ref{ch:Rashba}). This means that the large spin (nominally $S=7/2$) can orient itself freely to optimize the magnetic interactions with its neighboring Mn atoms, without incurring any penalties through the atomic SOC combined with nonzero OAM.
This leads to a high magnetic susceptibility and associated magnetoelectric effect, surpassing the other $R$Mn$_2$O$_5$ compounds both in size and tunability of $P_b$, with a measured variation of up to 5000\,$\mu$ C/m$^2$ when a magnetic field is applied~\cite{Lee13}. 
\\\\
Now that the stage is set, we continue with a description of the puzzling experimental observations that motivated the study in this Chapter.
%Even though the AFM intrachain superexchange interactions dominate over the AFM interchain interactions, there is nonetheless a geometric frustration due to the crystal structure, which can be seen most easily seen from the Mn pentagons surrouding the Gd atoms. This means that all AFM exchanges can not be satisfied at the same time, causing certain Mn bonds between the chains to have energetically unfavorable spin alignment. This leads to the first contribution to the ferroelectric polarization through Heisenberg exchange striction, lengthening bonds that have parallel spins and shortening those that have antiparallel ones.

\section{Experimental methods and results}
\begin{figure}
    \centering
    \IncludeGraphics[width=\textwidth]{fig_exp2.png}
\caption{ \label{fig:GdMn2O5_experiment1} {\bf Experimental measurements of the ferroelectric polarization at 2.3 K.} a) Magnetic field applied at 1$^\circ$ which leads to a two state hysteresis loop. The left panel shows the result of our measurements, whereas the right one shows the previous measurements of Ref.~\cite{Lee13}. This behavior on the right panel is identical to our theoretical results (see Sec.~\ref{sec:GdMn2O5_results_discussion}). b) Magnetic field applied at 9$^\circ$, where the four state hysteresis loop appears. c) Field applied at 15$^\circ$, again leading to a two state hysteresis loop.  
In these plots, we have denoted the four discussed states by the labels 1-4. The arrows and graph color denote the direction of magnetic field-change during the sweep, as indicated by the inset of the left graph of panel (a).}
\end{figure}
\begin{figure}
    \centering
    \IncludeGraphics{exp_plusvsminus.png}
\caption{ \label{fig:GdMn2O5_experiment2} {\bf Angle and temperature dependence of the four state switching.} By comparing panels (a) and (b) we can see that changing the sign of the field angle $\phi_H$ does not influence the four state switching. c) Temperature dependence of the hysteresis loop at the magic angle. Above 4 K (upper panel) the more usual two state hysteresis loop is observed, whereas below 4 K (lower panel) the four state behavior starts to arise. The states, colors and arrows are indicated in the same way as in Fig.~\ref{fig:GdMn2O5_experiment1}.}
\end{figure}

The measurements we present in this Section were performed in the group of A. Pimenov, on single crystal GdMn$_2$O$_5$ samples grown by S.-W. Cheong's group.
Magnetic fields were applied under varying angles $\phi_H$ with respect to the crystalline $a$-axis, and swept up and down while tracking the evolution of $P_b$.
The results for such measurements at 2 K are displayed in Fig.~\ref{fig:GdMn2O5_experiment1}.
Only positive fields were applied, but the behavior is identical for fields with opposite signs, as we will show later in Section~\ref{sec:GdMn2O5_magnetic_configuration}. 
In previous experimental measurements, the magnetic field was only applied along the crystalline $a$-axis, i.e. $\phi_H = 0$~\cite{Lee13}.
\\\\
In the following we will refer to three distinct switching regimes: the low angle, ``magic'' angle, and high angle regime.
They correspond to the values of $\phi_H$ shown in panels (a), (b), and (c) of Fig.~\ref{fig:GdMn2O5_experiment1}, respectively.
Before delving into a detailed analysis of the experiments, we would like to point out that the low angle behavior shown in left side of panel (a) does not coincide with the behavior found in previous experiments in Ref.~\cite{Lee13} on the same sample, shown on the right.
There it was found that when the field is applied along the $a$-axis, a two state switching with a reversal of the polarization is observed, similar to the 1--4 branch in panel (b) of Fig.~\ref{fig:GdMn2O5_experiment1}.
We are not quite sure what leads to this discrepancy between the measurements. It could be related to the poling history of the sample or some domain related behavior.
This discrepancy is not that important in light of the current discussion, but it is nonetheless at odds with our theoretical findings which demonstrate a behavior similar to the previous measurements in Ref.~\cite{Lee13}. 
\\\\
Turning back to the results shown in Fig.~\ref{fig:GdMn2O5_experiment1}, we can observe that the switching behavior changes significantly with $\phi_H$.
In the high angle case, showcased in panel (c), we can observe a two state switching loop, in which $P_b$ does not vary much but a clear jump appears around a field magnitude of 5 T.
This signals a sudden change in the magnetic configuration of the system, since $P_b$ is a direct result of it.
The most peculiar, and completely novel, behavior can be found around the magic angle $\phi_H \sim 9^\circ$ in panel (b) of Fig.~\ref{fig:GdMn2O5_experiment1}.
During the up-down-up-down field sweeps, we find that four different states are visited sequentially in this switching regime, with four different values of $P_b$.
\\\\
At this stage, we would like to draw the attention of the reader to two facts.

First, compared to the usual magnetoelectric switching with one low-field state and one high-field state, here a single up--down cycle of the field reverses the polarization, and correspondingly leads to a different final state.
In order to return the system to its original configuration another up--down cycle is required.

Second, this four state loop is fully deterministic, meaning that when multiple such double cycles are applied, the system tracks close to exactly the same $P_b$ loop every time.
\\\\
If we ignore for a brief moment the low-angle behavior displayed in the left panel of Fig.~\ref{fig:GdMn2O5_experiment1}(a), and replace it with the behavior on the right~\cite{Lee13}, i.e. following the 1--4 branch in panel (b), we can imagine the four state switching as an interpolation between the high and low angle switching regimes.
This is a very important observation and will lead to one of the main results of this work: the topological nature of the magnetoelectric switching in this material.
\\\\
Turning now to the measurements displayed in Fig.~\ref{fig:GdMn2O5_experiment2}, we find that the four state loop is not affected by a sign change of $\phi_H$ (compare panels (a,b)).
From the two panels in (c), displaying measurements at 15 K and 4 K with $\phi_H$ along the magic angle, we can observe that the four state hysteresis loop only appears at low temperatures.
For higher temperatures a more usual two state loop is found, similar to the high angle loop in panel (c) of Fig.~\ref{fig:GdMn2O5_experiment1}.
\\\\
To conclude this Section, we would like to point out that we focus on the overall switching behavior, i.e. we ignore the details that can be found by careful study of the $P_b$ graphs.
For example, in Fig.~\ref{fig:GdMn2O5_experiment1}(b) one can observe three distinct steps that appear around 5 T during the 1$\rightarrow$2 and 3$\rightarrow$4 switching.
These steps are, however, absent at the same field magnitude, when the system is on the 2$\rightarrow$3 and 4$\rightarrow$1 branch.
%to a transition, on an ionic level, to states with higher Gd spin, or it might be related
Their origin might be related to the spins in the Mn chains rotating individually, rather than in unison as we will assume in our model.
Further research is required to solidify this statement, here we rather choose to focus on unraveling the main behavior of the four state loop flanked in $\phi_H$ parameter-space by two more usual two state switching loops.
% This novel four state switching is the focus of this Chapter, and is found to originate from a unidirectional rotational motion of the spins, a sort of microscopic magnetic analogue to the crankshaft in a car, converting the linear back--and--forth variation of the magnetic field into spin rotations.

\section{Theory \label{sec:GdMn2O5_Theory}}
In order to describe the puzzling experimental observations we construct a semi-classical model with eight Gd spins denoting the eight sublattice magnetizations, and two AFM order parameters that describe the Mn chains.
The Gd spins are described by unit vectors $\bm{S}_i, i=1..8$, and we denote the two AFM order parameters as $\bm{L}_\alpha, \alpha=1,2$ (also unit vectors). See Fig~\ref{fig:GdMn2O5_unit_cell}(a) for further details.
Furthermore, the ferroelectric polarization is represented by the slave order parameter $P_b$.
Using a single $\bm{L}_\alpha$ to describe the orientation of all the Mn ions in a chain assumes that their spins are perfectly AFM ordered, i.e. $\bm{S}_i = L, \bm{S}_{i+1} = - \bm{L}$.
This simplification is justified by the large intrachain AFM exchanges, compared with the relatively small exchanges between the two chains~\cite{Souza11}.

A further simplification we adopt here is to confine all spins to the $ab$-plane.
Indeed, it was shown experimentally that the $c$-direction acts as the magnetic hard-axis, and that the magnetic order is repeated along the crystalline $c$-direction~\cite{Lee13}.
This lowers the dimensionality of the problem from 3D to 2D, with a single angle for every Gd spin and Mn chain as the remaining degrees of freedom, thus greatly simplifying the numerical complexity.
Since all spins and AFM order parameters are taken as unit vectors, their sizes are implicitly included in the model parameters.
\\\\
The first step in order to derive the effective Hamiltonian in terms of the above order parameters is to convert the microscopic interactions of the individual Mn spins into the effective interactions of the $\bm{L}_\alpha$.
More specifically, we include two energy contributions due to small spin cantings away from the perfect collinear intrachain spin configuration, as showcased in Fig.~\ref{fig:GdMn2O5_canting}.

\begin{figure*}[h]
    \centering
    \IncludeGraphics[width=\linewidth]{canting}
	\caption{{\bf Energy contributions due to spin canting.} a) The Zeeman contribution due to the weak ferromagnetic moment along the field (H, red arrow), as a result of the spin canting. b) The contribution due to Heisenberg exchange when previously parallel Mn spins are canted towards a more AFM alignment. This is a direct result of the geometric frustration. The collinear configuration is denoted by the black arrows, with the dashed teal arrows showing the orientation due to the slight canting by the angle $\delta \theta$. \label{fig:GdMn2O5_canting}}
\end{figure*}

Starting with the contribution due to the Zeeman energy when a magnetic field $\bm H$ is applied, we can write:
\begin{equation}
	E_Z = -g \mu_B \bm{H} \cdot (\pmb{\sigma}_i + \pmb{\sigma}_{i+1}),
\end{equation}
where $g \approx 2$, $\mu_B$ denotes the Bohr magneton, and $\bm \sigma_i$ and $\bm \sigma_{i+1}$ two neighboring Mn spins inside a chain. 
Obviously, no energy gain is possible for perfectly antiparallel spins since then $(\pmb{\sigma}_i + \pmb{\sigma}_{i+1})=0$.

However, if the chain is oriented perpendicular to the applied field, and both spins cant slightly towards the applied field, a weak ferromagnetic moment is created that will couple to this field (see Fig.~\ref{fig:GdMn2O5_canting}(a)).
To include this contribution, we perform an expansion in the small canting angle $\delta \theta$ away from the collinear configuration:
\begin{align}
	E &= \Jpar \bm \sigma_i \cdot \bm \sigma_{i+1} -g \mu_B \bm{H} \cdot (\pmb{\sigma}_i + \pmb{\sigma}_{i+1})\nonumber\\
	 &\approx \Jpar \cos(2\delta \theta) - g \mu_B H \left[\cos(\theta_L - \theta_H + \delta \theta) + \cos(\theta_L + \pi - \theta_H - \delta \theta)\right]\nonumber\\
	&= \Jpar \left( 1+2\delta\theta^2 \right) - 2 g \mu_B H \sin(\theta_L - \theta_H)\delta\theta \label{eq:GdMn2O5_zeeman_exp},
\end{align}
where $\Jpar$ denotes the intrachain magnetic exchange coefficient, and $\theta_L$ ($\theta_H$) the angle between $L$ ($H$) and the $a$-axis.
Minimizing with respect to $\delta \theta$ then leads to
\begin{align}
	\frac{\partial E}{\partial \delta \theta} = 0 &= 4 \Jpar \delta \theta - 2 g \mu_B H \sin(\theta_L - \theta_H) \\
	&\Leftrightarrow \nonumber\\
	\delta \theta &= \frac{g\mu_B H \sin(\theta_L - \theta_H)}{2 \Jpar}.
\end{align}
Inserting this expression for $\delta \theta$ back into Eq.~\eqref{eq:GdMn2O5_zeeman_exp}, and keeping only the first order terms, we obtain the following expression for the Zeeman contribution through spin canting:
\begin{align}
	E_Z &= -\frac{g^2\mu_B^2 H^2 \sin(\theta_L - \theta_H)^2}{\Jpar} = -\frac{g^2\mu_B^2 H^2 \left(1 - \cos(\theta_L - \theta_H)^2\right)}{\Jpar}\nonumber\\
	&=\frac{g^2\mu_B^2}{\Jpar}\left((\bm{H}\cdot\bm{L})^2 - H^2\right)\label{eq:GdMn2O5_Zeeman}.
\end{align}
This energy gain is maximized when $\bm{L}$ is oriented perpendicular to $\bm{H}$ leading to $\bm L \cdot \bm H = 0$, which is exactly what happens in the well-known spin-flop transition.
If a strong enough magnetic field is applied along the easy-axis of a system with a single AFM order parameter, a sudden flip of the spins perpendicular to the easy-axis will occur as soon as the possible gain from the Zeeman energy \eqref{eq:GdMn2O5_Zeeman} in the flopped state overcomes the lost easy-axis anisotropy energy. This spin-flopped state, with the AFM order perpendicular to $\bm{H}$, is exactly the one displayed in Fig.~\ref{fig:GdMn2O5_canting}(a).
\\\\
An additional energy contribution results from the geometric frustration which forces certain spins in the two chains to be parallel to each other, as shown by the two rightmost arrows in Fig.~\ref{fig:GdMn2O5_canting}(b).
This is very unfavorable for the interchain AFM exchange with coefficient $\Jperp$, again leading to some gained energy if these spins cant slightly towards a more AFM alignment.
\\\\
Adopting a similar strategy as above, this contribution can be derived starting from
\begin{align}
	E_{ic} &= \Jpar (\bm \sigma_{1, i} \cdot \bm \sigma_{1, i+1} + \bm \sigma_{2, i} \cdot \bm \sigma_{2, i+1}) + \Jperp(\bm \sigma_{1, i+1} \cdot \bm \sigma_{2,i+1}) \\
	 &\approx 2 \Jpar \cos(\delta \theta) + \Jperp \left(\cos(\theta_1 + \delta \theta - \theta_2) - \cos(\theta_1 - \theta_2 -\delta \theta)\right),
\end{align}
where $\bm \sigma_{\alpha, i}$ denotes the $i$th spin of chain $\bm L_\alpha$, and $\theta_1$ ($\theta_2$) signifies the angle w.r.t. the $a$-axis of $\bm{L}_1$ ($\bm{L}_2$).
Expanding again to second order leads to:
\begin{equation}
	E_{ic} = 2 \Jpar ( 1+ \delta \theta^2) - 2 \Jperp \sin(\theta_1 - \theta_2)\delta \theta. \label{eq:GdMn2O5_Eic_exp}
\end{equation}
Minimizing this contribution with respect to $\delta \theta$, leads to:
\begin{equation}
	\delta \theta = \frac{\Jperp}{2 \Jpar} \sin(\theta_1 - \theta_2).
\end{equation}
Substituting this expression for $\delta \theta$ into Eq.~\eqref{eq:GdMn2O5_Eic_exp}, and keeping only terms up to first order in $\frac{\Jperp^2}{\Jpar}$ since it is assumed that $\Jperp << \Jpar$, nets us the final expression for this energy contribution:
\begin{equation}
	E_{ic} = -\frac{\Jperp^2}{\Jpar}\sin(\theta_1 - \theta_2)^2 =  \frac{\Jperp^2}{\Jpar}(\cos(\theta_1 - \theta_2) - 1) = \frac{\Jperp^2}{\Jpar}(\bm{L}_1 \cdot \bm{L}_2)^2 - \frac{\Jperp^2}{\Jpar},
\end{equation}
where the last contribution is a constant, merely causing a shift in the energy, and can thus be omitted in our numerical simulations.
The maximum gain in energy ($\frac{\Jperp^2}{\Jpar}$) is achieved when the chains are oriented perpendicular to each other ($\bm L_1 \cdot \bm L_2 = 0$).
\\\\
These two contributions (Zeeman and Heisenberg exchange) compete with each other, and with the easy-axis anisotropy energy
\begin{equation}
	E_{ea} = -K_L\sum_\alpha(\bm{L}_\alpha\cdot \bm{n}_\alpha)^2,
\end{equation}
where $K_L$ denotes the strength of the easy-axis anisotropy, and $\bm n_\alpha$ denote the orientation of the easy axes:
$\bm{n}_1=\left(\cos\theta_n, \sin\theta_n\right)$ and $\bm{n}_2=\left(\cos\theta_n, -\sin\theta_n\right)$ with $\theta_n = \rm{23.4}^\circ$.
These are the fourfold axes of the pyramidally coordinated Mn ions, aligned with the long edges of the cyan chains in Fig.~\ref{fig:GdMn2O5_unit_cell}(a).
\\\\
Bringing everything together leads us to the total contribution of the chains to the effective Hamiltonian:
\begin{equation}
	H_L = \gamma(\bm{L}_1\cdot \bm{L}_2)^2
    +\sum_{\alpha}\chi((\bm{H}\cdot \bm{L}_\alpha)^2-H^2)
    -K_L\sum_\alpha(\bm{L}_\alpha\cdot \bm{n}_\alpha)^2\label{eq:GdMn2O5_hami_1},
\end{equation}
with $\gamma = \frac{\Jperp^2}{\Jpar}$, and $\chi = \frac{g^2\mu_B^2}{\Jpar}$. 
\\\\
The next step is to find the combination of cross-order coupling terms between the Gd spins ($\bm S_i$) and the chains ($\bm L_\alpha$) that transform as the unit representation of the symmetry group of the system.
This combination will then lead to the required invariance of the energy under the applications of all the symmetry operations of the system.
In order to achieve this, we first list the generators of the paramagnetic parent P$bam$ phase:
\begin{align}
	I &: (x, y, z) \rightarrow (-x, -y, -z)\\
	2_z &: (x, y, z) \rightarrow (-x, -y, z)\\
	2_y &: (x, y, z) \rightarrow (\frac{1}{2} - x, \frac{1}{2} + y, z)
\end{align}
$I$ and $2_z$ are the same symmetry operations in the 2D case we are solving.
Next, a doubling of the unit cell is necessary to fit the overall AFM state, leading to an additional symmetry operation for the translation along the $a$-axis $a: (x, y, z) \rightarrow (x + a, y, z)$ (not taking spins into account), and a halving of the $x$-component of the fractional translation $2_y: (x, y, z) \rightarrow (\frac{1}{4} - x, \frac{1}{2}+y, z)$.
In effect, applying these symmetry operations to the degrees of freedom of our model, and bearing in mind the spin flip when transforming the chains between the two halves of the magnetic unit cell, leads to the following transformation table:
\begin{table}[h]
\centering
\begin{tabular}{|l|lllllllllll|}
\cline{1-12}
 & $S_1$ & $S_2$ & $S_3$ & $S_4$ & $S_5$ & $S_6$ & $S_7$ & $S_8$ & $L_1$ & $L_2$ & $P_b$ \\ \cline{1-12}
I & $S_8$ & $S_7$ & $S_6$ & $S_5$ & $S_4$ & $S_3$ & $S_2$ & $S_1$ & -$L_1$ & $L_2$ & -$P_b$ \\ \cline{1-12}
$2_y$ & $S_4$ & $S_3$ & $S_2$ & $S_1$ & $S_8$ & $S_7$ & $S_6$ & $S_5$ & $L_1$ & $L_2$ & $P_b$ \\ \cline{1-12}
a & $S_5$ & $S_6$ & $S_7$ & $S_8$ & $S_1$ & $S_2$ & $S_3$ & $S_4$ & -$L_1$ & -$L_2$ & $P_b$ \\ \cline{1-12}
T & $-S_5$ & $-S_6$ & $-S_7$ & $-S_8$ & $-S_1$ & $-S_2$ & $-S_3$ & $-S_4$ & -$L_1$ & -$L_2$ & $P_b$ \\ \cline{1-12}
\end{tabular}
\caption{\label{tab:GdMn2O5_symm}{\bf Symmetry operations in GdMn$_2$O$_5$.} Transformations of Gd spins ($S_i$), AFM vectors ($\bm L_\alpha$) and polarization ($P_b$) under the symmetry operations of GdMn$_2$O$_5$.}
\end{table}\\\\
We start with the Heisenberg exchange terms between the Gd spins ($\bm{S}_i$) and the Mn chains ($\bm{L}_1$ and $\bm{L}_2$), with the effective exchange constants $v_1$ and $v_2$.
The former (latter) couples each Gd spin with the chain that harbors the closest (furthest) Mn ion. See the orange arrows in Fig.~\ref{fig:GdMn2O5_unit_cell}(a) for a schematic depiction of these exchange paths.
Starting from terms with $\bm{S}_1$ and $\bm{S}_2$, and taking the above table of transformations into account, we can identify the following sets of terms:
\begin{align}
	\bm{S}_1\cdot(v_1 \bm{L}_2 + v_2 \bm{L}_1) \xrightarrow{I} \bm{S_8}\cdot(v_1 \bm{L}_2 - v_2 \bm{L}_1) \xrightarrow{a} \bm{S_4} \cdot (- v_1 \bm{L}_2 + v_2 \bm{L}_1) \xrightarrow{I} \bm{S_5} \cdot (-v_1 \bm{L}_2 - v_2 \bm{L}_1), \nonumber\\
	\bm{S}_2\cdot(v_1 \bm{L}_1 + v_2 \bm{L}_2) \xrightarrow{I} \bm{S_7}\cdot(-v_1 \bm{L}_1 + v_2 \bm{L}_2) \xrightarrow{a} \bm{S_3} \cdot (v_1 \bm{L}_1 - v_2 \bm{L}_2) \xrightarrow{I} \bm{S_6} \cdot (-v_1 \bm{L}_1 - v_2 \bm{L}_2).
\end{align}
The combined sum of them transforms according to the identity representation, leading to the following contribution to the total Hamiltonian:
\begin{align}
    H_{LS} =& (\bm{S}_1 - \bm{S}_5) \cdot (v_1 \bm{L}_2 + v_2 \bm{L}_1) + (\bm{S}_2 - \bm{S}_6) \cdot (v_1 \bm{L}_1 + v_2 \bm{L}_2) + \nonumber \\ &(\bm{S}_3 - \bm{S}_7) \cdot (v_1 \bm{L}_1 - v_2 \bm{L}_2) + (\bm{S}_4 - \bm{S}_8) \cdot (-v_1 \bm{L}_2 + v_2 \bm{L}_1).
\end{align}
A similar process can be applied starting from $P_b \, \bm{S_1}\cdot(\beta_2 \bm{L}_1 + \beta_3 \bm{L}_2)$ and $P_b\, \bm{S_2}\cdot(\beta_2 \bm{L}_1 + \beta_3 \bm{L}_2)$, which signify the symmetric Heisenberg exchange striction contributions to the Hamiltonian. This leads to:
\begin{align}
	H_{P_b}=&-P_b[E_b + \beta_1 (\bm{L}_1\cdot \bm{L}_2)+
    (\bm{S}_1-\bm{S}_5)(\beta_2 \bm{L}_2 + \beta_3 \bm{L}_1) +
    (\bm{S}_2-\bm{S}_6)(\beta_2 \bm{L}_1 + \beta_3 \bm{L}_2) \nonumber\\ 
    &+(\bm{S}_3-\bm{S}_7)(\beta_2 \bm{L}_2 - \beta_3 \bm{L}_1) +
    (\bm{S}_4-\bm{S}_8)(\beta_2 \bm{L}_1 - \beta_3 \bm{L}_2)],
\end{align}
where the facultative interaction of $P_b$ with an external electric field $E_b$ was also included. 
We can identify three final terms that originate purely from the Gd spins:
\begin{equation}
     H_S=\frac{1}{2}(g \mu_B)^2\sum_{i\neq j}\left(\frac{\bm{S}_i\cdot \bm{S}_j}{r_{ij}^3}-3\frac{(\bm{S}_i\cdot \bm{r}_{ij})(\bm{S}_j\cdot \bm{r}_{ij})}{r_{ij}^5}\right) - \sum_i\left( K_S(\bm{N}_i\cdot \bm{S}_i)^2 + g\mu_\mathrm{B} \bm{H} \cdot \bm{S}_i\right). 
\end{equation}
The first describes the magneto-dipolar interaction between Gd spins, which could be relatively large due to the size of the Gd spins (nominally S=7/2) and relative proximity of the neighbors.
In the numerical simulations these interactions were restricted to their five nearest neighbors, including periodic images.
Adding further neighbors did not lead to qualitative differences in the results.
The term with $K_S$ denotes the easy-axis anisotropy for the Gd ions, this time with anisotropy axes $\bm{N}_i$ which are unit vectors having alternating angles $\pm 12^\circ$ with respect to the $a$-axis.
$K_S$ is significantly smaller than $K_L$ due to the isotropic environment and valence configuration of the Gd ions.
The final term denotes the Zeeman energy of the Gd ions in the external magnetic field $\bm{H}$.
\\\\
To conclude this Section, we gather all the terms in our effective Hamiltonian:
\begin{multline}
    \label{eq:GdMn2O5_model}
    H=\gamma(\bm{L}_1\cdot \bm{L}_2)^2 +\sum_{\alpha}\chi((\bm{H}\cdot \bm{L}_\alpha)^2-H^2)\\
    -K_L\sum_\alpha(\bm{L}_\alpha\cdot \bm{n}_\alpha)^2 -\sum_i\left( K_S(\bm{N}_i\cdot \bm S_i)^2+ g\mu_\mathrm{B} \bm{H} \cdot \bm{S}_i\right) \\
    %\sum_{i,j}J_{ij} \s_i\cdot \s_j 
    + \frac{1}{2}(g \mu_B)^2\sum_{i\neq j}\left(\frac{\bm S_i\cdot \bm S_j}{r_{ij}^3}-3\frac{(\bm S_i\cdot \bm{r}_{ij})(\bm S_j\cdot \bm{r}_{ij})}{r_{ij}^5}\right)
     \\+ \sum_{i,\alpha}V_{i\alpha}\bm{S}_i\cdot \bm{L}_\alpha \\
    -P_b[8 \beta_1 (\bm{L}_1\cdot \bm{L}_2)+(\bm{S}_1-\bm{S}_5)(\beta_2 \bm{L}_2 + \beta_3 \bm{L}_1) \\+ (\bm{S}_2-\bm{S}_6)(\beta_2 \bm{L}_1 + \beta_3 \bm{L}_2)
    + (\bm{S}_3-\bm{S}_7)(\beta_2 \bm{L}_2 - \beta_3 \bm{L}_1) \\
    +(\bm{S}_4-\bm{S}_8)(\beta_2 \bm{L}_1 - \beta_3 \bm{L}_2)]
    + P_b^2/2.
\end{multline}

\section{Methods \label{sec:GdMn2O5_methods}}
Before continuing with the results and a discussion of the physics, we comment briefly on the numerical aspects of our simulations used throughout the rest of this Chapter.\\\\
The first question to address is what model parameters to use in conjunction with the Hamiltonian in Eq.~\eqref{eq:GdMn2O5_model}.
This is not particularly straightforward, since our model is phenomenological, and the order parameters and interactions arise from a combination of the microscopic ones.
One could, instead, formulate a model in terms of all the microscopic degrees of freedom, i.e. all the spins of both Gd and Mn ions, which would not only lead to a more computationally demanding model, the increased complexity also makes developing an intuitive understanding much harder.
That means that calculating the coefficients separately from first-principles is very hard, if not impossible. Even in the case of a fully microscopic spin model, it is not well-known in general how to acquire a correct set of exchange parameters from DFT.
We thus opted to rather make physically inspired initial guesses for the model parameters, after which we further refined these in order to best reproduce the experimental behavior.
\\\\
We know, for example, that the Gd -- Mn magnetic exchange parameter towards the closest chain is larger than towards the other ($v_1>v_2$), and that the order of magnitude for this energy contribution is a few meV.
Furthermore, as we mentioned a few times already, the single-ion anisotropy energy for Gd is expected to be small due to the isotropic environment and valence configuration with completely quenched orbital angular momentum.
Instead, the single-ion anisotropy of the Mn ions and, by proxy, the chains, is again on the order of a few meV.
Lastly, due to the large intrachain $\Jpar$ and small interchain $\Jperp$ magnetic exchanges, we know that $\gamma = \frac{\Jperp^2}{\Jpar}$ and $\chi = \frac{\Jpar}{g^2\mu_B^2}$ are very small.
\\\\
Taking all these considerations into account, we found that the following model parameters reproduce the observations of the experiments well:  
$v_1 = 7.9$~meV, $v_2 = 0.15$~meV, $K_L = 1.1$~meV, $K_S = 0.09$~meV, $\gamma = 0.05$~meV, $\chi=0.01$~meV$^{-1}$.
The parameters for the exchange striction were then also chosen to fit the experimental hysteresis loop as well as possible:
${\beta_1 = 0.06\,\mu}$C/cm$^2$, $\beta_2 = 0.06\:\mu$C/cm$^2$, $\beta_3 = 0.04\:\mu$C/cm$^2$.
\\\\
However, these parameters are by no means a requirement for the overarching behavior to appear in our model. As we will show in greater detail in the Section discussing the topological nature of the switching behavior~\ref{sec:GdMn2O5_topology}, a great deal of freedom exists in choosing these parameters, if the only requirement is to reproduce the three switching regimes.
This lies at the heart of our claim that this effect might exist in other materials, since neither the model itself nor its parameters depend greatly on the microscopic details of GdMn$_2$O$_5$. 
\\\\
The next question is how to simulate the experimental set-up, which is, in contrast to the question about the model parameters, much easier to answer.
Since the behavior only shows up at temperatures below $\sim$ 4 K, is remarkably deterministic, and is a result of quasi-statically applied magnetic fields, we simulated it as a series of simple minimization problems.
This entails taking one of the degenerate starting configurations, increasing the field by a small amount, minimizing the energy, applying a further increased field, and so on, thus tracking the local minimum at all steps.
It is quite remarkable that performing this relatively simple process, purely based on optimizing the energetics of the system, leads to a faithful reproduction of the observed behavior, which is another indication of the topological nature of the switching behavior.
As we will show more explicitly below, it is sort of an extreme variant of the behavior of Thouless charge pumps, and especially of their recent realization in ultra-cold gases \cite{Rice82,Thouless1982,Thouless83,Lohse16,Nakajima16, Atala13}.
It is extreme in the sense that it requires no tunneling whatsoever, which forms the core reason behind the fully deterministic behavior.
\\\\

We now turn to a discussion of the results obtained from these simulations of the effective spin Hamiltonian Eq.~\eqref{eq:GdMn2O5_model}.

\section{Results and discussion \label{sec:GdMn2O5_results_discussion}}
\begin{figure}
    \IncludeGraphics{Pb_3panels}
    \caption{\label{fig:GdMn2O5_theory}{\bf Simulation of the angle dependent magnetoelectric switching.}
    The evolution of ferroelectric polarization $P_b$ during the magnetic field sweep cycle is depicted for the low (a), magic (b), and high (c) angle regimes. 
   In each panel, the four states and field cycle progression are marked in the same way as in Fig~\ref{fig:GdMn2O5_experiment1}. The four states hysteresis loop is observed for the field at the magic orientation in panel (b). 
    The insets indicate the sequence of states visited during the cycle for each regime, and winding numbers (see Section~\ref{sec:GdMn2O5_topology} for further details on the latter).
}
\end{figure}
The magnetoelectric switching regimes of $P_b$ obtained from the simulations, are showcased in Fig.~\ref{fig:GdMn2O5_theory}, displaying the same three regimes as the experimental results in Figure~\ref{fig:GdMn2O5_experiment1}.
Comparing the two figures demonstrates the close agreement between the two.\footnote{We compare the low angle regime with the right hand side of Fig.~\ref{fig:GdMn2O5_experiment1}(a).}.
The insets in each panel of Fig.~\ref{fig:GdMn2O5_theory} depict schematically the sequence of states that is visited by the system during the field sweeps.

As mentioned before, it appears that the magic angle regime (Fig.~\ref{fig:GdMn2O5_theory}(b)) is an interpolation between the low and high angle regimes.
At the start, it follows the high angle behavior moving 1$\rightarrow$2, mimicking the low angle behavior then results in a reversal of the polarization on the 2$\rightarrow$3 branch, followed by an inversion symmetry partner of the high angle regime moving 3$\rightarrow$4 and finally another low angle-like reversal of the polarization, bringing the system from state 4 back to the initial state 1. 
\\\\
In order to gain a deeper understanding of this peculiar behavior, we focus first on the energetics of the model, as calculated by the simulations.
The intricacies of the energetics are ultimately what results in the deterministic, unidirectional, switching of the system.

\subsection{Energetics}
Before continuing, let us take a moment to recall some of the symmetries of the system, whose transformation properties were listed in Tab.~\ref{tab:GdMn2O5_symm} during the construction of the Hamiltonian.
We focus on how the transformations due to inversion ($I$) and time-reversal ($T$) symmetry relate the angles of $\bm L_1$ and $\bm L_2$ ($\phi_{\bm L_1}$ and $\phi_{\bm L_2}$).
The energy surfaces in terms of the angles are depicted in Fig.~\ref{fig:GdMn2O5_heatmap}, for a varying field with strength $|H|$ and angle $\phi_H = +10^\circ$.
We observe that there are four degenerate energy minima, a result from the breaking of both $T$ and I symmetries in the low temperature phase.
The angles $\phi_{L_1}$ and $\phi_{L_2}$, that describe in part the state of the system, can be transformed into each other through the relations:
\begin{align}
	I:\qquad &(\phi_{L_1}, \phi_{L_2}) \rightarrow (\phi_{L_1}+\pi, \phi_{L_2}),\\
	T:\qquad &(\phi_{L_1}, \phi_{L_2})\rightarrow(\phi_{L_1}+\pi, \phi_{L_2}+\pi).
\end{align}
These symmetry operations are indicated by the black arrows in the top left and bottom right panels of Fig.~\ref{fig:GdMn2O5_heatmap}.
\begin{figure*}[h!]
	\centering
	\IncludeGraphics{field_heatmap1}
	\caption{{\bf Energy surfaces in terms of $(\phi_{L_1}, \phi_{L_2})$ for $\phi_H =+10^\circ$.} The shaded dots denote the four degenerate minima, related by time-reversal ($T$) and inversion ($I$) symmetry operations indicated by the black arrows. The full white dot corresponds to the example situation discussed in the main text. An indication of its trajectory during a double up--down field sweep is given by the shaded lines.\label{fig:GdMn2O5_heatmap}}
\end{figure*}
\\\\
When the strength of the magnetic field increases, we see that two long vertical ``valleys'' appear along the $\phi_{L_1}$-direction of the energy surface, separated by $\pi$ along $\phi_{L_2}$.
We focus on the case where the initial state of the system corresponds to the top left minimum, indicated by the bright white dot in the top left panel, and a single up--down field sweep is applied.
Following its trajectory, indicated by the shaded white lines, we find that the system first flows from the original minimum to the one that is related by inversion symmetry.
This has rotated $\phi_{L_1}$ by $\pi$, while leaving $\phi_{L_2}$ unchanged.
Through the $\bm L_1 \cdot \bm L_2$ part of the exchange striction, this causes the reversal of $P_b$, which is consistent with the inversion symmetry operation.
The process we have described here corresponds to the first up--down cycle of the $P_b$ plot of Fig.~\ref{fig:GdMn2O5_theory}(b), i.e. the one that leads to the 1$\rightarrow$2$\rightarrow$3 branch.

As it turns out, when the field is swept up and down a second time, the state progresses through the valley in the same direction, i.e. downwards through the edge at the bottom of the window, reappearing at the top, and finally landing in the original top left minimum (see Fig.~\ref{fig:GdMn2O5_heatmap}).
This corresponds to the 3$\rightarrow$4$\rightarrow$1 branch of Fig.~\ref{fig:GdMn2O5_theory}(b).
\\\\
The sequence of states visited during this double up--down cycle of the field at $\phi_H = 10^\circ$, constitutes half of the possible configurations of the system (two low field and two high field states).
The other half is related to the first by time-reversal symmetry as indicated by the diagonal black arrow in the top left and bottom right panels of Fig.~\ref{fig:GdMn2O5_heatmap}.
A similar trajectory through this valley on the right hand side of the energy surface would be followed if the initial state was in one of the two zero field minima it harbors. 
We can thus conclude that the up--down cycling of the magnetic field at $\phi_H=10^\circ$ does not allow for a transition between the two valleys, and $\phi_{L_2}$ changes very little during the cycling process.
\\\\
From these considerations, it seems that no such unidirectional trajectory is followed in the two state regimes (Fig.\ref{fig:GdMn2O5_theory}(a, c)) at low or high field angle $\phi_H$.
This is rather puzzling since one would imagine that the minima behave in a similar way as in Fig.~\ref{fig:GdMn2O5_heatmap}, since they are required to obey the same symmetries.

In fact, they do.
\\\\
However, and this is really the crux of the matter, the barriers between the minima do not. As it turns out, there are no symmetries that relate the barriers that flank a minimum from either side, allowing them to change asymmetrically.
From our observations, it is the field angle $\phi_H$ that influences these asymmetric barriers, ultimately resulting in the three different switching regimes.
\\\\
We thus turn to a more careful investigation of the barriers, first by studying the results of Nudged Elastic Band simulations, displayed in Fig.~\ref{fig:GdMn2O5_neb}, followed by a simple theoretical argument.
\\\\
\begin{figure}[h]
    \IncludeGraphics{neb}
    \caption{\label{fig:GdMn2O5_neb}{\bf Nudged Elastic Bands calculation.}
    a) Evolution of transition barriers between states 1, 2, 3, 4 as the magnetic field is swept through the hysteresis region at $\phi_H = 10^\circ$. The plots are shifted vertically, and the model parameters were slightly altered for clarity which increases the width of the hysteresis region. The curve colors encode the corresponding magnetic field strength. The blue circles and arrows show the trajectory of the energy minimum during the field sweeps.
    b) Zoom of the corresponding dashed red box in panel (a), showing the asymmetric evolution of the barrier 12 between states 2 and 1, and 23 between states 2 and 3, around the critical field $H^\ast$ where the barriers are of equal height. The dashed black curve shows an example of the asymmetric barrier evolution discussed in the main text.
    }
\end{figure}
%
The Nudged Elastic Band calculations are a way to track how the low points of the valley in Fig.~\ref{fig:GdMn2O5_heatmap} change for different field strengths.
Similar to the previous discussion, we track the evolution of the system starting in state 1, indicated at the far left of Fig.~\ref{fig:GdMn2O5_neb}(a).
In the following we use {\it ij} to denote the energy barrier between states i and j.
\\\\
As the field increases (color change and vertical shift) the local minimum around state 1 becomes meta-stable when the barrier 12 between state 1 and 2 vanishes, moving the system towards state 2.
Notice that the barrier between 14 is still present at that point.
When the field is subsequently lowered, the barrier 23 lowers faster than 12, causing the system to progress to state 3.
A similar process then brings state 3$\rightarrow$4$\rightarrow$1 during the next up--down field sweep, since the barriers 34 and 12  (14 and 23) are related by the inversion transformation and  $E_{34} = E_{12}$ ($E_{41} = E_{23}$) (see the effect of {\it I} in Fig.~\ref{fig:GdMn2O5_heatmap} for a visual confirmation of this statement).
From this analysis it is clear that indeed the barriers evolve asymmetrically when the field changes.
This is not surprising seen as the states at the top of the barriers\footnote{They are an interpolation between the states on either side of the barrier.} that flank a given minimum are in no way related by symmetry.

Interestingly, this evolution of the potential energy surface is equivalent to that of a Thouless charge pump, in particular, the one induced by circular motion in the two-dimensional parameter space of the Rice-Mele model~\cite{Rice82} recently realized in ultra-cold gases \cite{Lohse16,Nakajima16,Atala13}.
\\\\
Combining the demonstration of the asymmetric evolution of the barriers in Fig.~\ref{fig:GdMn2O5_neb}, with the earlier discussion on the energy surfaces shown in Fig.~\ref{fig:GdMn2O5_heatmap}, leads us to the following conclusion, visualized in Fig.~\ref{fig:GdMn2O5_trajectories}.
For a system starting at state 1, if the field is applied at a low angle, the barrier between states 1 and 4 is always lower than the one between states 1 and 2, leading to a 1$\rightarrow$4$\rightarrow$1 sequence as in Fig.~\ref{fig:GdMn2O5_theory}(a) and \ref{fig:GdMn2O5_trajectories}(a).
Conversely, when the field is applied at a high angle, the barrier towards state 2 is always lower than the one towards state 4, leading to the 1$\rightarrow$2$\rightarrow$1 toggling shown in Fig.~\ref{fig:GdMn2O5_theory}(c) and \ref{fig:GdMn2O5_trajectories}(c).
There then has to exist a crossover angle where a combination of the two appears, leading in this case to the unidirectional cycling between 1$\rightarrow$2$\rightarrow$3$\rightarrow$4 as depicted in Figs.~\ref{fig:GdMn2O5_theory}(b),~\ref{fig:GdMn2O5_trajectories}(b), and more detailed in Figs.~\ref{fig:GdMn2O5_heatmap}, and \ref{fig:GdMn2O5_neb}(a).
\begin{figure}
    \IncludeGraphics{heatmaps_trajectories}
    \caption{\label{fig:GdMn2O5_trajectories}{\bf Angle dependence of the trajectory through $(\phi_{\rm L_1},\phi_{\rm L_2})$ space.}
    The trajectories of the system through $(\phi_{\rm L_1},\phi_{\rm L_2})$ space during the field sweep cycle are displayed in white for the low, magic and high angle regimes in panels (a),(b) and (c), respectively. The background color maps display the energy landscape at a field strength chosen to highlight the differences between the three regimes (see the black box for a demonstration of the different barrier heights). 
}
\end{figure}
\\\\
%
To hint at the origin of the asymmetric barrier evolution from a theoretical point of view, we can perform a simple Taylor expansion for the barrier energies 12, 23 at a field strength $H^*$ when $E_{12} = E_{23}$, as depicted in Fig.~\ref{fig:GdMn2O5_neb}(b).
This can be written as,
\begin{equation}
	E(H) = E(H^*) + \left.\frac{\partial E}{\partial H}\right|_{H=H^*}(H - H^*).
\end{equation}
Filling in $\frac{\partial E}{\partial H} = -M$, and subtracting the expressions for both barriers, we find:
\begin{equation}
	E_{12}(H) - E_{23}(H) = (M_{23} - M_{12})(H - H^*),
\end{equation}
where $M_{ij}$ denotes the value of the total magnetization for the state at barrier {\it ij}.
This suggests that in the case of $\phi_H=10^\circ$ we have been discussing so far, $M_{23} < M_{12}$, which is confirmed by our simulations.
Indeed, starting at state 2, when $H<H^*$ as the field decreases, this leads to $E_{23} < E_{12}$ causing the system to move from state 2 to state 3.

\subsection{Magnetic Configuration \label{sec:GdMn2O5_magnetic_configuration}}
\begin{figure}[h!]
    \centering
    \IncludeGraphics{4configs.png}
    \caption{\label{fig:GdMn2O5_spin_configs}{\bf Magnetic configurations at $\phi_H =  10^\circ$.} The configurations corresponding to the four states are labeled by the numbers in the top left corner of each panel. Gd ions are displayed in green, Mn in purple. The cyan lines highlight the orientation of the chains. A Mn ion of chain $L_1$ and neighboring Gd ion are highlighted by the red ellipse to demonstrate the 360$^\circ$ rotation in 90$^\circ$ increments.  }
    \label{fig:GdMn2O5_4configs}
\end{figure}
Now that we have a firm grasp of the energetics of the problem, we turn to an investigation of the behavior of the spins that results from it.
Again, we focus first on the most interesting situation of the magic angle regime at $\phi_H=10^\circ$.
The magnetic configurations for the four states that are sequentially visited are shown in Fig.~\ref{fig:GdMn2O5_4configs}.
In the low-field states 1 and 3, Mn spins align closely with the anisotropy axes of the two chains.
The Gd spins (green) align in general largely antiferromagnetically with the closest Mn ion (purple) of the chain that they are coupled strongest to ($v_1$ in Fig.~\ref{fig:GdMn2O5_unit_cell}(a)).
This causes a roughly left left right right sequence of the Gd spins along the $a$-axis at low field. 

In the high-field states 2 and 4, Mn spins are nearly orthogonal to the magnetic field, in order to maximize the gain on Zeeman energy (see Eq.~\eqref{eq:GdMn2O5_Zeeman}).
The Gd spins in this case are again influenced mostly by the antiferromagnetic exchange with the nearest Mn ion, but they are tilted towards the field due to the Zeeman interaction.
The higher the strength of the applied field, the more will the Gd spins align with it.
\\\\
As could already be deduced from our earlier discussion on the trajectory through the ($\phi_{L_1}$, $\phi_{L_2}$) space (Fig.~\ref{fig:GdMn2O5_heatmap}), we can observe that the spins associated with $\bm L_1$ perform a unidirectional rotation during the up--down field sweeps.
The Gd spins that are coupled strongest to this chain through $v_1$ perform a similar rotational motion, but with less well-defined increments.
% The spins of the other chain, $\bm L_2$ seem to only toggle between two states, and a similar behavior can be observed for the Gd spins coupled most strongly to it.
Indeed, focusing on the highlighted spins in Fig.~\ref{fig:GdMn2O5_4configs}, we see that the chains rotate with increments of around 90$^\circ$ between the states, performing a full 360$^\circ$ rotation by the time they arrive back at the original configuration.
\begin{figure}
	\IncludeGraphics{spin_configs}
	\caption{{\bf Spin configurations for different field angles and values.} The green arrows denote the AFM order parameter orientations during the field sweep (a) where the color gradients (red to blue) in panels (b-f) correspond to the field value of $\bm{H}$ in panel (a). The microscopic spin configuration of the cycle in panel (c) is detailed in the right panel surrounded by the red square. Spin configurations (1, 2, 3, 4) are labeled as in Fig.~\ref{fig:GdMn2O5_theory}(b). The full rotation is performed by the chain that is most parallel to the direction of the applied field. \label{fig:GdMn2O5_regimes}}  
\end{figure}
This peculiar ``crankshaft''-like behavior is a direct result of the evolution of the energy minima and barriers as discussed in the previous Section.
We use this crankshaft analogy because the material seemingly converts the linear up--down motion of the magnetic field (the ``piston'') into the circular motion performed by the spins (the ``driveshaft'').
\\\\
This brings us to the final remark we wish to make on the motion of the spins.
By applying the field at a negative magic angle $\phi_H = -10^\circ$, we find that $\bm L_2$ now performs the full cycle rotation, along with the Gd spins that it couples strongest with, leading to the same four state switching loop as for $\phi_H = 10^\circ$ (compare panels (a,b) in Fig.~\ref{fig:GdMn2O5_experiment2}).
This behavior follows from another symmetry operation that is present in the system: the $\tilde{2}_x$ crystal symmetry combined with a translation by $a$, $S_a$, under which $(L_1^x,L_1^y) \rightarrow (L_2^x,-L_2^y)$.
In this case, horizontal valleys appear in the potential energy landscape instead of the vertical ones in Figs.~\ref{fig:GdMn2O5_theory}(d-f) and ~\ref{fig:GdMn2O5_heatmap}.
Accordingly, $\bm{L}_2$ at this negative magic angle rotates in the opposite direction compared to  $\bm{L}_1$ at $\phi_{\rm H} = +10^\circ$.
The rotation direction is unchanged under the magnetic field reversal ($\bm{L}_{1,2}$ is invariant under $T$ combined with $S_a$, whereas $\bm{H}$ changes sign), and under the combined reversal of $\bm{L}_{1}$ and $\bm{L}_{2}$.
The left panels of Figure~\ref{fig:GdMn2O5_regimes} summarizes all the switching regimes found in GdMn$_2$O$_5$.
Notice how all field cycling procedures depicted in panel (a) lead to the same spin behavior.
\\\\
%
Since the ferroelectric polarization $P_b$ is a direct result of the magnetic configuration, we briefly comment on how these different switching behaviors for the spin are translated in to the plots of the polarization in Fig.~\ref{fig:GdMn2O5_theory} and Fig.~\ref{fig:GdMn2O5_experiment1}.
Most of the evolution of $P_b$ can be understood from the $\bm L_1 \cdot \bm L_2$ part. The contribution arising from the Gd--Mn exchange striction behaves similarly due to strong coupling between them ($v_1$), with an additional superposed contribution due to the slight rotations that the Gd spins perform away from the switching fields.
At $\phi_{\rm H} = \pm 20^\circ$, both N\'eel vectors $\bm L_\alpha$ toggle between two directions in such a way that the angle between them and, hence, the ferroelectric polarization changes very little (Figs.~\ref{fig:GdMn2O5_regimes}(b,f),~\ref{fig:GdMn2O5_experiment1}(c), and~\ref{fig:GdMn2O5_theory}(c)). 
On the other hand, at $\phi_{H}=0^\circ$, $\bm{L}_1$ and  $\bm{L}_2$ tilt in opposite directions. The resulting large variation of the angle between these two vectors gives rise to the two state switching with the polarization reversal, as shown in Figs.~\ref{fig:GdMn2O5_regimes}(d),~\ref{fig:GdMn2O5_experiment1}(a), and ~\ref{fig:GdMn2O5_theory}(a). This suggests that the small-amplitude relative rotation of $\bm{L}_1$ and $\bm{L}_2$ is an electromagnon mode that could be excited by oscillating $H_a$ or $E_b$.
On the boundary between the two extremes one of the $\bm L_\alpha$ toggles while the other performs the full 360$^\circ$ rotation, leading to the four state polarization loops.
%
%
\subsection{Topology \label{sec:GdMn2O5_topology}}
We have hinted a couple of times in this Chapter at the fact that the switching behavior carries some notion of topology with it.
We will sharpen our previous statements in this Section and comment on the generality and robustness of the observed behavior.
\\\\
Comparing the trajectories (white lines in Fig.~\ref{fig:GdMn2O5_theory}(d-f) and Fig.~\ref{fig:GdMn2O5_heatmap}) that describe the field evolution of the state, we see that it is confined to one of the vertical valleys, as discussed previously.
This is true for all regimes. When $\phi_H = +10^\circ$, $\phi_{L_1}$ varies strongest, whereas for $\phi_H = -10^\circ$, $\phi_{L_2}$ varies the most, while the system as a whole remains inside the valley that hosts the original state, in both cases.

In the two state regimes (Fig.~\ref{fig:GdMn2O5_theory}(d,f)), the system remains in the neighborhood of the starting point, with the trajectory contractible to a single point. 
In the four state regime in Fig.~\ref{fig:GdMn2O5_theory}(e), as we have seen, the system progresses through the entire valley in a unidirectional sense, connecting the top and bottom edges, with $\bm{L}_1$ rotating a full $360^\circ$.

In this case, the path can not be fully contracted in the same way which highlights its {\em  topologically distinct} nature compared to the other two regimes.
Indeed, for such trajectories in the two-dimensional $(\phi_{\rm L1},\phi_{\rm L2})$ space with a torus topology, we can define a winding number $Q$ as:
\begin{equation}
Q=\frac{1}{2\pi}\int_0^{t_0} dt (L_1^x\partial_t L_1^y - L_1^y \partial_t L_1^x) - (L_2^x\partial_t L_2^y - L_2^y \partial_t L_2^x),
\end{equation}
where the integral is taken over the time interval, $t_0$, during which the magnetic field is ramped up and down twice and the system is returned to its initial state.
In the two state switching regimes, $Q  = 0$, whereas for the four state switching, $Q = 1$.
This means that as long as the low and high angle regimes are present in a material (Fig~\ref{fig:GdMn2O5_theory} (d,f)), there will always exist a boundary region near the magic angle (Fig~\ref{fig:GdMn2O5_theory}(e)), interpolating between the two, and leading to the circular four state hysteresis.
\\\\
We finish this Section by demonstrating the generality of this behavior that results from its topological nature.

The size and position of the $\phi_H$ interval for which the four state regime appears, depends on the details of the used parameters, but similarly to other topological boundaries (e.g. magnetic domain walls, topologically protected edge states in topological insulators), it can not be destroyed when the neighboring ``domains'' are present (high and low angle switching regimes).
The influence of varying a single model parameter is demonstrated in Fig.~\ref{fig:GdMn2O5_windingvsparam}, where the blue and red regions correspond to the angles $\phi_H$ where the low and high angle regimes appear, respectively.
Indeed, we see that for many parameters the four state region (displayed in grey) exists as the boundary between the regions of the two state regimes.
One can also observe that the influence of some parameters is greater than others. For instance, taking $v_1=0.7$ meV dramatically increases the width of the four state switching region to the interval of [5.2$^\circ$, 17.6$^\circ$] for $\phi_H$.
However, even at very high values of $v_1$ does the four state switching appear.
A small variation to $K_L$, the strength of the Mn single-ion anisotropy, on the other hand, leads to a significant change to the characteristics of the topologically protected region.
This is not surprising, since the behavior of the Mn chains is very similar to that of the usual spin-flop transition, which crucially depends on the easy-axis anisotropy. This latter point will be discussed further in the next Section.
\begin{figure}
	\IncludeGraphics{winding_modelparam.png}
	\caption{\label{fig:GdMn2O5_windingvsparam} {\bf Magic Angle region.} The panels demonstrate the influence of selected model parameters on the magic angle region. In each panel only the parameter labeled on the vertical axis is varied, whereas the others are kept at the values reported in the Methods Section \ref{sec:GdMn2O5_methods}. All parameters are reported in units of meV. The blue and red regions denote the angles $\phi_H$ for which the low angle and high angle switching regimes appear, respectively. The grey boundary region is where the magic angle switching occurs, characterized by a winding number of 1, and is topologically protected by the neighboring regimes.}
\end{figure}
\\\\
We have so far given a detailed description of the observed behavior, experimentally and from the simulations of our effective model.
While the model reproduces the experiments remarkably well, and we have found that a combination of symmetries and energetics lies at the core of the peculiar switching behavior, one may wonder if this can be rationalized further.
In attempt to do just this, we proceed in the following Section with some intuitive considerations of the behavior.

\subsection{Intuition}
First of all, we would like to point out the similarity of the behavior of $\bm L_1$ and $\bm L_2$ with the well-known spin-flop transition in antiferromagnets.
As mentioned before around Eq.~\eqref{eq:GdMn2O5_Zeeman}, when a magnetic field is applied along the easy-axis of an antiferromagnetic material, the antiferromagnetic order will flip perpendicular to it when the field grows.
This occurs when the Zeeman energy that can be gained through canting (see Eq.~\eqref{eq:GdMn2O5_Zeeman}) outweighs the penalty incurred from the misalignment with the easy axis.

The sudden flip is a result of a similar flattening of the energy potential as what happens in our case at the switching field. A visual representation of this flattening can be found in the energy surface displayed in the panel for a field magnitude $|H| = 4.33$ in Fig.~\ref{fig:GdMn2O5_heatmap}, where the valley has an almost uniform purple color.
In such flat potentials, a small imbalance to one direction can lead to a big movement of the order parameter, which is exactly what leads to the sudden reorientation of the spins in a spin-flop transitions.
In our case, a clear signature of these sudden variations is found in the jumps of $P_b$ in Fig.~\ref{fig:GdMn2O5_theory}(a-c) around the aforementioned field of $\sim$ 4 T.
The remarkable difference of the behavior described here, compared to the vanilla spin-flop transition, is that a well defined flop direction is preferred. In spin-flops it makes no difference whether the system flops by $+90^\circ$ or $-90^\circ$. Here it does, and the ``flop direction'' of $\bm L_1$ or $\bm L_2$ is always the same.
\\\\
While further microscopic studies are needed to completely unravel the reason behind this, we suggest that this coaxing of the $\bm L$ is due to the exchange interaction with the Gd spins. We attempt to describe the idea by following the evolution of the two highlighted spins in Fig.~\ref{fig:GdMn2O5_4configs}.

When the field is ramped up, the long Gd spin (S=7/2) orients itself to it, while the chain $\bm L_1$ remains relatively strongly pinned because of its high anisotropy.
Since the field is applied at an angle smaller than the $23.4^\circ$ angle of the $\bm L_1$ easy axis, the force applied by the Gd spin to the chain pushes it towards one of the two flop directions.

When the chain then eventually flops with an 90$^\circ$ increment, the Gd spin reorients as to optimize the exchange with the chain.
This leads to an alignment of the Gd spin that was originally at a positive relative angle w.r.t. the field ($\phi_{Gd}>10^\circ$), to now be at a negative relative angle ($\phi_{Gd}<10^\circ$).
When the field subsequently decreases, the Gd rotates further in the same direction, towards negative angles, thus pulling the Mn chains towards one of the flop directions, leading to another 90$^\circ$ rotation (this time to align again with the easy axis anisotropy).

%
% \begin{figure}[h]
% 	\begin{subfigure}{\textwidth}
%     \IncludeGraphics{energy_contributions_neb}
% 	\end{subfigure}
%     % \IncludeGraphics[width=\linewidth]{}
%     %\includegraphics[width=\linewidth]{fig/L1L2_heatmap.png}
%     \caption{\label{fig:GdMn2O5_neb}{\bf Energy evolution.}
%     a) Evolution of transition barriers between states 1, 2, 3, 4 as the magnetic field at 10$^\circ$ to the $a$-axis is swept through the hysteresis region. The plots are shifted vertically, and magnetodipolar interactions were enhanced by a factor of 5.3 for clarity. This latter increases the width of the hysteresis region. The curve colors encode the corresponding magnetic field strength. The blue circles and arrows show the trajectory of the energy minimum due to field sweeps.
%     b) The red square and corresponding schematic on the right shows the asymmetric evolution of the barrier from state 2 to 1, and from 2 to 3 around the critical field $H^\ast$ where the barriers are of equal height.
%     c) The different contributions to the total energy. 
%     Coordinated changes of the state energies and barrier asymmetry with magnetic field enable the topological behavior.
%     }
% \end{figure}
We hope that this intuitive picture shines some light on what might be happening microscopically to cause the behavior, although we concede the claim that this is a complete microscopic explanation. We will give an additional demonstration of this intuitive argument in the context of a simplified model, derived in the next Section.

\section{Simplified Model}
Having modeled the topologically protected switching in  GdMn$_2$O$_5$ with all its complexity, one may wonder what the minimal requirements are to have a similar behavior where the spins rotate 360$^\circ$ while the applied field only oscillates along a single axis.
It is clear from the spin configurations in Fig.~\ref{fig:GdMn2O5_spin_configs}, and from previous considerations, that the chain with Mn moments most parallel to the applied field does the full rotation, while the other chain merely toggles around its starting orientation. As mentioned before, the Gd spins mostly follow the behavior of the chain they are most strongly coupled to. This warrants an attempt to reproduced the behavior of the rotating spins using only a single Mn chain with Gd spins, coupled to it via $v_1$. 
In the particular case where the magic angle is along $\phi_H = +10^\circ$, we therefore keep $L_1$, $S_2$, $S_3$, $S_6$ and $S_7$ as the remaining variables in the model.
Furthermore, we neglect the easy axis anisotropy of Gd spins because of its small contribution due to the isotropic environment of the Gd spins.
This leaves us with the following Hamiltonian, combining two parts, one with the dipolar terms $H_{dip}$ and another with all the other terms, $H'$:
\begin{align}
	\label{eq:GdMn2O5_simple_model}
	H &= H' + H_{dip} \\
	H' &= v_1(\bm{S}_2 + \bm{S}_3 - (\bm{S}_6 + \bm{S}_7))\cdot\bm{L}_1 \nonumber\\
	&- g \mu_B (\bm{S}_2 + \bm{S}_3 + \bm{S}_6 + \bm{S}_7) \cdot \bm{H} \nonumber\\
	&+ K_L (\bm{L}_1 \cdot \bm{n})^2 \nonumber\\
	H_{dip} &= \frac{1}{2}(g \mu_B)^2\sum_{i\neq j}\left(\frac{\bm{S}_i\cdot \bm{S}_j}{r_{ij}^
3}-3\frac{(\bm{S}_i\cdot \bm{r}_{ij})(\bm{S}_j\cdot \bm{r}_{ij})}{r_{ij}^5}\right)\nonumber.
\end{align}
Due to the symmetries of this simplified model and the geometry of the material we find that $S_2 = S_3$ and $S_6 = S_7$, reducing the model to two copies of a single Gd spin in the first half of the magnetic unit cell ($S_3$), one in the second half of the unit cell ($S_6$), and the chain inbetween ($L_1$) (see the red box in Fig.~\ref{fig:GdMn2O5_simple_model}).
This leads us to the equations:
\begin{align}
	H' &= 2v_1(\bm{S}_3 - \bm{S}_6)\cdot\bm{L}_1 - 2g \mu_B (\bm{S}_3 + \bm{S}_6) 
\cdot \bm{H} \\
	&+ K_L (\bm{L}_1 \cdot \bm{n})^2 \nonumber\\
	H_{dip} &= (g \mu_B)^2\left(\frac{\bm{S}_3\cdot \bm{S}_6}{r_{36}^3}-3\frac{(\bm{S}_3\cdot \bm{r}_{36})(\bm{S}_6\cdot \bm{r}_{36})}{r_{36}^5}\right)\nonumber,
\end{align}
as a minimal model that still demonstrates the crankshaft-like behavior.

This minimal model embodies the intuitive explanation that we laid out in the previous Section, relying on the interaction between the two Gd spins and the magnetic field to push the AFM order into the positive direction at the switching field.
When the chain flips, the exchange field from the Mn ions then pushes the Gd spins in the same positive direction, thus completing the first part of the cycle.
During the second cycle the same consideration leads to the further positive rotation of the spins.


\begin{figure}[b]
	\IncludeGraphics[width=0.9\columnwidth]{simplified_model.png}
	\caption{\label{fig:GdMn2O5_simple_model}{\bf Spins in the simplified model.} The zero field configuration of the spins that perform the full rotation (360$^\circ$), used in the simplified model \eqref{eq:GdMn2O5_simple_model}, and indicated by the arrows. Spins $S_6$ and $S_7$ are translated by $b$ and $2a$, respectively, from their original position in the second half of the cell for clarity. Due to the symmetry of the model and the geometry, the two clusters are copies of eachother, allowing the model to focus on the top right set, encased in the red box.}
\end{figure}

\section{Conclusions}
We have examined the very peculiar and novel magnetoelectric switching behavior in GdMn$_2$O$_5$, a hallmark multiferroic system.
Based on the incredible experimental observations performed by our collaborators in A. Pimenov's group, we have constructed a semi-classical spin model in an attempt to reproduce the behavior.
Not only was this attempt very succesful in mimicking the experimental observations, it also allowed us to gain deeper insight into what causes the effect.
\\\\
We identified three separate polarization switching regimes that occur for different values of the angle $\phi_H$ that the applied magnetic field makes with the $a$ axis of the crystal.
Accordingly, we termed these the low angle, high angle, and magic angle switching regimes, the latter fully deserving its designation due to the novel four state double hysteresis loop that it leads to.
The magnetoelectric switching is fully deterministic in each regime, hinting at the energetics as the source for this behavior.
Using a semi-classical effective spin Hamiltonian in terms of the Gd spins, and the AFM order parameters $\bm L_\alpha$ that describe the Mn chains, we were able to unravel the characteristics of the system.
This physics is a prime example of the often recurring theme in condensed matter, where a combination of relatively simple terms in the Hamiltonian can lead to very interesting and unexpected emergent phenomena.
\\\\
Since the four state switching regime at the magic angle is the most novel, we focused much of our effort on understanding its underlying mechanism. Extrapolating the gained knowledge we were then able to rationalize the behavior of the low and high angle regimes as well.

Focusing first on the evolution of the energy landscape of the model in Fig.~\ref{fig:GdMn2O5_heatmap}, we understood that the trajectory of the system through the four states is not only described by the variation of their energy minima, but that a crucial role is played by the energy barriers between them.
We verified this by performing Nudged Elastic Band calculations that describe how the barriers between the four states evolve as a function of the applied field strength (see Fig.~\ref{fig:GdMn2O5_neb}), fully uncovering the mechanism behind the unidirectional trajectory through the energy landscape.
The main observation is that the barriers between neighboring states are not related by symmetry and are thus allowed to evolve asymmetrically, a fact confirmed by the different magnetizations of the barrier states.
\\\\
We then turned our attention to the behavior of the spins associated with the effective model. Incredibly, we found that the undirectional cycling of the four state regime is reflected in the full 360$^\circ$ rotation of half the spins by increments close to 90$^\circ$ (see Fig.~\ref{fig:GdMn2O5_regimes} for a summary of all switching regimes).
This is a microscopic analogue to the crankshaft in a car, transforming linear back--and--forth motion of the applied magnetic field (the piston) into circular motion of the spins (crankshaft).
Since the polarization in these materials is a direct result of the magnetic configuration, we managed to link the uncovered spin behavior directly to the observations of the magnetoelectric switching measurements.
\\\\
Moreover, by realizing how the magic angle switching regime appears as a boundary between the low and high angle regimes, and by studying the difference in their trajectories through the energy landscape, we identified the topological nature of the switching behavior.
We then defined a topological winding number to the spin rotations which is 0 for the two state switching regimes (low and high angle), and 1 for the four state switching regime.
In order to verify the generality and robustness of this topological behavior, we performed simulations with varied model parameters, demonstrating its existence in a wide range of cases (see Fig.~\ref{fig:GdMn2O5_windingvsparam}).
\\\\
Combining all our observations, we concluded by attempting an intuitive explanation of the switching from a microscopic point of view, comparing the behavior of the spins in GdMn$_2$O$_5$ to the well-known spin-flop transition.
While our investigation explained the lion's share of the observed magnetoelectric switching behavior in GdMn$_2$O$_5$, there remain some unanswered questions, mainly concerning the influence of domains, and what leads to the smaller jumps of the polarization curves in Fig.~\ref{fig:GdMn2O5_experiment1}.
\\\\
We would like to conclude with some speculations on the technological applicability of this magnificent behavior.
First, the clearest similarity is with a binary counter, where GdMn$_2$O$_5$ could be a single crystal analogue where the two polarization states denote either a 0 or 1 bit.
It could then be trivially used as a binary counter for magnetic field pulses.
Second, the flatness of the energy surface close to the switching field could open the door to a degree of electric control over the magnetic configuration~\cite{Radaelli08Y,Oh14}.
This could then be utilized in storage devices that store the data magnetically, but read and write it electrically.
The main limiting factor is the exceedingly low temperature that is required to observe these effects (see Fig.~\ref{fig:GdMn2O5_experiment2}(c)).
