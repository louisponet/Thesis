\chapter{Magnetoelectric crankshaft: topologically protected switching in multiferroic GdMn$_2$O$_5$}
\section{Introduction}
\lp{words to sprinkle around: coexist, attracted much attention}
Efficient control and probing of robust order has historically been one of the main technological drivers for research in condensed matter.
The hallmark example is the impact that the discovery of giant magnetoresistance has had on the efficiency of the readhead in hard disks.
This is achieved by having a multilayer sandwich composed of one pinned magnet, a non-magnetic metal and a soft magnet, the last of which aligns with the information storing magnetic domain on the disk itself.
This will influence the amount of current which flows through the readhead due to the lower conductivity of the soft magnetic layer when it is antiparallel with respect to the pinned magnet. Indeed, the pinned magnet will polarise the spins of the current carriers to be aligned with its magnetization, as they travel through it. When those carriers subsequently arrive at the second magnetic layer, they will have the wrong spin polarization as compared with the conducting states close to the fermi level. This leads to greater scattering and thus to a lower conductivity.
The end result is a purely electrical way of reading back the orientation of the magnetic domains on disk, greatly increasing the efficiency compared with reading through induction with a solenoid.

There remains, however, the issue of writing the information in the first place.
In modern state-of-the art high density storage technologies, this is still done by applying an external magnetic field with an electromagnet to reorient the ferromagnetic domains. One can imagine this to be quite an inefficient process, both from the point of view of granularity (stray fields and non-locality of the magnetic fields limit the minimum size of the domains) as from that of dissipation.
Improving these figures of merit drives much of the current research in the field of spintronics, with promising applications like spin-transfer torque devices, utilizing the torque applied by spin-polarized current carriers on the magnetic moments inside the storage medium, circumventing the need to create a magnetic field from circular currents in electromagnets.

It is clear that the longevity of magnetic order, combined with the ease of manipulation provided by charge-based order is highly desirable.
This leads us to the topic of this chapter, namely the magnetoelectric effect in multiferroic insulators.
As the name implies, the magnetoelectric effect allows for the electric control of magnetic order or the magnetic control of ferroelectric polarization\cite{Spaldin2019,Khomskii2009,Fiebig2005,Fiebig2016,Cheong2007}, the former of which could be used in devices where information is stored magnetically but read and written electrically.

In practice, however, there are many issues that limit the effectiveness of this cross-order coupling, and the number of multiferroic materials is limited to begin with.
This latter point can be partly understood from a symmetry point of view.
Namely, ferroelectric materials break inversion symmetry, whereas magnetic order needs the breaking of time reversal symmetry.
There are thus only 13 Shubnikov magnetic point groups that allow simultaneous appearance of ferroelectricity and magnetization~\cite{Wang2009}, but not all compounds that belong to one of those 13 groups showcase multiferroicity.
Another reason for the relative rarity of multiferroic materials is that, generally speaking, ferroelectricity and magnetism are not compatible on the ionic level, i.e. they require ions with different valence configurations\cite{Spaldin2019}.
For example, among perovskites (ABO$_3$, A cation, B anion), there are many ferroelectric or magnetic oxides, but the combination of the two is very uncommon.
The reason in this case is that, in general, a prerequisite for ferroelectricity is a valence configuration of $d^0$, i.e. an empty $d$-shell, or the presence of lone pairs (ns$^2$).
Conversely, magnetism requires partially filled $d$ or $f$ shells, such that the unpaired electrons lead to nonzero magnetic moments on the constituent ions.
These two requirements are mutually exclusive and can thus not be realized simultaneously on a single ion, making multiferroics not commonplace \lp{there is also the issue of hybridization where empty shells lead to occupation of bonding orbitals and half-filled orbitals engaging in anti-bonding hybridization never stabilizing the ionic shift, not sure if I should also discuss that}.

There are two ways around this issue, which lead to so-called Type-I and Type-II classification of multiferroics\cite{Khomskii2009}.
The Type-I variety harbors two different `subsystems' that separately handle the magnetic and ferroelectric orders.
Using perovskites again as an example, a ferroelectrically active A-site cation such as Bi$^{3+}$ or Pb$^{3+}$ can be combined with a magnetically active B-site anion such as Fe which is the case in, for example, BiMnO$_3$. In this material, the lone pairs of the Bi ions result in a ferroelectric polarization of $\approx$ 16 $\mu$C/cm$^2$, whereas the Mn ions result in a ferromagnetic phase below 110K~\cite{Wang2009}.
One can write down a Landau Theory for a homogeneous type-II multiferroic by expanding the free energy $F$ in terms of $P$ and magnetization $M$:
\begin{align}
	F(P, H) =& F_0 + \frac{a}{2} (T-T_P) P^2 + \frac{b}{4} P^4 - \varepsilon_p P E \\
	&+\frac{\alpha}{2} (T-T_M)M^2 + \frac{\beta}{4} M^4 - \chi_M MH - \frac{g}{2}P^2 M^2.
\end{align}
This is the simplest form of the free energy of a multiferroic with ferroelectric polarization $P$ and magnetization $M$. All Landau parameters are taken to be positive, such that below the ferroelectric (ferromagnetic) transition temperature $T_P$ ($T_M$) nonzero $P$ ($M$) develops. The dielectric constant $\varepsilon_P$ and magnetic susceptibility $\chi_M$ couple $P$ and $M$ to an externally applied electric or magnetic field, respectively. The lowest symmetrically allowed magnetoelectric term that couples $P$ and $M$ is $-gP^2M^2$, obeying both time and inversion symmetries above the transition temperatures $T_P$ and $T_M$.
Minimizing the energy with respect to both orders, with no applied external fields, leads to
\begin{align}
	P^2 &= - a(T-T_P)/b + gM^2\\
	M^2 &= - \alpha(T-T_M)/\beta + gP^2.
\end{align}
Both order parameters thus depend on the value of the other through the magnetoelectric coupling $g$. This leads to a change in one when an external perturbation is applied to the other.
The different origin of both orders, however, usually results in a small value of $g$. Indeed, the effective dielectric constant $\varepsilon$ of BiMnO$_3$ only displays a weak anomaly at the ferromagnetic transition temperature, and is only weakly affected by an applied magnetic field, leading to a variation of 0.6\% of $\varepsilon$ at a field value of 9T.

The other class of multiferroics, i.e. those with Type-II multiferroicity, generally hold a bigger magnetoelectric effect, because the magnetic and ferroelectric orders both originate from the same underlying physics.

The materials have improper ferroelectricity, i.e. the electron degrees of freedom cause a particular magnetic configuration that breaks inversion symmetry, rather than a structural instability and associated ionic displacements.
To optimize the magnetic exchange energies, however, there will be displacements of the ions, that ultimately leads to a lowering of the crystalline symmetry.  
Although the size of the electric polarization thus created is usually orders of magnitude smaller than in Type-I multiferroics, the common origin of the two orders leads to a very sizable magnetoelectric effect.

Here we specifically investigate GdMn$_2$O$_5$ (see Fig.~\ref{fig:GdMn2O5_unit_cell}), an example of a type-II multiferroic\cite{Khomskii2009}, where the ferroelectric polarization can be controlled to a high degree by the application of an external magnetic field, as will be shown below.
The orthorhombic $R$Mn$_2$O$_5$ manganites have a very complex crystalline structure, which leads to a wealth of different phases depending on the temperature, magnetic field and even electric-field poling history \cite{Zheng2019}.
To keep the discussion tractable and in line with the experiments that were performed, we give a summary of the transitions and phases that are important for this part of the Thesis.
$R$Mn$_2$O$_5$ have crystallographic group $Pbam$ \cite{Alonso97} in the paramagnetic phase at high temperature, which eventually gets lowered to the crystallographic space group $P_ab2_1a$ when the commensurate magnetic order locks in below $T_{N} \sim 33K$.
This order is characterised by the propagation vector $\bm{k} = (1/2, 0, 0)$, i.e. there is a unit cell doubling along the crystalline $a$-direction. Spins are ordered ferromagnetically along the crystalline $c$-direction. This magnetic transition goes hand in hand with a sharp anomaly in the dielectric constant $\varepsilon_b$, signalling the onset of the improper ferroelectric polarization order along the $b$-direction \cite{Lee13}.
When the temperature is lowered further, the polarization $P_b$ saturates to a maximum value of around 3600 $\mu$ C/m$^2$, which is the largest of all rare-earth magnanites, but still tiny compared to proper ferroelectrics like BaTiO$_3$ with $P \approx 2 \times 10^5 \mu C/m^2$.
The magnetic configuration features two AFM Mn chains per unit cell, which are formed by pyramidally coordinated $Mn^{3+}$ and octahedrally coordinated $Mn^{4+}$ ions, as indicated by the light blue lines and purple polygons in Fig.~\ref{fig:GdMn2O5_unit_cell}. The Mn spins of the chains in GdMn$_2$O$_5$ lie mostly along the fourfold symmetry axis of the Mn pyramids, making angles of $\pm 23.4^\circ$ with the $a$-axis.

The improper ferroelectricity is generated through the symmetric Heisenberg exchange striction, combined with the geometric frustration and strong antiferromagnetic exchanges~\cite{Choi2008}.
The geometric frustration appears due to the odd number of AFM coupled spins in the Mn pentagons that surround each Gd ion, as can be seen in panel c of Fig.~\ref{fig:GdMn2O5_unit_cell}.
Similar to the situation in AFM coupled ions on a triangular lattice, not all AFM exchanges can be simultaneously satisfied (i.e. by having completely antiparallel spins on each AFM bond).
Each bond will then optimize the magnetic exchange energy together with the elastic energy resulting in bonds with antiparallel spins to contract whereas bonds with parallel spins will extend, as shown in Fig.~\ref{fig:GdMn2O5_unit_cell}(b). This can be understood from the dependence energy of each bond on the bondlength between two Mn ions $W$, following Ref. \cite{Harris1972}, as:
\begin{equation}
	W = J(r)\mathbf{S}_i \cdot \mathbf{S}_j + \frac{\kappa \delta r^2}{2r_0},
\end{equation}
with $\kappa$ the elastic stiffness of the bond, $r_0$ the mean separation of Mn ions, spins $\mathbf{S}_i$ and $\mathbf{S}_j$, and $\delta r = r - r_0$.
Minimizing this bond energy (i.e. taking $\frac{\partial W}{\partial r} = 0$), leads to the change in bondlength $\delta r$ upon condensing the magnetic structure to be given by 
\begin{equation}
	\delta r = -\frac{\partial J}{\partial r}\frac{r_0}{\kappa}\mathbf{S}_i \cdot \mathbf{S}_j. 
\end{equation}
If one then assumes that $J(r) = J_0 e^{- \frac{\varepsilon r}{r_0}}$ with $\varepsilon$ some constant, the first order correction is given by
\begin{equation}
	\delta r = 	J_0\frac{\varepsilon}{\kappa}\mathbf{S}_i \cdot \mathbf{S}_j. 
\end{equation}
Thus, bonds with antiparallel spins will contract ($\delta r < 0$), and bonds with parallel spins will extend ($\delta r > 0$).
In the $R$Mn$_2$O$_5$ materials, this causes the ocatahedrally coordinated Mn$^{4+}$ ion to shift towards one of the two neighboring Mn$^{3+}$ pyramids in the Mn$^{3+}$ -- Mn$^{4+}$ -- Mn$^{3+}$ sequences, as showcased in Fig.~\ref{fig:GdMn2O5_unit_cell}(b).
This leads to the lowering of the symmetry from $Pbam$ to $P_ab2_1a$, and, as the valence of the Mn$^{3+}$ and Mn$^{4+}$ ions differs, to a nonzero contribution to the polarization along the $b$-axis\cite{Khomskii2009}.
It was shown, however, that this ionic displacement is largely compensated by electronic correlation effects, shifting the electronic wavefunctions opposite to the ions and almost fully cancelling the contribution to the polarization that originates from the Mn chains.
There is a second source of polarization in $R$Mn$_2$O$_5$ with a magnetic rare-earth, also due to the symmetric Heisenberg exchange striction, this time between the rare-earth and the surrounding Mn pentagon.
A similar train of thought can be followed as before, where all the exchanges between the rare earth and the surround Mn ions are AFM, again causing certain bonds to have antiparallel spins versus parallel spins, and the associated contraction and extension (see Fig.~\ref{fig:GdMn2O5_unit_cell}(c)).
This contribution does not suffer from the same cancellation between ionic displacements and electronic charge, and leads to the majority of the ferroelectric polarization in these materials.

Gd$^{3+}$ is special with respect to the other magnetic rare-earths in $R$Mn$_2$O$_5$, because it has a very isotropic electronic configuration (4$f^7$), i.e. there is no unquenched OAM and associated anisotropic charge distribution. This means that the large spin (nominally $S=7/2$) can orient itself relatively freely to optimize the magnetic interactions with its neighboring Mn atoms, and that it has a high magnetic susceptibility and associated magnetoelectric effects.
This leads to GdMn$_2$O$_5$ outclassing the other $R$Mn$_2$O$_5$ compounds both in size and tunability of $P_b$, with a measured variation of up to $5000 \mu C/m^2$ when a magnetic field is applied~\cite{Lee13}. 

Now that the stage is set, we will describe the puzzling experimental observations that we will try to explain.
%Even though the AFM intrachain superexchange interactions dominate over the AFM interchain interactions, there is nonetheless a geometric frustration due to the crystal structure, which can be seen most easily seen from the Mn pentagons surrouding the Gd atoms. This means that all AFM exchanges can not be satisfied at the same time, causing certain Mn bonds between the chains to have energetically unfavorable spin alignment. This leads to the first contribution to the ferroelectric polarization through Heisenberg exchange striction, lengthening bonds that have parallel spins and shortening those that have antiparallel ones.

\begin{figure}
	\IncludeGraphics{unit_cell.pdf}
	\caption{\label{fig:GdMn2O5_unit_cell}{\bf Unit cell and magnetic configuration of GdMn$_2$O$_5$.} The spheres signify Mn (purple), Gd (green) and Oxygen (red) ions. a) {\it Magnetic unit cell}, the zig-zag chains along the $a$-direction (cyan lines) show which Mn ions are linked with strong AFM exchange, resulting in the $\mathbf{L}_1$ and $\mathbf{L}_2$ N\'eel vectors. The boundary of the structural unit cell is marked by the black box and the yellow arrows denote the exchange paths between Gd and neighboring Mn ions in both chains, corresponding to $v_1$ and $v_2$. (b-c) {\it Symmetric magnetostriction}, the black arrows signify the zero field orientation of the spins. The yellow arrows denote the expanding bonds due to alignment of spins and AFM exchange, and the blue arrows denote contracting bonds.}
\end{figure}
\section{Experimental results}
In previous experimental measurements, the magnetic field was always applied along the crystalline $a$-direction~\cite{Lee13}.
This leads to the aforementioned reversal and restoration of the polarization, and a relatively normal hysteresis loop (see Fig.~1 of \cite{Lee13}), alternating between two states. However, we found that the behavior of $P(H)$ depends strongly on the angle between the applied magnetic field and the $a$-direction, $\phi_H$.
As can be seen from Fig.~\ref{fig:GdMn2O5_experiment} panel a, at high angle $P_b$ remains positive although a small jump can be observed signalling two different internal states.
In the intermediate `magic angle' region (panel b and d), there is a crossover between the low angle regime of Ref.~\ref{Lee13} and the high angle regime of our experiments, where four different states with different values of $P_b$ are visited while the external field cycles up and down twice.
This novel four state switching is the focus of this part of the thesis, and is found to originate from a rotational motion of the internal spins in one direction.
One could say that this behavior is a microscopic analogy to the crankshaft in a car, converting the linear back--and--forth motion of the magnetic field into a unidirectional rotational motion of the spins.
As will be shown below, these three regimes can each be assigned a winding number, with the four state switching regime lying on the boundary between the two extremal regimes.
The topology of the parameter space in terms of $\phi_H$ is found to be such that this four state switching phase can be thought of as topologically protected, i.e. there always exists a region of $\phi_H$ whre the four state cycle is present. The actual size of this region depends on the specific model parameters used, as will be discussed below.
The results of the experiments performed on single crystal GdMn$_2$O$_5$ samples are shown in Fig.~\ref{fig:GdMn2O5_experiment}. As can be seen from the varying behaviors in panels (a-d), the evolution of $P_b$ with $|H|$ is very dependent on it's angle with the $a$-axis, $\phi_H$.
As alluded to before, at a certain magnitude of this angle and at low temperature, a peculiar deterministic four-state hysterisis loop develops.
Even though all experimental measurements were performed on single crystal samples, 
% At higher temperature the usual two-state hysterisis loop is observed, also at the magic angle, as shown in panel e.
the complexity and low symmetry of the material leads to a wealth of different effects, which is clear from the details of the $P_b$ evolution at $T=4K$, shown in panel e, but also from some details of the evolution at $T=2K$.
We will only focus on the overall behavior, i.e. how the main four-state regime develops as an interpolation between the high and low angle regimes that have the more usual two state switching loop.
It is not clear what led to the discrepancy between the present low angle measurements (panel a) and earlier ones performed in Ref.~\cite{Lee13}, from our theoretical model it will be shown that the behavior in Ref.~\cite{Lee13} arises, rather than the one observed here.
\begin{figure*}[t]
    \centering
    \IncludeGraphics[width=0.99\linewidth]{fig_exp.png}
\caption{ \label{fig:GdMn2O5_experiment} {\bf Evolution of the electric polarization loop across critical angle  and critical temperature.} (a) At higher temperatures only a small step is seen at the transition that shows some hysteresis and the two-state switching; (b) 4-state switching starts to appear approximately from $T=5$~K.(c) four-state hysteresis loop is clearly seen at $T=2.3$~K with the magnetic field at the ``magic'' angle;  
(d-f) Field dependence of the electric polarization of GdMn$_2$O$_5$ for different off-axis orientations of the applied magnetic field. (d,f): Conventional two-state switching is observed if magnetic field is (d) far away from the ``magic" direction  or (f) very close to the crystallographic $a$-axis. (e,g): Unusual four-state hysteresis loop for the magnetic field direction close to the magic angle of $\pm 9^o$. The inset shows the sequence of the magnetic field-sweeps. The labels 1-4 mark the four polarization states. The arrows show the direction of magnetic field-change during the sweep. The experiments have been done at $T=2.3$\,K. }
\end{figure*}
\section{Modeling}
In order to describe the physics at play we use a quasi-classical model Hamiltonian with eight Gd spins designated by unit vectors $\mathbf{S}_i, i=1..8$, two AFM order parameters $\mathbf{L}_\alpha, \alpha=1,2$ (also unit vectors) given by the difference of spins of neighboring Mn ions inside the two Mn chains, and the slave order parameter $P_b$ for the polarization, see Fig~\ref{fig:GdMn2O5_unit_cell}.
Using these AFM order parameters amounts to taking the rigid spin approximation, i.e. all spins in each chain are assumed to be collinear with the same size and alternating sign. This simplification is justified by the large intrachain AFM exchanges, compared with the relatively small exchanges between the two chains.
Another simplification that is adopted is to keep all spins in the $ab$-plane, since this was experimentally shown to be the case, and the layers couple ferromagnetically along the crystalline $c$-direction~\cite{Lee13}.
This lowers the dimensionality of the problem from 3D to 2D, with a single angle per Gd spin and Mn chain as the remaining degrees of freedom, greatly simplifying the numerical solution.
Since all spins and AFM order parameters are unit vectors, their sizes are implicitely included in the model parameters.

The next step in deriving the appropriate model Hamiltonian using these simplifications and order parameters is to find symmetrically allowed combinations of them, which have to transform according to the unit representation of the symmetry group of the crystal.
To this end we utilize the following symmetry operations of the paramagnetic high symmetry $Pbam$ phase:
\begin{align}
	I &: (x, y) \rightarrow (-x, -y)\\
	2z &: (x, y) \rightarrow (-x, -y)\\
	2y &: (x, y) \rightarrow (\frac{1}{2} - x, \frac{1}{2} + y)
\end{align}
$I$ and $2z$ are the same symmetry operations in the 2D case. Next, a doubling of the unit cell is necessary to fit the overall AFM magnetic state. This leads to additional symmetry operations when the spins are not taken into account, which in light of brevity we won't fully enumerate here. For our purposes it suffices to write $2y: (x, y) \rightarrow (\frac{1}{4} - x, \frac{1}{2}+y)$ and add an additional symmetry operation $a: (x, y) \rightarrow (x + a, y)$.
In effect, applying these symmetry operations to the degrees of freedom, bearing in mind the AFM spin transformation between the two halves of the magnetic unit cell, leads to the following transformation table:
\begin{table}[h]
\begin{tabular}{|l|lllllllllll|}
\cline{1-12}
 & $S_1$ & $S_2$ & $S_3$ & $S_4$ & $S_5$ & $S_6$ & $S_7$ & $S_8$ & $L_1$ & $L_2$ & $P_b$ \\ \cline{1-12}
I & $S_8$ & $S_7$ & $S_6$ & $S_5$ & $S_4$ & $S_3$ & $S_2$ & $S_1$ & -$L_1$ & $L_2$ & -$P_b$ \\ \cline{1-12}
2y & $S_4$ & $S_3$ & $S_2$ & $S_1$ & $S_8$ & $S_7$ & $S_6$ & $S_5$ & $L_1$ & $L_2$ & $P_b$ \\ \cline{1-12}
a & $S_5$ & $S_6$ & $S_7$ & $S_8$ & $S_1$ & $S_2$ & $S_3$ & $S_4$ & -$L_1$ & -$L_2$ & $P_b$ \\ \cline{1-12}
\end{tabular}
\end{table}\\\\
The first set of contributions are the Heisenberg exchange terms between the Gd spins and the Mn chains ($L_1$ and $L_2$), with the effective exchange parameters denoted by $v_1$ and $v_2$.
The former (latter) couples each Gd spin with the chain that harbors the closest (furthest) Mn ion.
Starting from terms with $S_1$ and $S_2$, taking into account the above table of transformations, the following sets of terms can be identified:
\begin{align}
	\mathbf{S}_1\cdot(v_1 \mathbf{L}_2 + v_2 \mathbf{L}_1) \xrightarrow{I} \mathbf{S_8}\cdot(v_1 \mathbf{L}_2 - v_2 \mathbf{L}_1) \xrightarrow{a} \mathbf{S_4} \cdot (- v_1 \mathbf{L}_2 + v_2 \mathbf{L}_1) \xrightarrow{I} \mathbf{S_5} \cdot (-v_1 \mathbf{L}_2 - v_2 \mathbf{L}_1) \nonumber\\
	\mathbf{S}_2\cdot(v_1 \mathbf{L}_1 + v_2 \mathbf{L}_2) \xrightarrow{I} \mathbf{S_7}\cdot(-v_1 \mathbf{L}_1 + v_2 \mathbf{L}_2) \xrightarrow{a} \mathbf{S_3} \cdot (v_1 \mathbf{L}_1 - v_2 \mathbf{L}_2) \xrightarrow{I} \mathbf{S_6} \cdot (-v_1 \mathbf{L}_1 - v_2 \mathbf{L}_2) 
\end{align}
The sum of all these contributions has the correct unit representation of energy, leading to the first contribution to the Hamiltonian:
\begin{align}
    H_{LS} =& \mathbf{S}_1 \cdot (v_1 \mathbf{L}_2 + v_2 \mathbf{L}_1) + \mathbf{S}_2 \cdot (v_1 \mathbf{L}_1 + v_2 \mathbf{L}_2) + \mathbf{S}_3 \cdot (v_1 \mathbf{L}_1 - v_2 \mathbf{L}_2) + \mathbf{S}_4 \cdot (-v_1 \mathbf{L}_2 + v_2 \mathbf{L}_1) \nonumber\\
    -&\mathbf{S}_5 \cdot (v_1 \mathbf{L}_2 + v_2 \mathbf{L}_1) - \mathbf{S}_6 \cdot (v_1 \mathbf{L}_1 + v_2 \mathbf{L}_2) - \mathbf{S}_7 \cdot (v_1 \mathbf{L}_1 - v_2 \mathbf{L}_2) - \mathbf{S}_8 \cdot (-v_1 \mathbf{L}_2 + v_2 \mathbf{L}_1)
\end{align}
Since $P_b$ is a scalar, a similar process can be applied starting from $P_b \, \mathbf{S_1}\cdot(\beta_2 \mathbf{L}_1 + \beta_3 \mathbf{L}_2)$ and $P_b\, \mathbf{S_2}\cdot(\beta_2 \mathbf{L}_1 + \beta_3 \mathbf{L}_2)$, which signify the symmetric Heisenberg magnetostriction contribution to the Hamiltonian. This leads to
\begin{align}
	H_{P_b}=&-P_b[E_b + \beta_1 (\mathbf{L}_1\cdot \mathbf{L}_2)+
    (\mathbf{S}_1-\mathbf{S}_5)(\beta_2 \mathbf{L}_2 + \beta_3 \mathbf{L}_1) +
    (\mathbf{S}_2-\mathbf{S}_6)(\beta_2 \mathbf{L}_1 + \beta_3 \mathbf{L}_2) \nonumber\\ 
    &+(\mathbf{S}_3-\mathbf{S}_7)(\beta_2 \mathbf{L}_2 - \beta_3 \mathbf{L}_1) +
    (\mathbf{S}_4-\mathbf{S}_8)(\beta_2 \mathbf{L}_1 - \beta_3 \mathbf{L}_2)],
\end{align}
where the dipole term from a possible external electric field $P_b E_b$ was also included. 
A further three terms in the Hamiltonian depend solely on $L_1$ and $L_2$:
\begin{equation}
	H_L = \Gamma(\mathbf{L}_1\cdot \mathbf{L}_2)^2
    +\sum_{\alpha}\chi^{-1}((\mathbf{H}\cdot \mathbf{L}_\alpha)^2-H^2)
    -K_L\sum_\alpha(\mathbf{L}_\alpha\cdot \mathbf{n}_\alpha)^2\label{eq:GdMn2O5_hami_1}
\end{equation}
The first originates from the gain in exchange energy through spin canting when the chains are not colinear, due to the competition of interchain exchange $J_\perp$ and the intrachain AFM exchange $J_\|$ \cite{Sushkov2008} \lp{more details?}, with $\Gamma\sim\frac{J_{\perp}^2}{J_\|}>0$. The term with $\chi$ represents the gained Zeeman energy when the Mn spins are slightly canted from the purely AFM order inside the chains, resulting in a weak magnetic moment which couples the the external field. The last denotes the easy-axis anisotropy which is aligned with the fourfold axes of the pyramidally coordinated Mn ions, i.e. $\mathbf{n}_\alpha=$(cos($\pm$23.4$^\circ$), sin($\pm$23.4$^\circ$)) respectively.

Similarly, three terms can be identified as coming purely from the Gd spins:
\begin{equation}
     H_S=\frac{1}{2}(g \mu_B)^2\sum_{i\neq j}\left(\frac{\mathbf{S}_i\cdot \mathbf{S}_j}{r_{ij}^3}-3\frac{(\mathbf{S}_i\cdot \mathbf{r}_{ij})(\mathbf{S}_j\cdot \mathbf{r}_{ij})}{r_{ij}^5}\right) - \sum_i\left( K_S(\mathbf{N}_i\cdot \mathbf{S}_i)^2 + g\mu_\mathrm{B} \mathbf{H} \cdot \mathbf{S}_i\right) 
\end{equation}
The first describes the magnetodipolar interaction between Gd spins, which could be relatively large due to the size of the spins and relative proximity to the neighbors. In the numerical simulations these were restricted to five nearest neighbors, including periodic images. Including further neighbors did not lead to qualitative differences of the results. Again an anisotropy term is included, this time with anisotropy axes $N_i$, unit vectors alternating as $\pm 12^\circ$. $K_S$ is significantly smaller than $K_L$ due to the isotropic environment and spin configuration of the Gd ions.
The final term denotes the Zeeman energy from the interaction with the externally applied magnetic field.

The model parameters used here are $J_\perp = 1.89$~meV, $J_\parallel = 26.67$~meV, $K_L = 5.27$~meV, $K_S = 0.2$~meV, $v_1 = 3.33$~meV, $v_2 = 0.15$~meV \lp{check order parameters, maybe show different sets?}. 
with the model parameters used to fit the experimental data, $\alpha = 0.06\:\mu$C/cm$^2$, $\beta = 0.04\:\mu$C/cm$^2$, $\gamma = 0.06\:\mu$C/cm$^2$.

As mentioned before, the low temperature commensurate state breaks both time reversal symmetry, $T: (\mathbf{L}_1, \mathbf{L}_2) \rightarrow (-\mathbf{L}_1, -\mathbf{L}_2)$, and inversion symmetry $I:(\mathbf{L}_1, \mathbf{L}_2) \rightarrow (-\mathbf{L}_1, \mathbf{L}_2)$, which makes the system fall into one of the fourfold degenerate energy minima as shown in the top left panel of Fig.~\ref{fig:GdMn2O5_heatmap}. 
To simulate the experimental measurements in Fig.~\ref{fig:GdMn2O5_experiment} at low temperature, we choose one of the four degenerate minima of the Hamiltonian, gradually increase and decrease the applied magnetic field, and minimize the energy in order to track the instantaneous local minimum. 

The results are shown in Fig.~\ref{fig:GdMn2O5_theory}
\begin{figure*}[t]
	\begin{subfigure}{0.24\textwidth}
    \IncludeGraphics{"field_heatmap1"}
	\end{subfigure}
	\begin{subfigure}{0.24\textwidth}
    \IncludeGraphics{"field_heatmap2"}
	\end{subfigure}
	\begin{subfigure}{0.24\textwidth}
    \IncludeGraphics{"field_heatmap3"}
	\end{subfigure}
	\begin{subfigure}{0.24\textwidth}
    \IncludeGraphics{"field_heatmap4"}
	\end{subfigure}\\
	\begin{subfigure}{0.24\textwidth}
    \IncludeGraphics{"field_heatmap5"}
	\end{subfigure}
	\begin{subfigure}{0.24\textwidth}
    \IncludeGraphics{"field_heatmap6"}
	\end{subfigure}
	\begin{subfigure}{0.24\textwidth}
    \IncludeGraphics{"field_heatmap7"}
	\end{subfigure}
	\begin{subfigure}{0.24\textwidth}
    \IncludeGraphics{"field_heatmap8"}
	\end{subfigure}
	\caption{{\bf Energy surfaces inside hysteresis loop} $\phi_{L_1}$ and $\phi_{L_2}$ both range between 0 to $2\pi$.}
	\label{fig:GdMn2O5_heatmap}
\end{figure*}

\begin{figure*}[t]
    \centering
    \IncludeGraphics[width=\linewidth]{fig_theory}
    %\includegraphics[width=\linewidth]{fig/L1L2_heatmap.png}
    \caption{\label{fig:GdMn2O5_theory}{\bf Simulation of magnetoelectric behaviour.}
    (a-c) Evolution of electric polarization $P_b$ during the magnetic field sweep cycle for various magnetic field orientations. 
   In each panel, the changes of the curve color indicate the same progression of the sweep cycle as Fig 2. The four-state switching is seen for the field at the magic orientation. 
    The insets indicate the corresponding switching paths and winding numbers.
    (d-f) Trajectories (in green) in the space of the N\'eel vectors orientations, $(\phi_{\rm L_1},\phi_{\rm L_2})$, through the field sweep cycles in different regimes. The color map shows the energy landscape in the vicinity of the switching fields. 
    (g) Evolution of transition barriers between states 1,2,3,4 as the magnetic field at 10$^\circ$ to the $a$ axis is swept through the hysteresis region. The plots are shifted vertically, and magnetodipolar interactions were enhanced by a factor of 5.3 for clarity. The curve colors encode the corresponding magnetic field strength. The trajectory of the energy minimum due to field sweeps is shown with blue circles and arrows.
    Coordinated changes of the state energies and barrier asymmetry with magnetic field enable the topological behavior.
    (h) Spin configurations in states 1, 2, 3 and 4.
    (k) Schematic evolution of the barriers connecting the state 2 to states 1 and 3 in the vicinity of $H^*$. Saddle point states are denoted by $12$ and $23$.}
\end{figure*}
In order to understand the energy surface connecting the four states, we proceed by labeling them in the same way as Fig.~\ref{fig:GdMn2O5_experiment}, and perform a nudged elastic band calculation between the four states at a given magnetic field inside the hysterisis region.
This results in the evolution of barriers between these states as shown in panel (g), where the color coding is used to denote the magnetic field strength, and the energy graphs are offset for clarity.
The arrows and blue balls denote the evolution during the double magnetic field sweep. As expected, two minima with opposite $P_b$ are degenerate each value of $H$, at low field these are located at states 1 and 3, then as the field is ramped up they move to favor states 2 and 4.
We see that during the sweep the barriers between the different states evolve asymmetrically.
Starting in state 1, when the field is ramped up the barrier towards state 2 decreases faster than the one towards state 4, causing the system to move from 1 to 2.
Then, as the magnetic field is lowered again, the barrier from 2 to 3 increases slower than from 2 to 1. When ultimately state 2 goes from being metastable to a saddle point, the system spills over towards state 3, and so on.
In order to try and understand where the asymmetric evolution of the barriers comes from, we investigate the situation around the particular $H$-field strength where the system is close to state 2, and the barriers between state 2 and 1, and 2 and 3 are the same height.
This situation is highlighted by the red dashed box around the blue graph in Fig.~\ref{fig:GdMn2O5_theory}(g). The inset of panel (k) provides a zoom on the energy surface. The states $12$ and $23$ denote the configurations on top of the barriers from 1 to 2 and 2 to 3, respectively. A Taylor expansion in terms of $H$, around $H^*$ can be performed for both states:
\begin{equation}
	F(H) = F(H^*) + \left.\frac{\partial F}{\partial H}\right\rvert_{H=H^*} (H-H^*) + ...
\end{equation}
If one then subtracts the results, using $\frac{\partial F}{\partial H} = M$, the following expression is found
\begin{equation}
	E_{12}(H) - E_{23} \sim (M_{12} - M_{23}) (H - H^*).
\end{equation}
This means that, to first order, the evolution of the barrier asymmetry is given by the difference in magnetization of the two states on top of the barriers.
The magnetization of both states can be calculated using the following formula
\begin{equation}
	\mathbf{M} = -\frac{\partial{F}}{\partial{\mathbf{H}}} = \sum_i g \mu_{B} \mathbf{S}_i - \sum_{\alpha} 2 \chi^{-1}\mathbf{L}_{\alpha} (\mathbf{H} \cdot \mathbf{L}_{\alpha}) 
\end{equation}
Indeed we find that the magnetizations are different from our simulations, $M_{23} > M_{12}$, confirming that this is at least a part of the reason for the asymmetric evolution of the barriers.
Moreover, due to the symmetry of the system, this asymmetry is opposite when the field is swept up, as compared with when the field is swept down.
This causes that when $H > H^*$ the barrier from state 1 to state 2 lowers faster than the one towards state 4, and by symmetry, the barrier from state 3 to state 4 lowers faster than from state 3 to 2.
The converse is true when $H < H^*$, but since the system is then coming from the high-field configurations, it moves from 2 to 3 and 4 to 1 rather than the opposite direction.
This causes the deterministic unidirectional movements through the four states sequentially when two field sweeps are applied.
Since the two low field states that get accessed sequentially have two different $P_b$ values, this situation effectively results in a single crystal binary counter behavior.  

The magnetic configuration of the four extremal states is displayed in panel (h) of the same figure, showcasing the rotational motion of the spins inside the chain most parallel to the applied magnetic field, and the Gd ions coupled most strongly with it.
This robust one directional rotation allows us to assign a non-zero winding number to the `magic-angle' switching behavior, i.e. $Q=\frac{1}{2\pi}\int_0^{T_0} dt (L_x\partial_t L_y - L_y \partial_t L_x)$. 

\section{Simplified Model}
Having found a description for the situation in the complicated material GdMn$_2$O$_5$ using the model \ref{eq:GdMn2O5_1}, one may wonder what the minimal requirements are to have a similar four-state behavior where the spins rotate 360$^\circ$ while the applied field only oscillates back and forth along a single axis.
We look to the spin configurations of Fig.~\ref{fig:GdMn2O5_theory}(h) for inspiration.
It is clear that, although both chains are necessary for the $P_b$ behavior, the chain with equilibrium Mn moments most parallel to the applied field does the full rotation, while the other chain merely oscillates around its starting position.
Similarly, only the Gd moments most strongly coupled to that chain perform the full 360$^\circ$ cycle.
This warrants an attempt to search for the four state behavior using only a single chain with its Gd moments, more specifically, in the case of $\phi_H = +10^\circ$, we keep $L_1$, $S_2$, $S_3$, $S_6$ and $S_7$ as the degrees of freedom in the model.
Given the negligible importance of the anisotropy on the Gd ions, we also put $K_S = 0$.
This leaves us with the following Hamiltonian, which is split up in two parts, one with the dipolar terms $H_{dip}$ and one with all the other terms $H'$:
\begin{align}
	H &= H' + H_{dip} \\
	H' &= v_1(\mathbf{S}_2 + \mathbf{S}_3 - (\mathbf{S}_6 + \mathbf{S}_7))\cdot\mathbf{L}_1 - g \mu_b (\mathbf{S}_2 + \mathbf{S}_3 + \mathbf{S}_6 + \mathbf{S}_7) \cdot \mathbf{H} \\
	&- K_L (\mathbf{L}_1 \cdot \mathbf{n})^2 \\
	H_{dip} &= \frac{1}{2}(g \mu_B)^2\sum_{i\neq j}\left(\frac{\mathbf{S}_i\cdot \mathbf{S}_j}{r_{ij}^3}-3\frac{(\mathbf{S}_i\cdot \mathbf{r}_{ij})(\mathbf{S}_j\cdot \mathbf{r}_{ij})}{r_{ij}^5}\right).
\end{align}

Due to the higher symmetries of this model throughout the field sweep cycle, compared with the full model, one can identify two symmetry related copies of one spin in the first half of the magnetic unit cell and one in the second half of the unit cell, with the chain in between (see Fig.~\ref{fig:GdMn2O5_simple_model}), i.e. $S_2 = S_3$ and $S_6 = S_7$.
\begin{figure}
	\IncludeGraphics{double_cell.png}
	\caption{\label{fig:GdMn2O5_simple_model} Simplified single chain model.}
\end{figure}
This further simplifies the Hamiltonian:
\begin{align}
	H' &= 2v_1(\mathbf{S}_3 - \mathbf{S}_6)\cdot\mathbf{L}_1 - 2g \mu_b (\mathbf{S}_3 + \mathbf{S}_6) \cdot \mathbf{H} \\
	&- K_L (\mathbf{L} \cdot \mathbf{n})^2 \\
	H_{dip} &= (g \mu_B)^2\left(\frac{\mathbf{S}_3\cdot \mathbf{S}_6}{r_{36}^3}-3\frac{(\mathbf{S}_3\cdot \mathbf{r}_{36})(\mathbf{S}_6\cdot \mathbf{r}_{36})}{r_{36}^5}\right).
\end{align}
\lp{what can we say more about this?}
\printbibliography
