\newcommand{\Jpar}{J_{||}}
\newcommand{\Jperp}{J_{\perp}}
\chapter{Magnetoelectric crankshaft: topologically protected switching in multiferroic GdMn$_2$O$_5$}
\section{Introduction}
Efficient control and probing of robust order has historically been one of the main technological drivers for research in condensed matter.
The hallmark example is the impact that the discovery of giant magnetoresistance has had on the efficiency of the readhead in hard disks.
This is achieved by having the readhead be comprised of a multilayer sandwich composed of one pinned magnet, a non-magnetic metal and a soft magnet, the last of which aligns with the information storing magnetic domain on the disk itself.
This will influence the amount of current which flows through the readhead depending on the alignment between the magnetizations in the two magnetic layers. This is because, due to the Stoner effect, the conducting states located close to the Fermi level of metallic magnets have a spin polarization along the internal magnetization. This causes the current carriers that exit the pinned magnet to be scattered strongly (leading to low conductivity) from the second magnet if the magnetizations are antiparallel, compared to when the two magnetizations are aligned (high conductivity).
This leads to a change in current through the readhead, and can be electrically probed, indirectly reading out the magnetization state of the information storing domains underneath the readhead.
The end result is a purely electrical way of reading the stored information, greatly increasing the efficiency compared with reading through induction in a solenoid.

There remains, however, the issue of writing the information in the first place.
In modern state-of-the art high density storage technologies, this is still done by applying an external magnetic field with an electromagnet to reorient the ferromagnetic domains. One can imagine this to be quite an inefficient process, both from the point of view of granularity (stray fields and non-locality of the magnetic fields limit the minimum size of the domains) as from that of dissipation.
Improving these figures of merit drives much of the current research in the field of spintronics, with promising applications like spin-transfer torque devices, utilizing an inverse effect to the one described above in which the information is written to the ferromagnetic domains through the torque applied by the misaligned spin moments of polarized current carriers. This circumvents the need to create a magnetic field from circular currents in electromagnets.

It is clear that the longevity associated with magnetic order, combined with the ease of manipulation provided by charge-based order is highly desirable.
This leads us to the topic of this chapter, namely the magnetoelectric effect in multiferroic insulators.
As the name implies, the magnetoelectric effect allows for the electric control of magnetic order or the magnetic control of ferroelectric polarization~\cite{Spaldin2019,Khomskii2009,Fiebig2005,Fiebig2016,Cheong2007}, the former of which is most attractive from a technological point of view.

In practice, however, there are many issues that limit the effectiveness of this cross-order coupling, and the number of multiferroic materials is limited to begin with.
This latter point can be partly understood from a symmetry point of view.
Namely, ferroelectric materials break inversion symmetry, whereas magnetic order needs the breaking of time reversal symmetry.
There are thus only 13 Shubnikov magnetic point groups that allow simultaneous appearance of ferroelectricity and magnetization~\cite{Wang2009}, but not all compounds that belong to one of those 13 groups showcase multiferroicity.
Another reason for the relative rarity of multiferroic materials is that, generally speaking, ferroelectricity and magnetism are not compatible on the single ion level, i.e. they require ions with different valence configurations~\cite{Spaldin2019}.
For example, among perovskites (ABO$_3$, A cation, B anion), there are many ferroelectric or magnetic oxides, but the combination of the two is very uncommon.
The reason in this case is that, in general, a prerequisite for ferroelectricity is a valence configuration of $d^0$, i.e. an empty $d$-shell, or the presence of lone pairs (ns$^2$).
Conversely, magnetism requires partially filled $d$ or $f$ shells, such that the unpaired electrons lead to nonzero magnetic moments on the constituent ions.
These two requirements are mutually exclusive and can thus not be realized simultaneously on a single ion, making multiferroics not commonplace \lp{there is also the issue of hybridization where empty shells lead to occupation of bonding orbitals and half-filled orbitals engaging in anti-bonding hybridization never stabilizing the ionic shift, not sure if I should also discuss that}.

There are two ways around this issue, which lead to so-called Type-I and Type-II classification of multiferroics\cite{Khomskii2009}.
The Type-I variety harbors two different subsystems that separately host the magnetic and ferroelectric orders.
Using perovskites again as an example, a ferroelectrically active A-site cation such as Bi$^{3+}$ or Pb$^{3+}$ can be combined with a magnetically active B-site anion such as Fe or Mn, as e.g. in BiMnO$_3$. In this material, the lone pairs of Bi ions result in a ferroelectric polarization of 16 $\mu$C/cm$^2$, whereas the Mn ions result in a ferromagnetic phase below 110 K~\cite{Wang2009}.
One can write down a Landau free energy for a homogeneous type-I multiferroic by expanding the free energy $F$ in terms of $P$ and magnetization $M$:
\begin{align}
	F(P, H) =& F_0 + \frac{a}{2} (T-T_P) P^2 + \frac{b}{4} P^4 - P E \\
	&+\frac{\alpha}{2} (T-T_M)M^2 + \frac{\beta}{4} M^4 - MH - \frac{g}{2}P^2 M^2.
\end{align}
This is the simplest form of the free energy of a multiferroic with ferroelectric polarization $P$ and magnetization $M$. All parameters are taken to be positive, such that below the ferroelectric (ferromagnetic) transition temperature $T_P$ ($T_M$) nonzero $P$ ($M$) develops.
The lowest order symmetry allowed term that couples $P$ and $M$ is $-gP^2M^2$, obeying both time reversal and inversion symmetries above the transition temperatures $T_P$ and $T_M$.
Minimizing the energy with respect to both orders for $T<T_M,T_P$, with no applied external fields, leads to
\begin{align}
	P^2 &= - a(T-T_P)/b + gM^2\\
	M^2 &= - \alpha(T-T_M)/\beta + gP^2.
\end{align}
Both order parameters thus depend on the value of the other through the magnetoelectric coupling $g$. This leads to a change in one through an applied perturbation to the other.
The different origins of both orders, however, usually result in a small value of $g$. Indeed, the effective dielectric constant $\varepsilon$ of BiMnO$_3$ only displays a weak anomaly at the ferromagnetic transition temperature, and is only weakly affected by an external magnetic field, leading to a variation of 0.6\% of $\varepsilon$ at a field value of 9T.

The other class of multiferroics, i.e. those with Type-II multiferroicity, generally host a larger magnetoelectric effect, because the magnetic and ferroelectric orders both originate from the same underlying physics (i.e. the same degrees of freedom cause both orders).

These multiferroics have improper ferroelectricity, i.e. the electron degrees of freedom cause a particular magnetic configuration that breaks inversion symmetry, rather than a structural instability through phonon instabilities and the structural deformations associated with them.
To optimize the magnetic exchange energies, however, there will be displacements of the ions, that ultimately lead to a lowering of the crystalline symmetry.  
Although the size of the electric polarization thus created is usually orders of magnitude smaller than in Type-I multiferroics, the common origin of the two orders leads to a very sizable magnetoelectric effect~\cite{Oh2014}.

Here we specifically investigate GdMn$_2$O$_5$ (see Fig.~\ref{fig:GdMn2O5_unit_cell})~\cite{Khomskii2009}, showing an exceptional tunability of the ferroelectric polarization through an applied magnetic field~\cite{Lee13}.
The orthorhombic $R$Mn$_2$O$_5$ manganites all have a very complex crystalline structure, which leads to a wealth of different phases depending on the temperature, rare-earth, external magnetic field and even electric-field poling history~\cite{Zheng2019}.
To keep the discussion tractable and in line with the experiments that were performed, we give a summary of the transitions and phases that are important for this part of the Thesis.
$R$Mn$_2$O$_5$ have crystallographic group P$bam$ \cite{Alonso97} in the paramagnetic phase at high temperature, which eventually gets lowered to the crystallographic space group P$_ab2_1a$ when the commensurate magnetic order condenses below $T_{N} \approx 33$ K.
This order is characterised by the propagation vector $\bm{k} = (1/2, 0, 0)$, i.e. there is a unit cell doubling along the crystalline $a$-direction.
The magnetic configuration repeats along the crystalline $c$-direction. This magnetic transition goes hand in hand with a sharp anomaly in the dielectric constant $\varepsilon_b$, signalling the onset of the improper ferroelectric polarization order along the $b$-direction \cite{Lee13}.
When the temperature is lowered further, the polarization $P_b$ saturates to a maximum value of around 3600 $\mu$C/m$^2$, which is the largest of all rare-earth magnanites, but still tiny compared to proper ferroelectrics like BaTiO$_3$ with $P \approx 2 \times 10^5 \mu $C/m$^2$.
The magnetic configuration features two antiferromagnetic (AFM) Mn chains per unit cell, which are formed by pyramidally coordinated Mn$^{3+}$ and octahedrally coordinated Mn$^{4+}$ ions, as indicated by the light blue lines in Fig.~\ref{fig:GdMn2O5_unit_cell}. The Mn spins inside the chains lie mostly along the fourfold symmetry axis of the Mn pyramids, making angles of $\pm 23.4^\circ$ with the $a$-axis.

The improper ferroelectricity is generated through the symmetric Heisenberg exchange striction, combined with the geometric frustration and strong antiferromagnetic exchanges~\cite{Choi2008}.
The geometric frustration appears due to the odd number of AFM coupled spins in the Mn pentagons that surround each Gd ion, as can be seen in panel c of Fig.~\ref{fig:GdMn2O5_unit_cell}.
Similar to the situation in AFM coupled ions on a triangular lattice, not all AFM exchanges can be simultaneously satisfied (i.e. by having completely antiparallel spins on each AFM bond).
Each bond will then optimize the magnetic exchange energy together with the elastic energy resulting in bonds with mostly antiparallel spins to contract whereas bonds with mostly parallel spins will extend, as shown in Fig.~\ref{fig:GdMn2O5_unit_cell}(b). This can be understood from the dependence of the energy $W$ of each bond on the bond length between two Mn ions, following Ref. \cite{Harris1972}, as:
\begin{equation}
	W = J(r)\mathbf{S}_i \cdot \mathbf{S}_j + \frac{\kappa \delta r^2}{2r_0},
\end{equation}
with $\kappa$ the elastic stiffness of the bond, $r_0$ the mean separation between of Mn$^{3+}$ and Mn$^{4+}$ ions in the paramagnetic state, spins $\mathbf{S}_i$ and $\mathbf{S}_j$, and $\delta r = r - r_0$.
Minimizing this bond energy (i.e. taking $\frac{\partial W}{\partial r} = 0$), leads to the change in bondlength $\delta r$ upon condensing the magnetic structure to be given by 
\begin{equation}
	\delta r = -\frac{\partial J}{\partial r}\frac{r_0}{\kappa}\mathbf{S}_i \cdot \mathbf{S}_j. 
\end{equation}
Thus, AFM bonds ($J > 0$) with antiparallel spins contract ($\delta r < 0$), and bonds with parallel spins extend ($\delta r > 0$).
In the $R$Mn$_2$O$_5$ materials, this causes the ocatahedrally coordinated Mn$^{4+}$ ion to shift towards one of the two neighboring Mn$^{3+}$ pyramids in the Mn$^{3+}$ -- Mn$^{4+}$ -- Mn$^{3+}$ sequences, as showcased in Fig.~\ref{fig:GdMn2O5_unit_cell}(b).
This leads to the lowering of the symmetry from P$bam$ to P$_ab2_1a$, and, as the valence of the Mn$^{3+}$ and Mn$^{4+}$ ions differs, to a nonzero contribution to the polarization along the $b$-axis~\cite{Khomskii2009}.
It was shown, however, that this ionic displacement is largely compensated by electronic correlation effects, shifting the electronic wavefunctions opposite to the ions and almost fully cancelling the contribution to the polarization that originates from the Mn chains.
There is a second source of polarization in $R$Mn$_2$O$_5$ with a magnetic rare-earth, also due to the symmetric Heisenberg exchange striction, this time between the rare-earth and the surrounding Mn pentagon.
A similar train of thought can be followed as before, where all the exchanges between the rare earth and the surrounding Mn ions are AFM, again causing the bonds with mostly parallel spins to extend and the ones with mostly antiparallel spins to contract (see Fig.~\ref{fig:GdMn2O5_unit_cell}(c)).
This contribution does not suffer from the same cancellation between ionic displacements and electronic charge, and leads to the majority of the ferroelectric polarization in these materials.

Gd$^{3+}$ is special with respect to the other magnetic rare-earth ions in $R$Mn$_2$O$_5$, because it has a very isotropic electronic configuration (4$f^7$), i.e. there is no unquenched orbital angular momentum and associated anisotropic charge distribution. This means that the large spin (nominally $S=7/2$) can orient itself relatively freely to optimize the magnetic interactions with its neighboring Mn atoms, and that it has a high magnetic susceptibility and associated magnetoelectric effects.
This leads to GdMn$_2$O$_5$ surpassing the other $R$Mn$_2$O$_5$ compounds both in size and tunability of $P_b$, with a measured variation of up to $5000 \mu C/m^2$ when a magnetic field is applied~\cite{Lee13}. 

Now that the stage is set, we will describe the puzzling experimental observations that motivated this study.
%Even though the AFM intrachain superexchange interactions dominate over the AFM interchain interactions, there is nonetheless a geometric frustration due to the crystal structure, which can be seen most easily seen from the Mn pentagons surrouding the Gd atoms. This means that all AFM exchanges can not be satisfied at the same time, causing certain Mn bonds between the chains to have energetically unfavorable spin alignment. This leads to the first contribution to the ferroelectric polarization through Heisenberg exchange striction, lengthening bonds that have parallel spins and shortening those that have antiparallel ones.

\begin{figure}
	\IncludeGraphics{unit_cell.pdf}
	\caption{\label{fig:GdMn2O5_unit_cell}{\bf Unit cell and magnetic configuration of GdMn$_2$O$_5$.} The spheres signify Mn (purple), Gd (green) and Oxygen (red) ions. a) {\it Magnetic unit cell}, the zig-zag chains along the $a$-direction (cyan lines) show which Mn ions are linked with strong AFM exchange, resulting in the $\mathbf{L}_1$ and $\mathbf{L}_2$ N\'eel vectors. The boundary of the structural unit cell is marked by the black box and the yellow arrows denote the exchange paths between Gd and neighboring Mn ions in both chains, corresponding to $v_1$ and $v_2$. (b-c) {\it Symmetric magnetostriction}, the black arrows signify the zero field orientation of the spins. The yellow arrows denote the expanding bonds due to alignment of spins and AFM exchange, and the blue arrows denote contracting bonds.}
\end{figure}
\section{Experimental results}
\begin{figure*}[t]
    \centering
    \IncludeGraphics[width=0.99\linewidth]{fig_exp.png}
\caption{ \label{fig:GdMn2O5_experiment} {\bf Experimental measurements of the electric polarization.} (a) At higher temperatures only a small step is seen at the transition that shows some hysteresis and the two-state switching; (b) 4-state switching starts to appear approximately from $T=5$~K.(c) four-state hysteresis loop is clearly seen at $T=2.3$~K with the magnetic field at the ``magic'' angle;  
(d-f) Field dependence of the electric polarization of GdMn$_2$O$_5$ for different off-axis orientations of the applied magnetic field. (d,f): Conventional two-state switching is observed if magnetic field is (d) far away from the ``magic" direction  or (f) very close to the crystallographic $a$-axis. (e,g): Unusual four-state hysteresis loop for the magnetic field direction close to the magic angle of $\pm 9^o$. The inset shows the sequence of the magnetic field-sweeps. The labels 1-4 mark the four polarization states. The arrows show the direction of magnetic field-change during the sweep. The experiments have been done at $T=2.3$\,K. }
\end{figure*}
In previous experimental measurements, the magnetic field was always applied along the crystalline $a$-direction~\cite{Lee13}.
This leads to the aforementioned reversal and restoration of the polarization, and a relatively conventional hysteresis loop (see Fig.~1 of \cite{Lee13}), alternating between two polarization states. However, in measurements performed by A. Pimenov's group, it was found that the behavior of $P(H)$ depends strongly on the angle between the applied magnetic field and the $a$-direction, $\phi_H$.
As can be seen from Fig.~\ref{fig:GdMn2O5_experiment}(a), at high angle $P_b$ remains positive although a small jump can be observed signalling two transition between different internal states.
In the intermediate ``magic angle'' region (Fig.~\ref{fig:GdMn2O5_experiment}(b, d)), there is a crossover between the low angle regime of Ref.~\cite{Lee13} and the high angle regime observed by our collaborators, where four different states with different values of $P_b$ are visited while the external field cycles up and down twice.
This novel four-state switching is the focus of this chapter, and is found to originate from a rotational motion of the spins in one rotational direction.
One could say that this behavior is a microscopic analogue to the crankshaft in a car, that converts the linear back--and--forth variation of the magnetic field into a unidirectional rotational motion of the spins.
As will be shown below, these three regimes can each be assigned a winding number, with the four state switching regime lying on the boundary between the two extremal regimes.
The topology of the parameter space in terms of $\phi_H$ is found to be such that this four state switching phase can be thought of as topologically protected, i.e. there always exists a region of $\phi_H$ whre the four state cycle is present. The actual size of this region depends on the specific model parameters used, as will be discussed below.
The results of the experiments performed on single crystal GdMn$_2$O$_5$ samples are shown in Fig.~\ref{fig:GdMn2O5_experiment}. As can be seen from the varying behaviors in panels (a-d), the evolution of $P_b$ with $|H|$ is very dependent on it's angle with the $a$-axis, $\phi_H$.
As alluded to before, at a certain magnitude of this angle and at low temperature, a peculiar deterministic four-state hysterisis loop develops.
Even though all experimental measurements were performed on single crystal samples, 
% At higher temperature the usual two-state hysterisis loop is observed, also at the magic angle, as shown in panel e.
the complexity and low symmetry of the material leads to a wealth of different effects, which is clear from the details of the $P_b$ evolution at $T=4K$, shown in panel e, but also from some details of the evolution at $T=2K$.
We will only focus on the overall behavior, i.e. how the main four-state regime develops as an interpolation between the high and low angle regimes that have the more usual two state switching loop.
It is not clear what led to the discrepancy between the present low angle measurements (panel a) and earlier ones performed in Ref.~\cite{Lee13}, from our theoretical model it will be shown that the behavior in Ref.~\cite{Lee13} arises, rather than the one observed here.
\section{Modeling}
In order to describe the physics at play we use a classical model Hamiltonian with eight Gd spins whose orientations are described by unit vectors $\mathbf{S}_i, i=1..8$, two AFM order parameters $\mathbf{L}_\alpha, \alpha=1,2$ (also unit vectors) given by the difference of spins of neighboring Mn ions inside the two Mn chains inside the magnetic unit cell, and the slave order parameter $P_b$ for the ferroelectric polarization, see Fig~\ref{fig:GdMn2O5_unit_cell}.
Using $\mathbf{L}_\alpha$ to describe the chains amounts to taking the rigid $L$ approximation, i.e. all spins in each chain are assumed to be AFM ordered and approximately collinear. This simplification is justified by the large intrachain AFM exchanges, compared with the relatively small exchanges between the two chains.
A further simplification we adopt here is to confine all spins to the $ab$-plane. It was experimentally shownthat indeed the $c$-direction acts as the magnetic hard-axis, and that the magnetic order is indeed repeated along the crystalline $c$-direction~\cite{Lee13}.
This lowers the dimensionality of the problem from 3D to 2D, with a single angle for every Gd spin and Mn chain as the remaining degrees of freedom, thus greatly simplifying the numerical complexity.
Since all spins and AFM order parameters are unit vectors, their sizes are implicitely included in the model parameters.

The first step in order to derive the correct Hamiltonian that governs the system using these model parameters is to translate the microscopic Hamiltonian in terms of the individual spins inside the chains to one which uses the AFM order parameters $\mathbf{L}_\alpha$.
More specifically we include energy contributions due to small spin cantings, i.e. small deviations away from the perfect collinear intrachain spin configuration, as shown in Fig.~\ref{fig:GdMn2O5_canting}.

\begin{figure*}[h]
    \centering
    \label{fig:GdMn2O5_canting}
    \IncludeGraphics[width=\linewidth]{canting}
	\caption{{\bf Energy contributions due to spin canting.}\\ Zeeman (a) and Heisenberg exchange (b) energy gains when Mn spins (black arrows) are canted slightly with angle $\delta \theta$. In each panel the blue arrows signify the canted spins, compared with the perfect collinear configuration. In the Zeeman term (a) the spins inside one chain are canted slightly towards the field (red), leading to a weak ferromagnetic moment that couples to it, thus gaining energy. The interchain vs intrachain AFM exchange is optimized through a small canting of the two neighboring ferromagnetically oriented spins that invevitably arise due to the geometric frustration.}
\end{figure*}

The Zeeman energy of two neighboring spins $\pmb{\sigma}_1$ and $\pmb{\sigma}_2$ in a chain reads
\begin{equation}
	E_Z = -g \mu_b \mathbf{H} \cdot (\pmb{\sigma}_1 + \pmb{\sigma}_2).
\end{equation}
Obviously, when the spins are assumed to be collinear, no energy gain is possible. However, if the spins inside each chain cant slightly towards the applied field, a weak ferromagnetic moment is created that will couple to the magnetic field. To include this behavior, an expansion in small canting angle $\delta \theta$, away from the collinear configuration, can be performed.\lp{make some figures!}
\begin{align}
	E &= \Jpar \cos(2\delta \theta) - g \mu_b H \left[\cos(\theta_L - \theta_H + \delta \theta) + \cos(\theta_L + 180^\circ - \theta_H - \delta \theta)\right],\nonumber\\
	&= \Jpar \left( 1+2\delta\theta^2 \right) - 2 g \mu_b H \sin(\theta_L - \theta_H)\delta\theta \label{eq:GdMn2O5_zeeman_exp}.
\end{align}
Minimizing in terms of $\delta \theta$ leads to
\begin{align}
	\frac{\partial E}{\partial \delta \theta} = 0 &= 4 \Jpar \delta \theta - 2 g \mu_b H \sin(\theta_L - \theta_H) \nonumber\\
	&\Leftrightarrow \nonumber\\
	\delta \theta &= \frac{g\mu_b H \sin(\theta_L - \theta_H)}{2 \Jpar}.\nonumber
\end{align}
Inserting this expression for $\delta \theta$ back into Eq.~\ref{eq:GdMn2O5_zeeman_exp}, keeping only the first order terms, leads to the following expression for the gain in Zeeman energy when the spins cant:
\begin{align}
	E_Z &= -\frac{g^2\mu_b^2 H^2 \sin(\theta_L - \theta_H)^2}{\Jpar} = -\frac{g^2\mu_b^2 H^2 \left(1 - \cos(\theta_L - \theta_H)^2\right)}{\Jpar} \nonumber\\
	&=\frac{g^2\mu_b^2}{\Jpar}\left((\mathbf{H}\cdot\mathbf{L})^2 - H^2\right)\nonumber
\end{align}
This energy gain is maximized when $\mathbf{L}$ is oriented perpendicular to $\mathbf{H}$, which is exactly what happens in the well-known spin-flop transition, where a strong enough magnetic field, applied along the easy-axis of an AFM system will cause a sudden flip of the spins away from the easy-axis when gain of the Zeeman energy through canting overcomes the lost easy-axis anisotropy energy. This situation is shown in Fig.~\ref{fig:GdMn2O5_canting}(a).

An additional energy contribution due to small opposite canting in both chains originates from the geometric frustration, as shown in Fig.~\ref{fig:GdMn2O5_canting}(b). This causes the inter chain AFM exchange energies to not completely cancel out, and lead to a small gain through $\Jperp$.
Adopting a similar strategy as above, this can be written down as
\begin{equation}
	E_{ic} = 2 \Jpar \cos(\delta \theta) + \Jperp \left(\cos(\theta_1 + \delta \theta - \theta_2) - \cos(\theta_1 - \theta_2 -\delta \theta)\right),
\end{equation}
where $\theta_1$ and $\theta_2$ signifiy the angle, w.r.t. the $a$-axis, of $\mathbf{L}_1$ and $\mathbf{L}_2$, respectively.
Expanding again to second order leads to
\begin{equation}
	E_{ic} = 2 \Jpar ( 1+ \delta \theta^2) - 2 \Jperp \sin(\theta_1 - \theta_2)\delta \theta. \label{eq:GdMn2O5_Eic_exp}
\end{equation}
Again minimizing this contribution in terms of $\delta \theta$, we find
\begin{equation}
	\delta \theta = \frac{\Jperp}{2 \Jpar} \sin(\theta_1 - \theta_2).
\end{equation}
Substituting $\delta \theta$ into Eq.~\ref{eq:GdMn2O5_Eic_exp}, keeping only first order terms in $\frac{\Jperp^2}{\Jpar}$, since it is assumed that $\Jperp << \Jpar$, leads to the final expression of this energy contribution:
\begin{equation}
	E_{ic} = -\frac{\Jperp^2}{\Jpar}\sin(\theta_1 - \theta_2)^2 =  \frac{\Jperp^2}{\Jpar}(\cos(\theta_1 - \theta_2) - 1) = \frac{\Jperp^2}{\Jpar}(\mathbf{L}_1 \cdot \mathbf{L}_2)^2 - \frac{\Jperp^2}{\Jpar},
\end{equation}
where the last contribution is a constant and thus merely causes a shift in the energy.
The maximum gain in energy ($\frac{\Jperp^2}{\Jpar}$) is achieved when the chains are oriented perpendicular to eachother.
It is clear that these two terms compete with the easy-axis anisotropy energy $K_L\sum_\alpha(\mathbf{L}_\alpha\cdot \mathbf{n}_\alpha)^2$.
Collecting these three terms results in the contribution to the Hamiltonian that originates from the interaction between the chains, and between the chains and the external magnetic field:
\begin{equation}
	H_L = \Gamma(\mathbf{L}_1\cdot \mathbf{L}_2)^2
    +\sum_{\alpha}\chi^{-1}((\mathbf{H}\cdot \mathbf{L}_\alpha)^2-H^2)
    -K_L\sum_\alpha(\mathbf{L}_\alpha\cdot \mathbf{n}_\alpha)^2\label{eq:GdMn2O5_hami_1},
\end{equation}
with $\Gamma = \frac{\Jperp^2}{\Jpar}$, $\chi^{-1} = \frac{g^2\mu_b^2}{\Jpar}$, and $K_L$ the easy-axis anisotropy w.r.t. easy axes $\mathbf{n}_1=$(cos(23.4$^\circ$), sin(23.4$^\circ$)) and $\mathbf{n}_2=$(cos(-23.4$^\circ$), sin(-23.4$^\circ$)). These are the fourfold axes of the pyramidally coordinated Mn ions inside each chain.

The next step is to find cross-order couplings of order parameters that are allowed by symmetry and thus transform according to the identity representation of the symmetry group of the crystal.
To this end we utilize the following generators of the paramagnetic high symmetry P$bam$ phase:
\begin{align}
	I &: (x, y) \rightarrow (-x, -y, -z)\\
	2_z &: (x, y) \rightarrow (-x, -y, z)\\
	2_y &: (x, y) \rightarrow (\frac{1}{2} - x, \frac{1}{2} + y, z)
\end{align}
$I$ and $2_z$ are the same symmetry operations in the 2D case. Next, a doubling of the unit cell is necessary to fit the overall AFM state. This leads to an additional symmetry operation $a: (x, y, z) \rightarrow (x + a, y, z)$ when the spins are not taken into account, and a halving of the fractional translation $2_y: (x, y) \rightarrow (\frac{1}{4} - x, \frac{1}{2}+y, z)$.
In effect, applying these symmetry operations to the degrees of freedom, bearing in mind the AFM spin transformation between the two halves of the magnetic unit cell, leads to the following transformation table:
\begin{table}[h]
\centering
\begin{tabular}{|l|lllllllllll|}
\cline{1-12}
 & $S_1$ & $S_2$ & $S_3$ & $S_4$ & $S_5$ & $S_6$ & $S_7$ & $S_8$ & $L_1$ & $L_2$ & $P_b$ \\ \cline{1-12}
I & $S_8$ & $S_7$ & $S_6$ & $S_5$ & $S_4$ & $S_3$ & $S_2$ & $S_1$ & -$L_1$ & $L_2$ & -$P_b$ \\ \cline{1-12}
$2_y$ & $S_4$ & $S_3$ & $S_2$ & $S_1$ & $S_8$ & $S_7$ & $S_6$ & $S_5$ & $L_1$ & $L_2$ & $P_b$ \\ \cline{1-12}
a & $S_5$ & $S_6$ & $S_7$ & $S_8$ & $S_1$ & $S_2$ & $S_3$ & $S_4$ & -$L_1$ & -$L_2$ & $P_b$ \\ \cline{1-12}
\end{tabular}
\end{table}\\\\
We start with the first set of terms in the Hamiltonian are the Heisenberg exchange terms between the Gd spins and the Mn chains ($L_1$ and $L_2$), with the effective exchange constants $v_1$ and $v_2$.
The former (latter) couples each Gd spin with the chain that harbors the closest (furthest) Mn ion.
Starting from terms with $S_1$ and $S_2$, taking into account the above table of transformations, the following sets of terms can be identified:
\begin{align}
	\mathbf{S}_1\cdot(v_1 \mathbf{L}_2 + v_2 \mathbf{L}_1) \xrightarrow{I} \mathbf{S_8}\cdot(v_1 \mathbf{L}_2 - v_2 \mathbf{L}_1) \xrightarrow{a} \mathbf{S_4} \cdot (- v_1 \mathbf{L}_2 + v_2 \mathbf{L}_1) \xrightarrow{I} \mathbf{S_5} \cdot (-v_1 \mathbf{L}_2 - v_2 \mathbf{L}_1), \nonumber\\
	\mathbf{S}_2\cdot(v_1 \mathbf{L}_1 + v_2 \mathbf{L}_2) \xrightarrow{I} \mathbf{S_7}\cdot(-v_1 \mathbf{L}_1 + v_2 \mathbf{L}_2) \xrightarrow{a} \mathbf{S_3} \cdot (v_1 \mathbf{L}_1 - v_2 \mathbf{L}_2) \xrightarrow{I} \mathbf{S_6} \cdot (-v_1 \mathbf{L}_1 - v_2 \mathbf{L}_2).
\end{align}
The sum of all these contributions transforms according to the identity representation, leading to the first contribution to the Hamiltonian:
\begin{align}
    H_{LS} =& \mathbf{S}_1 \cdot (v_1 \mathbf{L}_2 + v_2 \mathbf{L}_1) + \mathbf{S}_2 \cdot (v_1 \mathbf{L}_1 + v_2 \mathbf{L}_2) + \mathbf{S}_3 \cdot (v_1 \mathbf{L}_1 - v_2 \mathbf{L}_2) + \mathbf{S}_4 \cdot (-v_1 \mathbf{L}_2 + v_2 \mathbf{L}_1) \nonumber\\
    -&\mathbf{S}_5 \cdot (v_1 \mathbf{L}_2 + v_2 \mathbf{L}_1) - \mathbf{S}_6 \cdot (v_1 \mathbf{L}_1 + v_2 \mathbf{L}_2) - \mathbf{S}_7 \cdot (v_1 \mathbf{L}_1 - v_2 \mathbf{L}_2) - \mathbf{S}_8 \cdot (-v_1 \mathbf{L}_2 + v_2 \mathbf{L}_1).
\end{align}
A similar process can be applied starting from $P_b \, \mathbf{S_1}\cdot(\beta_2 \mathbf{L}_1 + \beta_3 \mathbf{L}_2)$ and $P_b\, \mathbf{S_2}\cdot(\beta_2 \mathbf{L}_1 + \beta_3 \mathbf{L}_2)$, which signify the symmetric Heisenberg magnetostriction contribution to the Hamiltonian. This leads to
\begin{align}
	H_{P_b}=&-P_b[E_b + \beta_1 (\mathbf{L}_1\cdot \mathbf{L}_2)+
    (\mathbf{S}_1-\mathbf{S}_5)(\beta_2 \mathbf{L}_2 + \beta_3 \mathbf{L}_1) +
    (\mathbf{S}_2-\mathbf{S}_6)(\beta_2 \mathbf{L}_1 + \beta_3 \mathbf{L}_2) \nonumber\\ 
    &+(\mathbf{S}_3-\mathbf{S}_7)(\beta_2 \mathbf{L}_2 - \beta_3 \mathbf{L}_1) +
    (\mathbf{S}_4-\mathbf{S}_8)(\beta_2 \mathbf{L}_1 - \beta_3 \mathbf{L}_2)],
\end{align}
where the interaction with an external electric field $E_b$ was also included. 
Three further terms coming purely from the Gd spins can be identified:
\begin{equation}
     H_S=\frac{1}{2}(g \mu_B)^2\sum_{i\neq j}\left(\frac{\mathbf{S}_i\cdot \mathbf{S}_j}{r_{ij}^3}-3\frac{(\mathbf{S}_i\cdot \mathbf{r}_{ij})(\mathbf{S}_j\cdot \mathbf{r}_{ij})}{r_{ij}^5}\right) - \sum_i\left( K_S(\mathbf{N}_i\cdot \mathbf{S}_i)^2 + g\mu_\mathrm{B} \mathbf{H} \cdot \mathbf{S}_i\right) 
\end{equation}
The first describes the magnetodipolar interaction between Gd spins, which could be relatively large due to the size of the spins and relative proximity to the neighbors. In the numerical simulations these interactions were restricted to five nearest neighbors, including periodic images. Including further neighbors did not lead to qualitative differences in the results. The term with $K_S$ denotes the anisotropy for the Gd ions, this time with anisotropy axes $N_i$, unit vectors alternating as $\pm 12^\circ$. $K_S$ is significantly smaller than $K_L$ due to the isotropic environment and spin configuration of the Gd ions.
The final term denotes the Zeeman energy of the Gd ions in the external magnetic field $H$.

The model parameters used here are $J_\perp = 1.89$~meV, $J_\parallel = 26.67$~meV, $K_L = 5.27$~meV, $K_S = 0.2$~meV, $v_1 = 3.33$~meV, $v_2 = 0.15$~meV \lp{check order parameters, maybe show different sets?}. 
The model parameters $\alpha = 0.06\:\mu$C/cm$^2$, $\beta = 0.04\:\mu$C/cm$^2$, $\gamma = 0.06\:\mu$C/cm$^2$ were fitted to the experimental data.

As mentioned above, the low temperature commensurate state breaks both time reversal symmetry, $T: (\mathbf{L}_1, \mathbf{L}_2) \rightarrow (-\mathbf{L}_1, -\mathbf{L}_2)$, and inversion symmetry $I:(\mathbf{L}_1, \mathbf{L}_2) \rightarrow (-\mathbf{L}_1, \mathbf{L}_2)$, which makes the system fall into one of the fourfold degenerate energy minima as shown in the top left panel of Fig.~\ref{fig:GdMn2O5_heatmap}. 
To simulate the experimental measurements in Fig.~\ref{fig:GdMn2O5_experiment} at low temperature, we choose one of the four degenerate minima of the Hamiltonian, gradually increase and decrease the applied magnetic field, and minimize the energy in order to track the instantaneous local minimum. 

The results are shown in Fig.~\ref{fig:GdMn2O5_theory}
\begin{figure*}[t]
	\begin{subfigure}{0.24\textwidth}
    \IncludeGraphics{"field_heatmap1"}
	\end{subfigure}
	\begin{subfigure}{0.24\textwidth}
    \IncludeGraphics{"field_heatmap2"}
	\end{subfigure}
	\begin{subfigure}{0.24\textwidth}
    \IncludeGraphics{"field_heatmap3"}
	\end{subfigure}
	\begin{subfigure}{0.24\textwidth}
    \IncludeGraphics{"field_heatmap4"}
	\end{subfigure}\\
	\begin{subfigure}{0.24\textwidth}
    \IncludeGraphics{"field_heatmap5"}
	\end{subfigure}
	\begin{subfigure}{0.24\textwidth}
    \IncludeGraphics{"field_heatmap6"}
	\end{subfigure}
	\begin{subfigure}{0.24\textwidth}
    \IncludeGraphics{"field_heatmap7"}
	\end{subfigure}
	\begin{subfigure}{0.24\textwidth}
    \IncludeGraphics{"field_heatmap8"}
	\end{subfigure}
	\caption{{\bf Evolution of the energy surface during field sweep.}\\ The white dots in the top left panel denote the four degenerate minima.}
	\label{fig:GdMn2O5_heatmap}
\end{figure*}

\begin{figure*}[h]
    \centering
    \IncludeGraphics[width=\linewidth]{Pb_3panels_heatmaps}
    %\includegraphics[width=\linewidth]{fig/L1L2_heatmap.png}
    \caption{\label{fig:GdMn2O5_theory}{\bf Simulation of magnetoelectric behaviour.}
    (a-c) Evolution of electric polarization $P_b$ during the magnetic field sweep cycle for various magnetic field orientations. 
   In each panel, the changes of the curve color indicate the same progression of the sweep cycle as Fig~\ref{fig:GdMn2O5_experiment}. The four-state switching is seen for the field at the magic orientation. 
    The insets indicate the corresponding switching paths and winding numbers.
    (d-f) Trajectories (in green) in the space of the N\'eel vectors orientations, $(\phi_{\rm L_1},\phi_{\rm L_2})$, through the field sweep cycles in different regimes. The color map shows the energy landscape in the vicinity of the switching fields. 
}
\end{figure*}
\begin{figure*}[t]
    \centering
	\begin{subfigure}{\textwidth}
    \IncludeGraphics{"neb"}
	\end{subfigure}
    % \IncludeGraphics[width=\linewidth]{}
    %\includegraphics[width=\linewidth]{fig/L1L2_heatmap.png}
    \caption{\label{fig:GdMn2O5_neb}{\bf Energy barrier evolution.}
    Evolution of transition barriers between states 1, 2, 3, 4 as the magnetic field at 10$^\circ$ to the $a$-axis is swept through the hysteresis region. The plots are shifted vertically, and magnetodipolar interactions were enhanced by a factor of 5.3 for clarity. This latter increases the width of the hysteresis region. The curve colors encode the corresponding magnetic field strength. The blue circles and arrows show the trajectory of the energy minimum due to field sweeps.
    The red square and corresponding schematic on the right shows the asymmetric evolution of the barrier from state 2 to 1, and from 2 to 3 around the critical field $H^*$ where the barriers are of equal height. 
    Coordinated changes of the state energies and barrier asymmetry with magnetic field enable the topological behavior.
    }
\end{figure*}
In order to understand the energy surface connecting the four states, we proceed by labeling them in the same way as Fig.~\ref{fig:GdMn2O5_experiment}, and perform a nudged elastic band calculation between the four states at a given magnetic field inside the hysterisis region.
This results in the evolution of barriers between these states as shown in panel (g), where the color coding is used to denote the magnetic field strength, and the energy graphs are offset for clarity.
The arrows and blue balls denote the evolution during the double magnetic field sweep. As expected, two minima with opposite $P_b$ are degenerate each value of $H$, at low field these are located at states 1 and 3, then as the field is ramped up they move to favor states 2 and 4.
We see that during the sweep the barriers between the different states evolve asymmetrically.
Starting in state 1, when the field is ramped up the barrier towards state 2 decreases faster than the one towards state 4, causing the system to move from 1 to 2.
Then, as the magnetic field is lowered again, the barrier from 2 to 3 increases slower than from 2 to 1. When ultimately state 2 goes from being metastable to a saddle point, the system spills over towards state 3, and so on.
In order to try and understand where the asymmetric evolution of the barriers comes from, we investigate the situation around the particular $H$-field strength where the system is close to state 2, and the barriers between state 2 and 1, and 2 and 3 are the same height.
This situation is highlighted by the red dashed box around the blue graph in Fig.~\ref{fig:GdMn2O5_theory}(g). The inset of panel (k) provides a zoom on the energy surface. The states $12$ and $23$ denote the configurations on top of the barriers from 1 to 2 and 2 to 3, respectively. A Taylor expansion in terms of $H$, around $H^*$ can be performed for both states:
\begin{equation}
	F(H) = F(H^*) + \left.\frac{\partial F}{\partial H}\right\rvert_{H=H^*} (H-H^*) + ...
\end{equation}
If one then subtracts the results, using $\frac{\partial F}{\partial H} = M$, the following expression is found
\begin{equation}
	E_{12}(H) - E_{23} \sim (M_{12} - M_{23}) (H - H^*).
\end{equation}
This means that, to first order, the evolution of the barrier asymmetry is given by the difference in magnetization of the two states on top of the barriers.
The magnetization of both states can be calculated using the following formula
\begin{equation}
	\mathbf{M} = -\frac{\partial{F}}{\partial{\mathbf{H}}} = \sum_i g \mu_{B} \mathbf{S}_i - \sum_{\alpha} 2 \chi^{-1}\mathbf{L}_{\alpha} (\mathbf{H} \cdot \mathbf{L}_{\alpha}) 
\end{equation}
Indeed we find that the magnetizations are different from our simulations, $M_{23} > M_{12}$, confirming that this is at least a part of the reason for the asymmetric evolution of the barriers.
Moreover, due to the symmetry of the system, this asymmetry is opposite when the field is swept up, as compared with when the field is swept down.
This causes that when $H > H^*$ the barrier from state 1 to state 2 lowers faster than the one towards state 4, and by symmetry, the barrier from state 3 to state 4 lowers faster than from state 3 to 2.
The converse is true when $H < H^*$, but since the system is then coming from the high-field configurations, it moves from 2 to 3 and 4 to 1 rather than the opposite direction.
This causes the deterministic unidirectional movements through the four states sequentially when two field sweeps are applied.
Since the two low field states that get accessed sequentially have two different $P_b$ values, this situation effectively results in a single crystal binary counter behavior.  

The magnetic configuration of the four extremal states is displayed in panel (h) of the same figure, showcasing the rotational motion of the spins inside the chain most parallel to the applied magnetic field, and the Gd ions coupled most strongly with it.
This robust one directional rotation allows us to assign a non-zero winding number to the `magic-angle' switching behavior, i.e. $Q=\frac{1}{2\pi}\int_0^{T_0} dt (L_x\partial_t L_y - L_y \partial_t L_x)$. 

\begin{figure}[h]
	\IncludeGraphics{spin_configs}
\end{figure}


\section{Simplified Model}
Having found a description for the situation in the complicated material GdMn$_2$O$_5$ using the model \ref{eq:GdMn2O5_1}, one may wonder what the minimal requirements are to have a similar four-state behavior where the spins rotate 360$^\circ$ while the applied field only oscillates back and forth along a single axis.
We look to the spin configurations of Fig.~\ref{fig:GdMn2O5_theory}(h) for inspiration.
It is clear that, although both chains are necessary for the $P_b$ behavior, the chain with equilibrium Mn moments most parallel to the applied field does the full rotation, while the other chain merely oscillates around its starting position.
Similarly, only the Gd moments most strongly coupled to that chain perform the full 360$^\circ$ cycle.
This warrants an attempt to search for the four state behavior using only a single chain with its Gd moments, more specifically, in the case of $\phi_H = +10^\circ$, we keep $L_1$, $S_2$, $S_3$, $S_6$ and $S_7$ as the degrees of freedom in the model.
Given the negligible importance of the anisotropy on the Gd ions, we also put $K_S = 0$.
This leaves us with the following Hamiltonian, which is split up in two parts, one with the dipolar terms $H_{dip}$ and one with all the other terms $H'$:
\begin{align}
	H &= H' + H_{dip} \\
	H' &= v_1(\mathbf{S}_2 + \mathbf{S}_3 - (\mathbf{S}_6 + \mathbf{S}_7))\cdot\mathbf{L}_1 - g \mu_b (\mathbf{S}_2 + \mathbf{S}_3 + \mathbf{S}_6 + \mathbf{S}_7) \cdot \mathbf{H} \\
	&- K_L (\mathbf{L}_1 \cdot \mathbf{n})^2 \\
	H_{dip} &= \frac{1}{2}(g \mu_B)^2\sum_{i\neq j}\left(\frac{\mathbf{S}_i\cdot \mathbf{S}_j}{r_{ij}^3}-3\frac{(\mathbf{S}_i\cdot \mathbf{r}_{ij})(\mathbf{S}_j\cdot \mathbf{r}_{ij})}{r_{ij}^5}\right).
\end{align}

Due to the higher symmetries of this model throughout the field sweep cycle, compared with the full model, one can identify two symmetry related copies of one spin in the first half of the magnetic unit cell and one in the second half of the unit cell, with the chain in between (see Fig.~\ref{fig:GdMn2O5_simple_model}), i.e. $S_2 = S_3$ and $S_6 = S_7$.
\begin{figure}
	\IncludeGraphics{double_cell.png}
	\caption{\label{fig:GdMn2O5_simple_model} Simplified single chain model.}
\end{figure}
This further simplifies the Hamiltonian:
\begin{align}
	H' &= 2v_1(\mathbf{S}_3 - \mathbf{S}_6)\cdot\mathbf{L}_1 - 2g \mu_b (\mathbf{S}_3 + \mathbf{S}_6) \cdot \mathbf{H} \\
	&- K_L (\mathbf{L} \cdot \mathbf{n})^2 \\
	H_{dip} &= (g \mu_B)^2\left(\frac{\mathbf{S}_3\cdot \mathbf{S}_6}{r_{36}^3}-3\frac{(\mathbf{S}_3\cdot \mathbf{r}_{36})(\mathbf{S}_6\cdot \mathbf{r}_{36})}{r_{36}^5}\right).
\end{align}
\lp{what can we say more about this?}
\printbibliography
